TAP version 13
# [CRE-AI] No claudeService available for generate-assertions, returning empty result
# [CRE-ASSERT] AI assertion generation failed for story story-1
# [CRE-ASSERT] Error: claudeService not available
# [CRE-AI] No claudeService available for generate-assertions, returning empty result
# [CRE-ASSERT] AI assertion generation failed for story story-1
# [CRE-ASSERT] Error: claudeService not available
# [CRE-ASSERT] Rejected unsafe regex pattern: (a+)+
# [CRE-ASSERT] Path traversal blocked: ../../../etc/passwd
# [CRE-ASSERT] Path traversal blocked: /etc/passwd
# [CRE-AI] No claudeService available for generate-assertions, returning empty result
# [CRE-ASSERT] AI assertion generation failed for story story-1
# [CRE-ASSERT] Error: claudeService not available
# Subtest: AssertionType and AssertionResult enums
    # Subtest: should define 4 assertion types (AC3)
    ok 1 - should define 4 assertion types (AC3)
      ---
      duration_ms: 1.6302
      ...
    # Subtest: should define 3 result states
    ok 2 - should define 3 result states
      ---
      duration_ms: 0.2603
      ...
    1..2
ok 1 - AssertionType and AssertionResult enums
  ---
  duration_ms: 4.1435
  type: 'suite'
  ...
# Subtest: AssertionGenerator - generate (AC2)
    # Subtest: should return a prompt with system, task, constraints
    ok 1 - should return a prompt with system, task, constraints
      ---
      duration_ms: 8.422
      ...
    # Subtest: should store provided assertions in DB (AC5)
    ok 2 - should store provided assertions in DB (AC5)
      ---
      duration_ms: 4.2424
      ...
    # Subtest: should return empty assertions array when none provided
    ok 3 - should return empty assertions array when none provided
      ---
      duration_ms: 3.6776
      ...
    # Subtest: should throw on missing required params
    ok 4 - should throw on missing required params
      ---
      duration_ms: 4.071
      ...
    # Subtest: should reject unsupported assertion type (AC3)
    ok 5 - should reject unsupported assertion type (AC3)
      ---
      duration_ms: 1.9836
      ...
    # Subtest: should reject assertion without target
    ok 6 - should reject assertion without target
      ---
      duration_ms: 2.722
      ...
    1..6
ok 2 - AssertionGenerator - generate (AC2)
  ---
  duration_ms: 27.6076
  type: 'suite'
  ...
# Subtest: AssertionGenerator - verify file_exists (AC4)
    # Subtest: should pass when file exists
    ok 1 - should pass when file exists
      ---
      duration_ms: 20.7707
      ...
    # Subtest: should fail when file missing
    ok 2 - should fail when file missing
      ---
      duration_ms: 5.166
      ...
    # Subtest: should check directory kind
    ok 3 - should check directory kind
      ---
      duration_ms: 4.5776
      ...
    # Subtest: should fail when expecting directory but found file
    ok 4 - should fail when expecting directory but found file
      ---
      duration_ms: 4.3742
      ...
    1..4
ok 3 - AssertionGenerator - verify file_exists (AC4)
  ---
  duration_ms: 35.6517
  type: 'suite'
  ...
# Subtest: AssertionGenerator - verify function_exists (AC4)
    # Subtest: should pass when function is declared
    ok 1 - should pass when function is declared
      ---
      duration_ms: 7.9972
      ...
    # Subtest: should pass for async function
    ok 2 - should pass for async function
      ---
      duration_ms: 5.1699
      ...
    # Subtest: should fail when function not found
    ok 3 - should fail when function not found
      ---
      duration_ms: 5.1296
      ...
    # Subtest: should fail when file missing
    ok 4 - should fail when file missing
      ---
      duration_ms: 6.5746
      ...
    1..4
ok 4 - AssertionGenerator - verify function_exists (AC4)
  ---
  duration_ms: 26.0162
  type: 'suite'
  ...
# Subtest: AssertionGenerator - verify export_exists (AC4)
    # Subtest: should pass for CommonJS exports
    ok 1 - should pass for CommonJS exports
      ---
      duration_ms: 7.5246
      ...
    # Subtest: should pass for exports.name pattern
    ok 2 - should pass for exports.name pattern
      ---
      duration_ms: 5.1209
      ...
    # Subtest: should fail when export missing
    ok 3 - should fail when export missing
      ---
      duration_ms: 5.9954
      ...
    # Subtest: should require all exports present
    ok 4 - should require all exports present
      ---
      duration_ms: 5.4202
      ...
    1..4
ok 5 - AssertionGenerator - verify export_exists (AC4)
  ---
  duration_ms: 24.7141
  type: 'suite'
  ...
# Subtest: AssertionGenerator - verify pattern_match (AC4)
    # Subtest: should pass when pattern is present
    ok 1 - should pass when pattern is present
      ---
      duration_ms: 5.6873
      ...
    # Subtest: should fail when pattern is absent but expected present
    ok 2 - should fail when pattern is absent but expected present
      ---
      duration_ms: 5.5137
      ...
    # Subtest: should pass when pattern is absent and operator is absent
    ok 3 - should pass when pattern is absent and operator is absent
      ---
      duration_ms: 5.1761
      ...
    # Subtest: should fail when pattern is present but operator is absent
    ok 4 - should fail when pattern is present but operator is absent
      ---
      duration_ms: 5.4017
      ...
    1..4
ok 6 - AssertionGenerator - verify pattern_match (AC4)
  ---
  duration_ms: 22.5883
  type: 'suite'
  ...
# Subtest: isSafeRegex - ReDoS guard (F001)
    # Subtest: should accept simple patterns
    ok 1 - should accept simple patterns
      ---
      duration_ms: 0.3917
      ...
    # Subtest: should reject nested quantifiers like (a+)+
    ok 2 - should reject nested quantifiers like (a+)+
      ---
      duration_ms: 0.2433
      ...
    # Subtest: should reject overlapping alternation with quantifiers
    ok 3 - should reject overlapping alternation with quantifiers
      ---
      duration_ms: 0.2468
      ...
    # Subtest: should reject patterns exceeding max length
    ok 4 - should reject patterns exceeding max length
      ---
      duration_ms: 0.2215
      ...
    1..4
ok 7 - isSafeRegex - ReDoS guard (F001)
  ---
  duration_ms: 1.5191
  type: 'suite'
  ...
# Subtest: AssertionGenerator - ReDoS protection in verify (F001)
    # Subtest: should fail for unsafe regex patterns instead of hanging
    ok 1 - should fail for unsafe regex patterns instead of hanging
      ---
      duration_ms: 4.2515
      ...
    1..1
ok 8 - AssertionGenerator - ReDoS protection in verify (F001)
  ---
  duration_ms: 4.3986
  type: 'suite'
  ...
# Subtest: AssertionGenerator - path traversal protection (F002)
    # Subtest: should fail for targets with ../ path traversal
    ok 1 - should fail for targets with ../ path traversal
      ---
      duration_ms: 3.0303
      ...
    # Subtest: should fail for absolute paths outside project root
    ok 2 - should fail for absolute paths outside project root
      ---
      duration_ms: 3.1307
      ...
    # Subtest: should allow targets within project root
    ok 3 - should allow targets within project root
      ---
      duration_ms: 14.1234
      ...
    1..3
ok 9 - AssertionGenerator - path traversal protection (F002)
  ---
  duration_ms: 20.7787
  type: 'suite'
  ...
# Subtest: AssertionGenerator - DB persistence (AC5, AC6)
    # Subtest: should store assertions with pending result on generate
    ok 1 - should store assertions with pending result on generate
      ---
      duration_ms: 4.8095
      ...
    # Subtest: should update result and verifiedAt on verify (AC6)
    ok 2 - should update result and verifiedAt on verify (AC6)
      ---
      duration_ms: 8.5905
      ...
    # Subtest: getByPlan retrieves assertions for a plan
    ok 3 - getByPlan retrieves assertions for a plan
      ---
      duration_ms: 3.1065
      ...
    # Subtest: getByStory retrieves assertions for a story
    ok 4 - getByStory retrieves assertions for a story
      ---
      duration_ms: 5.1894
      ...
    1..4
ok 10 - AssertionGenerator - DB persistence (AC5, AC6)
  ---
  duration_ms: 22.4044
  type: 'suite'
  ...
# Subtest: AssertionGenerator - multiple assertions verify (AC4)
    # Subtest: should verify mixed pass/fail results
    ok 1 - should verify mixed pass/fail results
      ---
      duration_ms: 18.7476
      ...
    1..1
ok 11 - AssertionGenerator - multiple assertions verify (AC4)
  ---
  duration_ms: 19.1869
  type: 'suite'
  ...
# Subtest: AssertionGenerator - regression: assertions returned for user_stories persistence
    # Subtest: should return generated assertions array that can be persisted to user_stories
    ok 1 - should return generated assertions array that can be persisted to user_stories
      ---
      duration_ms: 3.218
      ...
    # Subtest: should return empty array (not undefined/null) when AI generation unavailable
    ok 2 - should return empty array (not undefined/null) when AI generation unavailable
      ---
      duration_ms: 2.5528
      ...
    # Subtest: should store assertions in inspection_assertions table AND return them for user_stories
    ok 3 - should store assertions in inspection_assertions table AND return them for user_stories
      ---
      duration_ms: 2.7016
      ...
    1..3
ok 12 - AssertionGenerator - regression: assertions returned for user_stories persistence
  ---
  duration_ms: 8.9001
  type: 'suite'
  ...
# Subtest: getDefaultCreConfig
    # Subtest: should return all required defaults (AC1-AC8)
    ok 1 - should return all required defaults (AC1-AC8)
      ---
      duration_ms: 3.2765
      ...
    # Subtest: should include enabled flag
    ok 2 - should include enabled flag
      ---
      duration_ms: 0.3034
      ...
    1..2
ok 13 - getDefaultCreConfig
  ---
  duration_ms: 6.245
  type: 'suite'
  ...
# Subtest: ensureCreConfig
    # Subtest: should add cre section to empty config
    ok 1 - should add cre section to empty config
      ---
      duration_ms: 0.7422
      ...
    # Subtest: should not overwrite existing user values
    ok 2 - should not overwrite existing user values
      ---
      duration_ms: 1.5461
      ...
    # Subtest: should backfill missing nested fields
    ok 3 - should backfill missing nested fields
      ---
      duration_ms: 0.3986
      ...
    # Subtest: should backfill entirely missing introspection/schema sections
    ok 4 - should backfill entirely missing introspection/schema sections
      ---
      duration_ms: 0.3336
      ...
    # Subtest: should return the config object
    ok 5 - should return the config object
      ---
      duration_ms: 0.4381
      ...
    1..5
ok 14 - ensureCreConfig
  ---
  duration_ms: 4.1316
  type: 'suite'
  ...
# Subtest: getCreConfig
    # Subtest: should return cre section from config
    ok 1 - should return cre section from config
      ---
      duration_ms: 0.5848
      ...
    # Subtest: should create cre section if missing
    ok 2 - should create cre section if missing
      ---
      duration_ms: 0.3222
      ...
    1..2
ok 15 - getCreConfig
  ---
  duration_ms: 1.436
  type: 'suite'
  ...
# Subtest: CRE getConfig via index module (AC9)
    # Subtest: should return defaults when not initialized
    ok 1 - should return defaults when not initialized
      ---
      duration_ms: 40.5816
      ...
    1..1
ok 16 - CRE getConfig via index module (AC9)
  ---
  duration_ms: 40.9972
  type: 'suite'
  ...
# [CRE] test failed, retrying in 10ms: first fail
# [CRE] test failed, retrying in 10ms: always fails
# [CRE] test failed after retry: always fails
# [CRE] test failed, retrying in 50ms: fail
# [CRE] Schema violation at artifacts.bad.js.type: Artifact type "nonexistent_type" is not defined in the schema
# [CRE] Skipped 1 invalid element(s) due to schema violations
# [CRE] Schema violation at dependencies[1].from: Required field "from" is missing
# [CRE] Skipped 1 invalid element(s) due to schema violations
# [CRE] Artifact "src/deleted.js" references missing file "src/deleted.js", marked as stale
# [CRE] Marked 1 artifact(s) as stale (referencing deleted files)
# [CRE] Artifact "b.js" references missing file "b.js", marked as stale
# [CRE] Marked 1 artifact(s) as stale (referencing deleted files)
# [CRE] Plan dependency cycle detected involving: s1, s2
# [CRE] Plan dependency cycle detected involving: s3, s4
# [CRE] Plan dependency cycle detected involving: Auth Feature, Login Page
# Subtest: withRetry
    # Subtest: should return result on first success
    ok 1 - should return result on first success
      ---
      duration_ms: 2.4425
      ...
    # Subtest: should retry once and return result on second success
    ok 2 - should retry once and return result on second success
      ---
      duration_ms: 13.863
      ...
    # Subtest: should throw after retry fails
    ok 3 - should throw after retry fails
      ---
      duration_ms: 23.223
      ...
    # Subtest: should use custom delay
    ok 4 - should use custom delay
      ---
      duration_ms: 61.471
      ...
    1..4
ok 17 - withRetry
  ---
  duration_ms: 105.0714
  type: 'suite'
  ...
# Subtest: validateAndFilter
    # Subtest: should return instance unchanged when valid
    ok 1 - should return instance unchanged when valid
      ---
      duration_ms: 3.4167
      ...
    # Subtest: should skip artifacts with invalid type
    ok 2 - should skip artifacts with invalid type
      ---
      duration_ms: 0.807
      ...
    # Subtest: should skip dependencies with validation errors
    ok 3 - should skip dependencies with validation errors
      ---
      duration_ms: 1.0022
      ...
    # Subtest: should handle null instance gracefully
    ok 4 - should handle null instance gracefully
      ---
      duration_ms: 0.4584
      ...
    # Subtest: should handle null schema gracefully
    ok 5 - should handle null schema gracefully
      ---
      duration_ms: 0.4621
      ...
    1..5
ok 18 - validateAndFilter
  ---
  duration_ms: 6.9644
  type: 'suite'
  ...
# Subtest: markStaleArtifacts
    # Subtest: should mark artifacts with missing file paths as stale
    ok 1 - should mark artifacts with missing file paths as stale
      ---
      duration_ms: 0.7961
      ...
    # Subtest: should clear stale flag when file reappears
    ok 2 - should clear stale flag when file reappears
      ---
      duration_ms: 0.448
      ...
    # Subtest: should mark dependencies to stale artifacts
    ok 3 - should mark dependencies to stale artifacts
      ---
      duration_ms: 0.799
      ...
    # Subtest: should handle null instance
    ok 4 - should handle null instance
      ---
      duration_ms: 0.4054
      ...
    # Subtest: should accept array of files
    ok 5 - should accept array of files
      ---
      duration_ms: 0.3275
      ...
    1..5
ok 19 - markStaleArtifacts
  ---
  duration_ms: 3.2346
  type: 'suite'
  ...
# Subtest: detectPlanCycles
    # Subtest: should detect no cycle in linear dependencies
    ok 1 - should detect no cycle in linear dependencies
      ---
      duration_ms: 1.6622
      ...
    # Subtest: should detect a simple cycle
    ok 2 - should detect a simple cycle
      ---
      duration_ms: 0.7735
      ...
    # Subtest: should detect cycle in larger graph
    ok 3 - should detect cycle in larger graph
      ---
      duration_ms: 0.6383
      ...
    # Subtest: should handle stories with no dependencies
    ok 4 - should handle stories with no dependencies
      ---
      duration_ms: 0.757
      ...
    # Subtest: should handle empty array
    ok 5 - should handle empty array
      ---
      duration_ms: 0.3434
      ...
    # Subtest: should handle null
    ok 6 - should handle null
      ---
      duration_ms: 0.2561
      ...
    # Subtest: should ignore external dependencies not in story list
    ok 7 - should ignore external dependencies not in story list
      ---
      duration_ms: 0.3857
      ...
    # Subtest: should use title in cycle labels when available
    ok 8 - should use title in cycle labels when available
      ---
      duration_ms: 0.49
      ...
    1..8
ok 20 - detectPlanCycles
  ---
  duration_ms: 6.1164
  type: 'suite'
  ...
# [CRE-ORCH] Generating plan for sprint: sprint-1
# [CRE-ORCH] Submitting answers for plan: plan-1
# [CRE-ORCH] Plan ready for user review: plan-1
# [CRE-ORCH] Generating plan for sprint: sprint-1
# [CRE-ORCH] Submitting answers for plan: plan-1
# [CRE-ORCH] Plan ready for user review: plan-1
# [CRE-ORCH] Generating plan for sprint: sprint-1
# [CRE-ORCH] Plan ready for user review: plan-1
# [CRE-ORCH] Generating plan for sprint: sprint-1
# [CRE-ORCH] Submitting answers for plan: plan-1
# [CRE-ORCH] Plan ready for user review: plan-1
# [CRE-ORCH] Generating plan for sprint: sprint-1
# [CRE-ORCH] Generating plan for sprint: sprint-1
# [CRE-ORCH] Generating plan for sprint: sprint-1
# [CRE-ORCH] Submitting answers for plan: plan-1
# [CRE-ORCH] Plan ready for user review: plan-1
# [CRE-ORCH] Approving plan: plan-1
# [CRE-ORCH] Generating RIS for story: S1 Story One
# [CRE-ORCH] Generating RIS for story: S2 Story Two
# [CRE-ORCH] Approval phase complete for plan: plan-1
# [CRE-ORCH] Approving plan: plan-1
# [CRE-ORCH] Generating RIS for story: S1 Story One
# [CRE-ORCH] Generating RIS for story: S2 Story Two
# [CRE-ORCH] Approval phase complete for plan: plan-1
# [CRE-ORCH] Approving plan: plan-1
# [CRE-ORCH] Approving plan: plan-1
# [CRE-ORCH] Approving plan: plan-1
# [CRE-ORCH] Generating RIS for story: S1 Story One
# [CRE-ORCH] Generating RIS for story: S2 Story Two
# [CRE-ORCH] Approval phase complete for plan: plan-1
# [CRE-ORCH] Approving plan: plan-1
# [CRE-ORCH] Generating RIS for story: S1 Story One
# [CRE-ORCH] Generating RIS for story: S2 Story Two
# [CRE-ORCH] Approval phase complete for plan: plan-1
# [CRE-ORCH] Refining plan: plan-1
# [CRE-ORCH] Refining plan: p
# [CRE-ORCH] Running introspection (cre:update-model)
# [CRE-ORCH] Introspection complete
# [CRE-ORCH] Running introspection (cre:update-model)
# [CRE-ORCH] Introspection complete
# Subtest: CRE Orchestrator - getState and reset
    # Subtest: should start in idle state
    ok 1 - should start in idle state
      ---
      duration_ms: 2.914
      ...
    # Subtest: reset should clear all state
    ok 2 - reset should clear all state
      ---
      duration_ms: 0.4615
      ...
    1..2
ok 21 - CRE Orchestrator - getState and reset
  ---
  duration_ms: 7.9183
  type: 'suite'
  ...
# Subtest: CRE Orchestrator - runPlanningPhase (plan generation only)
    # Subtest: should generate plan and return for user review without approving (AC2)
    ok 1 - should generate plan and return for user review without approving (AC2)
      ---
      duration_ms: 2.6704
      ...
    # Subtest: should call submitAnswers when provided
    ok 2 - should call submitAnswers when provided
      ---
      duration_ms: 1.0072
      ...
    # Subtest: should skip submitAnswers when not provided
    ok 3 - should skip submitAnswers when not provided
      ---
      duration_ms: 0.7153
      ...
    # Subtest: should acquire and release process lock (AC3)
    ok 4 - should acquire and release process lock (AC3)
      ---
      duration_ms: 1.5313
      ...
    # Subtest: should release lock on plan generation failure (AC3)
    ok 5 - should release lock on plan generation failure (AC3)
      ---
      duration_ms: 2.7467
      ...
    # Subtest: should set error state on failure
    ok 6 - should set error state on failure
      ---
      duration_ms: 1.1778
      ...
    # Subtest: should return to IDLE phase on success (user reviews plan)
    ok 7 - should return to IDLE phase on success (user reviews plan)
      ---
      duration_ms: 2.7935
      ...
    1..7
ok 22 - CRE Orchestrator - runPlanningPhase (plan generation only)
  ---
  duration_ms: 13.7093
  type: 'suite'
  ...
# Subtest: CRE Orchestrator - runApprovalPhase (user-initiated)
    # Subtest: should approve plan and generate RIS per story
    ok 1 - should approve plan and generate RIS per story
      ---
      duration_ms: 1.9366
      ...
    # Subtest: should acquire and release process lock (AC3)
    ok 2 - should acquire and release process lock (AC3)
      ---
      duration_ms: 0.9372
      ...
    # Subtest: should throw on approve failure
    ok 3 - should throw on approve failure
      ---
      duration_ms: 0.8946
      ...
    # Subtest: should release lock on approval failure
    ok 4 - should release lock on approval failure
      ---
      duration_ms: 0.6221
      ...
    # Subtest: should continue if one RIS fails (graceful degradation)
    ok 5 - should continue if one RIS fails (graceful degradation)
      ---
      duration_ms: 0.7122
      ...
    # Subtest: should reach COMPLETE phase on success
    ok 6 - should reach COMPLETE phase on success
      ---
      duration_ms: 0.5729
      ...
    1..6
ok 23 - CRE Orchestrator - runApprovalPhase (user-initiated)
  ---
  duration_ms: 6.5704
  type: 'suite'
  ...
# Subtest: CRE Orchestrator - runRefinement
    # Subtest: should refine plan and return data
    ok 1 - should refine plan and return data
      ---
      duration_ms: 0.7293
      ...
    # Subtest: should throw on refinement failure
    ok 2 - should throw on refinement failure
      ---
      duration_ms: 1.2158
      ...
    1..2
ok 24 - CRE Orchestrator - runRefinement
  ---
  duration_ms: 2.2841
  type: 'suite'
  ...
# Subtest: CRE Orchestrator - runIntrospection (AC5)
    # Subtest: should call updateModel and return result
    ok 1 - should call updateModel and return result
      ---
      duration_ms: 0.794
      ...
    # Subtest: should handle updateModel failure gracefully
    ok 2 - should handle updateModel failure gracefully
      ---
      duration_ms: 0.6645
      ...
    1..2
ok 25 - CRE Orchestrator - runIntrospection (AC5)
  ---
  duration_ms: 1.6762
  type: 'suite'
  ...
# [CRE-ORCH] Planning phase error: Plan generation failed: AI timeout
# [CRE-ORCH] Planning phase error: Plan generation failed: bad request
# [CRE-ORCH] Approval phase error: Plan approval failed: denied
# [CRE-ORCH] Approval phase error: Plan approval failed: denied
# [CRE-ORCH] RIS generation failed for story: S1 RIS fail
# [CRE-ORCH] Introspection warning: disk full
# [CRE] Malformed JSON in bad.json: Expected property name or '}' in JSON at position 1
# [CRE] Initialized default files: schema, instance, memo
# Subtest: CRE Storage - initialize
    # Subtest: should create .puffin/cre/ directory
    ok 1 - should create .puffin/cre/ directory
      ---
      duration_ms: 33.905
      ...
# [CRE] Initialized default files: schema, instance, memo
    # Subtest: should create .puffin/cre/plans/ directory
    ok 2 - should create .puffin/cre/plans/ directory
      ---
      duration_ms: 15.7015
      ...
# [CRE] Initialized default files: schema, instance, memo
    # Subtest: should create schema.json with base schema
    ok 3 - should create schema.json with base schema
      ---
      duration_ms: 24.3289
      ...
# [CRE] Initialized default files: schema, instance, memo
    # Subtest: should create instance.json with empty instance
    ok 4 - should create instance.json with empty instance
      ---
      duration_ms: 27.7557
      ...
# [CRE] Initialized default files: schema, instance, memo
    # Subtest: should create memo.json as empty object
    ok 5 - should create memo.json as empty object
      ---
      duration_ms: 25.331
      ...
# [CRE] Initialized default files: schema, instance, memo
    # Subtest: should not overwrite existing files on re-init
    ok 6 - should not overwrite existing files on re-init
      ---
      duration_ms: 27.7855
      ...
    1..6
ok 26 - CRE Storage - initialize
  ---
  duration_ms: 159.3514
  type: 'suite'
  ...
# [CRE] Initialized default files: schema, instance, memo
# Subtest: CRE Storage - readJson error handling
    # Subtest: should throw descriptive error for missing file
    ok 1 - should throw descriptive error for missing file
      ---
      duration_ms: 24.369
      ...
# [CRE] Initialized default files: schema, instance, memo
    # Subtest: should throw descriptive error for malformed JSON
    ok 2 - should throw descriptive error for malformed JSON
      ---
      duration_ms: 30.157
      ...
    1..2
ok 27 - CRE Storage - readJson error handling
  ---
  duration_ms: 56.4658
  type: 'suite'
  ...
# [CRE] Initialized default files: schema, instance, memo
# Subtest: CRE Storage - writeJson atomic writes
    # Subtest: should write and read back data correctly
    ok 1 - should write and read back data correctly
      ---
      duration_ms: 30.4653
      ...
# [CRE] Initialized default files: schema, instance, memo
    # Subtest: should not leave .tmp files after successful write
    ok 2 - should not leave .tmp files after successful write
      ---
      duration_ms: 24.4465
      ...
    1..2
ok 28 - CRE Storage - writeJson atomic writes
  ---
  duration_ms: 55.9777
  type: 'suite'
  ...
# [CRE] Initialized default files: schema, instance, memo
# Subtest: CRE Storage - plan operations
    # Subtest: should write and read a plan by sprint ID
    ok 1 - should write and read a plan by sprint ID
      ---
      duration_ms: 32.5311
      ...
# [CRE] Initialized default files: schema, instance, memo
    # Subtest: should list plan files
    ok 2 - should list plan files
      ---
      duration_ms: 46.8493
      ...
# [CRE] Initialized default files: schema, instance, memo
    # Subtest: should return empty array when no plans exist
    ok 3 - should return empty array when no plans exist
      ---
      duration_ms: 21.0082
      ...
# [CRE] Initialized default files: schema, instance, memo
    # Subtest: should throw for nonexistent plan
    ok 4 - should throw for nonexistent plan
      ---
      duration_ms: 24.8752
      ...
    1..4
ok 29 - CRE Storage - plan operations
  ---
  duration_ms: 126.7082
  type: 'suite'
  ...
# [CRE] Initialized default files: schema, instance, memo
# Subtest: CRE Storage - schema/instance/memo CRUD
    # Subtest: should round-trip schema
    ok 1 - should round-trip schema
      ---
      duration_ms: 35.7872
      ...
# [CRE] Initialized default files: schema, instance, memo
    # Subtest: should round-trip instance
    ok 2 - should round-trip instance
      ---
      duration_ms: 26.8548
      ...
# [CRE] Initialized default files: schema, instance, memo
    # Subtest: should round-trip memo
    ok 3 - should round-trip memo
      ---
      duration_ms: 32.5636
      ...
    1..3
ok 30 - CRE Storage - schema/instance/memo CRUD
  ---
  duration_ms: 96.4035
  type: 'suite'
  ...
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE-AI] analyze-ambiguities failed: mock
# [CRE-PLAN] AI ambiguity analysis unavailable, proceeding without questions
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE-AI] analyze-ambiguities failed: mock
# [CRE-PLAN] AI ambiguity analysis unavailable, proceeding without questions
# [CRE-AI] generate-plan failed: mock
# [CRE-PLAN] AI plan generation failed: mock
# [CRE-PLAN] Creating empty plan skeleton — user will need to request changes
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE-AI] analyze-ambiguities failed: mock
# [CRE-PLAN] AI ambiguity analysis unavailable, proceeding without questions
# [CRE-AI] generate-plan failed: mock
# [CRE-PLAN] AI plan generation failed: mock
# [CRE-PLAN] Creating empty plan skeleton — user will need to request changes
# [CRE-AI] refine-plan failed: mock
# [CRE-PLAN] AI refinement unavailable, plan unchanged
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE-AI] analyze-ambiguities failed: mock
# [CRE-PLAN] AI ambiguity analysis unavailable, proceeding without questions
# [CRE-AI] generate-plan failed: mock
# [CRE-PLAN] AI plan generation failed: mock
# [CRE-PLAN] Creating empty plan skeleton — user will need to request changes
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Shutdown complete
# Subtest: CRE index.js - initialize and shutdown
    # Subtest: should initialize with all required context fields
    ok 1 - should initialize with all required context fields
      ---
      duration_ms: 107.0516
      ...
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] generate-ris failed, retrying in 1000ms: User story not found: s1
# [CRE] generate-ris failed after retry: User story not found: s1
# [CRE] cre:generate-ris error: User story not found: s1
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] cre:update-model error: Cannot find module '../../h-dsl-engine/lib/freshness'
# Require stack:
# - C:\\Users\\jjdub\\code\\puffin\\src\\main\\cre\\index.js
# - C:\\Users\\jjdub\\code\\puffin\\tests\\cre\\index.test.js
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE-AI] generate-assertions failed: mock
# [CRE-ASSERT] AI assertion generation failed for story story-1
# [CRE-ASSERT] Error: mock
# [CRE] Story story-1 not found in user_stories — assertions only in inspection_assertions table
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Shutdown complete
    # Subtest: should register exactly 10 IPC handlers
    not ok 2 - should register exactly 10 IPC handlers
      ---
      duration_ms: 36.5874
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\cre\\index.test.js:90:3'
      failureType: 'testCodeFailure'
      error: |-
        Expected 11 handlers, got 12: cre:generate-plan, cre:submit-answers, cre:refine-plan, cre:approve-plan, cre:generate-ris, cre:generate-assertions, cre:verify-assertions, cre:update-model, cre:refresh-model, cre:query-model, cre:get-plan, cre:get-ris
        
        12 !== 11
        
      code: 'ERR_ASSERTION'
      name: 'AssertionError'
      expected: 11
      actual: 12
      operator: 'strictEqual'
      stack: |-
        TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\cre\index.test.js:100:12)
        async Test.run (node:internal/test_runner/test:797:9)
        async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Initialized
# [CRE] Shutdown complete
    # Subtest: should not register handlers twice on re-initialize
    ok 3 - should not register handlers twice on re-initialize
      ---
      duration_ms: 45.6441
      ...
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE-AI] analyze-ambiguities failed: mock
# [CRE-PLAN] AI ambiguity analysis unavailable, proceeding without questions
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] cre:generate-plan error: Claude CLI process is busy. Wait for the current operation to complete.
# [CRE] Schema has 1 validation warning(s):
# [CRE]   elementTypes.module.fields.children.m3Type: Field "children" has invalid m3Type "SLOT". Must be TERM or PROSE
# [CRE] cre:update-model error: Cannot find module '../../h-dsl-engine/lib/freshness'
# Require stack:
# - C:\\Users\\jjdub\\code\\puffin\\src\\main\\cre\\index.js
# - C:\\Users\\jjdub\\code\\puffin\\tests\\cre\\index.test.js
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Shutdown complete
    # Subtest: should accept claudeService in context
    ok 4 - should accept claudeService in context
      ---
      duration_ms: 31.4343
      ...
    # Subtest: shutdown should not throw when not initialized
    ok 5 - shutdown should not throw when not initialized
      ---
      duration_ms: 7.8414
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Shutdown complete
# [CRE] Process lock acquired
    # Subtest: shutdown should release process lock if held
    not ok 6 - shutdown should release process lock if held
      ---
      duration_ms: 26.8079
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\cre\\index.test.js:152:3'
      failureType: 'testCodeFailure'
      error: |-
        Expected values to be strictly equal:
        
        true !== false
        
      code: 'ERR_ASSERTION'
      name: 'AssertionError'
      expected: false
      actual: true
      operator: 'strictEqual'
      stack: |-
        TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\cre\index.test.js:168:12)
        async Test.run (node:internal/test_runner/test:797:9)
        async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
      ...
    1..6
not ok 31 - CRE index.js - initialize and shutdown
  ---
  duration_ms: 260.8627
  type: 'suite'
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\cre\\index.test.js:65:1'
  failureType: 'subtestsFailed'
  error: '2 subtests failed'
  code: 'ERR_TEST_FAILURE'
  ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Shutdown complete
# Subtest: CRE IPC handler response format
    # Subtest: cre:generate-plan returns error on missing args
    ok 1 - cre:generate-plan returns error on missing args
      ---
      duration_ms: 41.2999
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Process lock acquired
# [CRE-PLAN] State: idle → analyzing
# [CRE-AI] Sending analyze-ambiguities (model: haiku, timeout: 60000ms)
# [CRE-AI] analyze-ambiguities: using --json-schema for structured output
# [CRE-PLAN] State: analyzing → questions_pending
# [CRE] Process lock released
# [CRE] Shutdown complete
    # Subtest: cre:generate-plan returns success with questions
    ok 2 - cre:generate-plan returns success with questions
      ---
      duration_ms: 45.228
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Shutdown complete
    # Subtest: cre:submit-answers returns error on missing args
    ok 3 - cre:submit-answers returns error on missing args
      ---
      duration_ms: 31.6578
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Process lock acquired
# [CRE-PLAN] State: idle → analyzing
# [CRE-AI] Sending analyze-ambiguities (model: haiku, timeout: 60000ms)
# [CRE-AI] analyze-ambiguities: using --json-schema for structured output
# [CRE-PLAN] State: analyzing → questions_pending
# [CRE] Process lock released
# [CRE] Process lock acquired
# [CRE-PLAN] State: questions_pending → generating
# [CRE-AI] Sending generate-plan (model: sonnet, timeout: 120000ms)
# [CRE-AI] generate-plan: using --json-schema for structured output
# [CRE-PLAN] State: generating → review_pending
# [CRE] Process lock released
# [CRE] Shutdown complete
    # Subtest: cre:submit-answers returns success with valid args
    ok 4 - cre:submit-answers returns success with valid args
      ---
      duration_ms: 55.9975
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Shutdown complete
    # Subtest: cre:refine-plan returns error on missing args
    ok 5 - cre:refine-plan returns error on missing args
      ---
      duration_ms: 30.3509
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Process lock acquired
# [CRE-PLAN] State: idle → analyzing
# [CRE-AI] Sending analyze-ambiguities (model: haiku, timeout: 60000ms)
# [CRE-AI] analyze-ambiguities: using --json-schema for structured output
# [CRE-PLAN] State: analyzing → questions_pending
# [CRE] Process lock released
# [CRE] Process lock acquired
# [CRE-PLAN] State: questions_pending → generating
# [CRE-AI] Sending generate-plan (model: sonnet, timeout: 120000ms)
# [CRE-AI] generate-plan: using --json-schema for structured output
# [CRE-PLAN] State: generating → review_pending
# [CRE] Process lock released
# [CRE] Process lock acquired
# [CRE-PLAN] State: review_pending → generating
# [CRE-AI] Sending refine-plan (model: sonnet, timeout: 120000ms)
# [CRE-AI] refine-plan: using --json-schema for structured output
# [CRE-PLAN] State: generating → review_pending
# [CRE] Process lock released
# [CRE] Shutdown complete
    # Subtest: cre:refine-plan returns success with valid args
    ok 6 - cre:refine-plan returns success with valid args
      ---
      duration_ms: 50.2545
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Shutdown complete
    # Subtest: cre:approve-plan returns error on missing planId
    ok 7 - cre:approve-plan returns error on missing planId
      ---
      duration_ms: 28.3223
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Process lock acquired
# [CRE-PLAN] State: idle → analyzing
# [CRE-AI] Sending analyze-ambiguities (model: haiku, timeout: 60000ms)
# [CRE-AI] analyze-ambiguities: using --json-schema for structured output
# [CRE-PLAN] State: analyzing → questions_pending
# [CRE] Process lock released
# [CRE] Process lock acquired
# [CRE-PLAN] State: questions_pending → generating
# [CRE-AI] Sending generate-plan (model: sonnet, timeout: 120000ms)
# [CRE-AI] generate-plan: using --json-schema for structured output
# [CRE-PLAN] State: generating → review_pending
# [CRE] Process lock released
# [CRE] Process lock acquired
# [CRE-PLAN] State: review_pending → approved
# [CRE-PLAN] Plan 15d0109d-b1f5-40c0-8925-922dc4e15c06 approved. 0 assertion prompts generated.
# [CRE-PLAN] State: approved → idle
# [CRE] Process lock released
# [CRE] Shutdown complete
    # Subtest: cre:approve-plan returns success with valid args
    ok 8 - cre:approve-plan returns success with valid args
      ---
      duration_ms: 43.5583
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Shutdown complete
    # Subtest: cre:generate-ris returns error on missing args
    ok 9 - cre:generate-ris returns error on missing args
      ---
      duration_ms: 35.9598
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Process lock acquired
# [CRE] Process lock released
# [CRE] Shutdown complete
    # Subtest: cre:generate-ris returns success with valid args
    not ok 10 - cre:generate-ris returns success with valid args
      ---
      duration_ms: 1049.3081
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\cre\\index.test.js:271:3'
      failureType: 'testCodeFailure'
      error: |-
        Expected values to be strictly equal:
        
        false !== true
        
      code: 'ERR_ASSERTION'
      name: 'AssertionError'
      expected: true
      actual: false
      operator: 'strictEqual'
      stack: |-
        TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\cre\index.test.js:275:12)
        async Test.run (node:internal/test_runner/test:797:9)
        async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Shutdown complete
    # Subtest: cre:update-model returns success
    not ok 11 - cre:update-model returns success
      ---
      duration_ms: 37.168
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\cre\\index.test.js:278:3'
      failureType: 'testCodeFailure'
      error: |-
        Expected values to be strictly equal:
        
        false !== true
        
      code: 'ERR_ASSERTION'
      name: 'AssertionError'
      expected: true
      actual: false
      operator: 'strictEqual'
      stack: |-
        TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\cre\index.test.js:280:12)
        async Test.run (node:internal/test_runner/test:797:9)
        async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Shutdown complete
    # Subtest: cre:query-model returns error on missing taskDescription
    ok 12 - cre:query-model returns error on missing taskDescription
      ---
      duration_ms: 37.8456
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Shutdown complete
    # Subtest: cre:get-plan returns error on missing sprintId
    ok 13 - cre:get-plan returns error on missing sprintId
      ---
      duration_ms: 36.9159
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Shutdown complete
    # Subtest: cre:get-ris returns error on missing storyId
    ok 14 - cre:get-ris returns error on missing storyId
      ---
      duration_ms: 38.9208
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Shutdown complete
    # Subtest: cre:generate-assertions returns error on missing args
    ok 15 - cre:generate-assertions returns error on missing args
      ---
      duration_ms: 39.2831
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Process lock acquired
# [CRE-AI] Sending generate-assertions (model: haiku, timeout: 60000ms)
# [CRE-AI] generate-assertions: using --json-schema for structured output
# [CRE] Process lock released
# [CRE] Shutdown complete
    # Subtest: cre:generate-assertions returns success with valid args
    ok 16 - cre:generate-assertions returns success with valid args
      ---
      duration_ms: 48.0152
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Shutdown complete
    # Subtest: cre:verify-assertions returns error on missing args
    ok 17 - cre:verify-assertions returns error on missing args
      ---
      duration_ms: 38.0448
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Process lock acquired
# [CRE] Process lock released
# [CRE] Shutdown complete
    # Subtest: cre:verify-assertions returns success with planId
    ok 18 - cre:verify-assertions returns success with planId
      ---
      duration_ms: 39.9035
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Shutdown complete
# [CRE] Shutdown complete
    # Subtest: cre:get-ris returns null data for nonexistent story
    ok 19 - cre:get-ris returns null data for nonexistent story
      ---
      duration_ms: 57.3707
      ...
    1..19
not ok 32 - CRE IPC handler response format
  ---
  duration_ms: 1793.8343
  type: 'suite'
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\cre\\index.test.js:174:1'
  failureType: 'subtestsFailed'
  error: '2 subtests failed'
  code: 'ERR_TEST_FAILURE'
  ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Process lock acquired
# [CRE] Process lock released
# [CRE] Shutdown complete
# Subtest: CRE process lock management
    # Subtest: acquireProcessLock sets _processLock on claudeService
    ok 1 - acquireProcessLock sets _processLock on claudeService
      ---
      duration_ms: 41.2526
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Shutdown complete
# [CRE] Process lock acquired
    # Subtest: releaseProcessLock clears _processLock on claudeService
    not ok 2 - releaseProcessLock clears _processLock on claudeService
      ---
      duration_ms: 33.5212
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\cre\\index.test.js:376:3'
      failureType: 'testCodeFailure'
      error: |-
        Expected values to be strictly equal:
        
        true !== false
        
      code: 'ERR_ASSERTION'
      name: 'AssertionError'
      expected: false
      actual: true
      operator: 'strictEqual'
      stack: |-
        TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\cre\index.test.js:379:12)
        Test.runInAsyncScope (node:async_hooks:206:9)
        Test.run (node:internal/test_runner/test:796:25)
        async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Shutdown complete
    # Subtest: acquireProcessLock throws when claudeService is already busy
    not ok 3 - acquireProcessLock throws when claudeService is already busy
      ---
      duration_ms: 41.2386
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\cre\\index.test.js:382:3'
      failureType: 'testCodeFailure'
      error: 'Missing expected exception.'
      code: 'ERR_ASSERTION'
      name: 'AssertionError'
      expected:
        message:
      operator: 'throws'
      stack: |-
        TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\cre\index.test.js:384:12)
        Test.runInAsyncScope (node:async_hooks:206:9)
        Test.run (node:internal/test_runner/test:796:25)
        async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Process lock acquired
# [CRE] Process lock released
# [CRE] Shutdown complete
    # Subtest: withProcessLock acquires and releases around async work
    ok 4 - withProcessLock acquires and releases around async work
      ---
      duration_ms: 38.8339
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Process lock acquired
# [CRE] Process lock released
# [CRE] Shutdown complete
    # Subtest: withProcessLock releases lock on error
    ok 5 - withProcessLock releases lock on error
      ---
      duration_ms: 36.3083
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Process lock acquired
# [CRE-PLAN] State: idle → analyzing
# [CRE-AI] Sending analyze-ambiguities (model: haiku, timeout: 60000ms)
# [CRE-AI] analyze-ambiguities: using --json-schema for structured output
# [CRE-PLAN] State: analyzing → questions_pending
# [CRE] Process lock released
# [CRE] Shutdown complete
    # Subtest: active IPC handlers acquire process lock
    ok 6 - active IPC handlers acquire process lock
      ---
      duration_ms: 40.5231
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Shutdown complete
    # Subtest: active IPC handler returns error when CLI is busy
    ok 7 - active IPC handler returns error when CLI is busy
      ---
      duration_ms: 40.7655
      ...
# [CRE] Initialized default files: schema, instance, memo
# [CRE] Registered 11 IPC handlers
# [CRE] Initialized
# [CRE] Shutdown complete
    # Subtest: read-only handlers work even when CLI is busy
    not ok 8 - read-only handlers work even when CLI is busy
      ---
      duration_ms: 48.6884
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\cre\\index.test.js:430:3'
      failureType: 'testCodeFailure'
      error: |-
        Expected values to be strictly equal:
        
        false !== true
        
      code: 'ERR_ASSERTION'
      name: 'AssertionError'
      expected: true
      actual: false
      operator: 'strictEqual'
      stack: |-
        TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\cre\index.test.js:434:12)
        async Test.run (node:internal/test_runner/test:797:9)
        async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
      ...
    1..8
not ok 33 - CRE process lock management
  ---
  duration_ms: 324.9508
  type: 'suite'
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\cre\\index.test.js:348:1'
  failureType: 'subtestsFailed'
  error: '3 subtests failed'
  code: 'ERR_TEST_FAILURE'
  ...
1..3
# Subtest: C:\\Users\\jjdub\\code\\puffin\\tests\\cre\\index.test.js
not ok 6 - C:\\Users\\jjdub\\code\\puffin\\tests\\cre\\index.test.js
  ---
  duration_ms: 3185.1076
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\cre\\index.test.js:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# [CRE-PLAN] State: idle → analyzing
# [CRE-PLAN] State: idle → analyzing
# [CRE-PLAN] State: analyzing → questions_pending
# [CRE-PLAN] State: idle → analyzing
# [CRE-PLAN] State: analyzing → questions_pending
# [CRE-PLAN] State: idle → analyzing
# [CRE-PLAN] State: analyzing → questions_pending
# [CRE-PLAN] State: idle → analyzing
# [CRE-PLAN] State: analyzing → questions_pending
# [CRE-PLAN] State: idle → analyzing
# [CRE-PLAN] State: analyzing → questions_pending
# [CRE-PLAN] State: questions_pending → generating
# [CRE-PLAN] State: generating → review_pending
# [CRE-PLAN] State: idle → analyzing
# [CRE-PLAN] State: analyzing → questions_pending
# [CRE-PLAN] State: questions_pending → generating
# [CRE-PLAN] State: generating → review_pending
# [CRE-PLAN] State: idle → analyzing
# [CRE-PLAN] State: analyzing → questions_pending
# [CRE-PLAN] State: questions_pending → generating
# [CRE-PLAN] State: generating → review_pending
# [CRE-PLAN] State: idle → analyzing
# [CRE-PLAN] State: analyzing → questions_pending
# [CRE-PLAN] generatePlan: resetting from idle to QUESTIONS_PENDING
# [CRE-PLAN] State: questions_pending → generating
# [CRE-PLAN] State: idle → analyzing
# [CRE-PLAN] State: analyzing → questions_pending
# [CRE-PLAN] State: questions_pending → generating
# [CRE-PLAN] State: generating → review_pending
# [CRE-PLAN] State: review_pending → generating
# [CRE-PLAN] State: generating → review_pending
# [CRE-PLAN] State: idle → analyzing
# [CRE-PLAN] State: analyzing → questions_pending
# [CRE-PLAN] State: questions_pending → generating
# [CRE-PLAN] State: generating → review_pending
# [CRE-PLAN] State: review_pending → generating
# [CRE-PLAN] State: generating → review_pending
# [CRE-PLAN] State: idle → analyzing
# [CRE-PLAN] State: analyzing → questions_pending
# [CRE-PLAN] State: questions_pending → generating
# [CRE-PLAN] State: generating → review_pending
# [CRE-PLAN] State: idle → analyzing
# [CRE-PLAN] State: analyzing → questions_pending
# [CRE-PLAN] State: questions_pending → generating
# [CRE-PLAN] State: generating → review_pending
# [CRE-PLAN] State: review_pending → generating
# [CRE-PLAN] State: generating → review_pending
# [CRE-PLAN] State: idle → analyzing
# [CRE-PLAN] State: analyzing → questions_pending
# [CRE-PLAN] State: questions_pending → generating
# [CRE-PLAN] State: generating → review_pending
# [CRE-PLAN] State: review_pending → approved
# [CRE-PLAN] Plan 9193fef5-7294-4612-9acb-00c4e2939e7a approved. 0 assertion prompts generated.
# [CRE-PLAN] State: approved → idle
# [CRE-PLAN] State: idle → analyzing
# [CRE-PLAN] State: analyzing → questions_pending
# [CRE-PLAN] State: questions_pending → generating
# [CRE-PLAN] State: generating → review_pending
# [CRE-PLAN] State: review_pending → approved
# [CRE-PLAN] Plan e0944041-bdbe-45c0-ba37-bcdef80be5aa approved. 0 assertion prompts generated.
# [CRE-PLAN] State: approved → idle
# [CRE-PLAN] State: idle → analyzing
# [CRE-PLAN] State: analyzing → questions_pending
# [CRE-PLAN] State: questions_pending → generating
# [CRE-PLAN] State: generating → review_pending
# [CRE-PLAN] State: review_pending → approved
# [CRE-PLAN] Plan 40d514d8-d41c-4ebb-b075-621897ea4d74 approved. 0 assertion prompts generated.
# [CRE-PLAN] State: approved → idle
# [CRE-PLAN] State: idle → analyzing
# [CRE-PLAN] State: analyzing → questions_pending
# [CRE-PLAN] State: questions_pending → generating
# [CRE-PLAN] State: generating → review_pending
# [CRE-PLAN] State: review_pending → approved
# [CRE-PLAN] Plan 0c32ee2a-c0b6-4fec-ad21-7c1161b688bb approved. 0 assertion prompts generated.
# [CRE-PLAN] State: approved → idle
# [CRE-PLAN] State: idle → analyzing
# [CRE-PLAN] State: analyzing → questions_pending
# [CRE-PLAN] State: questions_pending → generating
# [CRE-PLAN] State: generating → review_pending
# [CRE-PLAN] State: review_pending → approved
# [CRE-PLAN] Plan f8bb751c-d5c4-447f-85aa-9bb43f66a420 approved. 0 assertion prompts generated.
# [CRE-PLAN] State: approved → idle
# [CRE-PLAN] State: idle → analyzing
# [CRE-PLAN] State: analyzing → questions_pending
# [CRE-PLAN] State: questions_pending → generating
# [CRE-PLAN] State: generating → review_pending
# [CRE-PLAN] State: idle → analyzing
# [CRE-PLAN] State: analyzing → questions_pending
# [CRE-PLAN] State: questions_pending → generating
# [CRE-PLAN] State: generating → review_pending
# [CRE-PLAN] State: review_pending → generating
# [CRE-PLAN] State: generating → review_pending
# [CRE-PLAN] State: review_pending → approved
# [CRE-PLAN] Plan fb2a806e-5f51-46c2-95a4-107bb243d8e5 approved. 0 assertion prompts generated.
# [CRE-PLAN] State: approved → idle
# [CRE-PLAN] State: idle → analyzing
# [CRE-PLAN] State: analyzing → questions_pending
# [CRE-PLAN] State: questions_pending → generating
# [CRE-PLAN] State: generating → review_pending
# [CRE-PLAN] State: review_pending → generating
# [CRE-PLAN] State: generating → review_pending
# [CRE-PLAN] State: review_pending → generating
# [CRE-PLAN] State: generating → review_pending
# [CRE-PLAN] State: idle → analyzing
# [CRE-PLAN] State: analyzing → questions_pending
# Subtest: PlanState and VALID_TRANSITIONS (AC6)
    # Subtest: should define all 6 states
    ok 1 - should define all 6 states
      ---
      duration_ms: 2.5498
      ...
    # Subtest: should define valid transitions for all states
    ok 2 - should define valid transitions for all states
      ---
      duration_ms: 0.4065
      ...
    # Subtest: IDLE can only go to ANALYZING
    ok 3 - IDLE can only go to ANALYZING
      ---
      duration_ms: 1.3401
      ...
    # Subtest: APPROVED can go back to IDLE
    ok 4 - APPROVED can go back to IDLE
      ---
      duration_ms: 0.2497
      ...
    1..4
ok 35 - PlanState and VALID_TRANSITIONS (AC6)
  ---
  duration_ms: 8.962
  type: 'suite'
  ...
# Subtest: PlanGenerator - state machine (AC6)
    # Subtest: should start in IDLE state
    ok 1 - should start in IDLE state
      ---
      duration_ms: 13.6379
      ...
    # Subtest: should reject invalid transitions
    ok 2 - should reject invalid transitions
      ---
      duration_ms: 8.1017
      ...
    # Subtest: should allow valid transitions
    ok 3 - should allow valid transitions
      ---
      duration_ms: 13.9381
      ...
    1..3
ok 36 - PlanGenerator - state machine (AC6)
  ---
  duration_ms: 36.5901
  type: 'suite'
  ...
# Subtest: PlanGenerator - analyzeSprint (AC2)
    # Subtest: should transition to QUESTIONS_PENDING
    ok 1 - should transition to QUESTIONS_PENDING
      ---
      duration_ms: 18.814
      ...
    # Subtest: should return a planId
    ok 2 - should return a planId
      ---
      duration_ms: 13.2484
      ...
    # Subtest: should insert a plan row into DB (AC8)
    ok 3 - should insert a plan row into DB (AC8)
      ---
      duration_ms: 11.4215
      ...
    # Subtest: should return prompt data
    ok 4 - should return prompt data
      ---
      duration_ms: 10.3526
      ...
    1..4
ok 37 - PlanGenerator - analyzeSprint (AC2)
  ---
  duration_ms: 55.0379
  type: 'suite'
  ...
# Subtest: PlanGenerator - generatePlan (AC3)
    # Subtest: should transition to REVIEW_PENDING
    ok 1 - should transition to REVIEW_PENDING
      ---
      duration_ms: 16.9194
      ...
    # Subtest: should return plan with expected structure
    ok 2 - should return plan with expected structure
      ---
      duration_ms: 14.3499
      ...
    # Subtest: should save plan to file (AC7)
    ok 3 - should save plan to file (AC7)
      ---
      duration_ms: 13.8002
      ...
    # Subtest: should reject if called from IDLE (no analysis done)
    not ok 4 - should reject if called from IDLE (no analysis done)
      ---
      duration_ms: 22.7491
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\cre\\plan-generator.test.js:228:3'
      failureType: 'testCodeFailure'
      error: |-
        Expected values to be strictly deep-equal:
        + actual - expected
        
          Comparison {
        +   message: 'No active plan. Call analyzeSprint() first.'
        -   message: /Invalid state transition/
          }
      code: 'ERR_ASSERTION'
      name: 'AssertionError'
      expected:
        message:
      actual:
      error: 'No active plan. Call analyzeSprint() first.'
      stack: |-
        PlanGenerator.generatePlan (C:\Users\jjdub\code\puffin\src\main\cre\plan-generator.js:226:13)
        assert.rejects.message (C:\Users\jjdub\code\puffin\tests\cre\plan-generator.test.js:237:18)
        waitForActual (node:assert:519:21)
        Function.rejects (node:assert:654:31)
        TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\cre\plan-generator.test.js:236:18)
        Test.runInAsyncScope (node:async_hooks:206:9)
        Test.run (node:internal/test_runner/test:796:25)
        async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
      operator: 'rejects'
      stack: |-
        async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\cre\plan-generator.test.js:236:5)
        async Test.run (node:internal/test_runner/test:797:9)
        async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
      ...
    1..4
not ok 38 - PlanGenerator - generatePlan (AC3)
  ---
  duration_ms: 69.1297
  type: 'suite'
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\cre\\plan-generator.test.js:189:1'
  failureType: 'subtestsFailed'
  error: '1 subtest failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: PlanGenerator - refinePlan (AC4)
    # Subtest: should transition through GENERATING back to REVIEW_PENDING
    ok 1 - should transition through GENERATING back to REVIEW_PENDING
      ---
      duration_ms: 16.0497
      ...
    # Subtest: should increment iteration
    ok 2 - should increment iteration
      ---
      duration_ms: 18.2154
      ...
    # Subtest: should reject wrong planId
    ok 3 - should reject wrong planId
      ---
      duration_ms: 15.0317
      ...
    # Subtest: should update plan file (AC7)
    ok 4 - should update plan file (AC7)
      ---
      duration_ms: 17.4017
      ...
    1..4
ok 39 - PlanGenerator - refinePlan (AC4)
  ---
  duration_ms: 67.5772
  type: 'suite'
  ...
# Subtest: PlanGenerator - approvePlan (AC5)
    # Subtest: should transition to APPROVED then back to IDLE
    ok 1 - should transition to APPROVED then back to IDLE
      ---
      duration_ms: 17.7934
      ...
    # Subtest: should set plan status to approved in file (AC7)
    ok 2 - should set plan status to approved in file (AC7)
      ---
      duration_ms: 19.0634
      ...
    # Subtest: should update DB with approval (AC8)
    ok 3 - should update DB with approval (AC8)
      ---
      duration_ms: 18.205
      ...
    # Subtest: should return assertion prompts
    ok 4 - should return assertion prompts
      ---
      duration_ms: 22.1431
      ...
    # Subtest: should clear currentPlanId after approval
    ok 5 - should clear currentPlanId after approval
      ---
      duration_ms: 17.863
      ...
    # Subtest: should reject wrong planId
    ok 6 - should reject wrong planId
      ---
      duration_ms: 16.8011
      ...
    1..6
ok 40 - PlanGenerator - approvePlan (AC5)
  ---
  duration_ms: 113.164
  type: 'suite'
  ...
# Subtest: PlanGenerator - full lifecycle
    # Subtest: should complete full cycle: analyze → generate → refine → approve
    ok 1 - should complete full cycle: analyze → generate → refine → approve
      ---
      duration_ms: 26.7129
      ...
    # Subtest: should support multiple refine iterations before approval
    ok 2 - should support multiple refine iterations before approval
      ---
      duration_ms: 18.2517
      ...
    # Subtest: reset should return to IDLE
    ok 3 - reset should return to IDLE
      ---
      duration_ms: 13.2475
      ...
    1..3
ok 41 - PlanGenerator - full lifecycle
  ---
  duration_ms: 58.8576
  type: 'suite'
  ...
# [CRE-AI] No claudeService available for analyze-ambiguities, returning empty result
# [CRE-PLAN] AI ambiguity analysis unavailable, proceeding without questions
# [CRE-AI] No claudeService available for analyze-ambiguities, returning empty result
# [CRE-PLAN] AI ambiguity analysis unavailable, proceeding without questions
# [CRE-AI] No claudeService available for analyze-ambiguities, returning empty result
# [CRE-PLAN] AI ambiguity analysis unavailable, proceeding without questions
# [CRE-AI] No claudeService available for analyze-ambiguities, returning empty result
# [CRE-PLAN] AI ambiguity analysis unavailable, proceeding without questions
# [CRE-AI] No claudeService available for analyze-ambiguities, returning empty result
# [CRE-PLAN] AI ambiguity analysis unavailable, proceeding without questions
# [CRE-AI] No claudeService available for generate-plan, returning empty result
# [CRE-PLAN] AI plan generation failed: claudeService not available
# [CRE-PLAN] Creating empty plan skeleton — user will need to request changes
# [CRE-AI] No claudeService available for analyze-ambiguities, returning empty result
# [CRE-PLAN] AI ambiguity analysis unavailable, proceeding without questions
# [CRE-AI] No claudeService available for generate-plan, returning empty result
# [CRE-PLAN] AI plan generation failed: claudeService not available
# [CRE-PLAN] Creating empty plan skeleton — user will need to request changes
# [CRE-AI] No claudeService available for analyze-ambiguities, returning empty result
# [CRE-PLAN] AI ambiguity analysis unavailable, proceeding without questions
# [CRE-AI] No claudeService available for generate-plan, returning empty result
# [CRE-PLAN] AI plan generation failed: claudeService not available
# [CRE-PLAN] Creating empty plan skeleton — user will need to request changes
# [CRE-AI] No claudeService available for analyze-ambiguities, returning empty result
# [CRE-PLAN] AI ambiguity analysis unavailable, proceeding without questions
# [CRE-AI] No claudeService available for analyze-ambiguities, returning empty result
# [CRE-PLAN] AI ambiguity analysis unavailable, proceeding without questions
# [CRE-AI] No claudeService available for generate-plan, returning empty result
# [CRE-PLAN] AI plan generation failed: claudeService not available
# [CRE-PLAN] Creating empty plan skeleton — user will need to request changes
# [CRE-AI] No claudeService available for refine-plan, returning empty result
# [CRE-PLAN] AI refinement unavailable, plan unchanged
# [CRE-AI] No claudeService available for analyze-ambiguities, returning empty result
# [CRE-PLAN] AI ambiguity analysis unavailable, proceeding without questions
# [CRE-AI] No claudeService available for generate-plan, returning empty result
# [CRE-PLAN] AI plan generation failed: claudeService not available
# [CRE-PLAN] Creating empty plan skeleton — user will need to request changes
# [CRE-AI] No claudeService available for refine-plan, returning empty result
# [CRE-PLAN] AI refinement unavailable, plan unchanged
# [CRE-AI] No claudeService available for analyze-ambiguities, returning empty result
# [CRE-PLAN] AI ambiguity analysis unavailable, proceeding without questions
# [CRE-AI] No claudeService available for generate-plan, returning empty result
# [CRE-PLAN] AI plan generation failed: claudeService not available
# [CRE-PLAN] Creating empty plan skeleton — user will need to request changes
# [CRE-AI] No claudeService available for analyze-ambiguities, returning empty result
# [CRE-PLAN] AI ambiguity analysis unavailable, proceeding without questions
# [CRE-AI] No claudeService available for generate-plan, returning empty result
# [CRE-PLAN] AI plan generation failed: claudeService not available
# [CRE-PLAN] Creating empty plan skeleton — user will need to request changes
# [CRE-AI] No claudeService available for refine-plan, returning empty result
# [CRE-PLAN] AI refinement unavailable, plan unchanged
# [CRE-AI] No claudeService available for analyze-ambiguities, returning empty result
# [CRE-PLAN] AI ambiguity analysis unavailable, proceeding without questions
# [CRE-AI] No claudeService available for generate-plan, returning empty result
# [CRE-PLAN] AI plan generation failed: claudeService not available
# [CRE-PLAN] Creating empty plan skeleton — user will need to request changes
# [CRE-AI] No claudeService available for analyze-ambiguities, returning empty result
# [CRE-PLAN] AI ambiguity analysis unavailable, proceeding without questions
# [CRE-AI] No claudeService available for generate-plan, returning empty result
# [CRE-PLAN] AI plan generation failed: claudeService not available
# [CRE-PLAN] Creating empty plan skeleton — user will need to request changes
# [CRE-AI] No claudeService available for analyze-ambiguities, returning empty result
# [CRE-PLAN] AI ambiguity analysis unavailable, proceeding without questions
# [CRE-AI] No claudeService available for generate-plan, returning empty result
# [CRE-PLAN] AI plan generation failed: claudeService not available
# [CRE-PLAN] Creating empty plan skeleton — user will need to request changes
# [CRE-AI] No claudeService available for analyze-ambiguities, returning empty result
# [CRE-PLAN] AI ambiguity analysis unavailable, proceeding without questions
# [CRE-AI] No claudeService available for generate-plan, returning empty result
# [CRE-PLAN] AI plan generation failed: claudeService not available
# [CRE-PLAN] Creating empty plan skeleton — user will need to request changes
# [CRE-AI] No claudeService available for analyze-ambiguities, returning empty result
# [CRE-PLAN] AI ambiguity analysis unavailable, proceeding without questions
# [CRE-AI] No claudeService available for generate-plan, returning empty result
# [CRE-PLAN] AI plan generation failed: claudeService not available
# [CRE-PLAN] Creating empty plan skeleton — user will need to request changes
# [CRE-AI] No claudeService available for analyze-ambiguities, returning empty result
# [CRE-PLAN] AI ambiguity analysis unavailable, proceeding without questions
# [CRE-AI] No claudeService available for generate-plan, returning empty result
# [CRE-PLAN] AI plan generation failed: claudeService not available
# [CRE-PLAN] Creating empty plan skeleton — user will need to request changes
# [CRE-AI] No claudeService available for analyze-ambiguities, returning empty result
# [CRE-PLAN] AI ambiguity analysis unavailable, proceeding without questions
# [CRE-AI] No claudeService available for generate-plan, returning empty result
# [CRE-PLAN] AI plan generation failed: claudeService not available
# [CRE-PLAN] Creating empty plan skeleton — user will need to request changes
# [CRE-AI] No claudeService available for refine-plan, returning empty result
# [CRE-PLAN] AI refinement unavailable, plan unchanged
# [CRE-AI] No claudeService available for analyze-ambiguities, returning empty result
# [CRE-PLAN] AI ambiguity analysis unavailable, proceeding without questions
# [CRE-AI] No claudeService available for generate-plan, returning empty result
# [CRE-PLAN] AI plan generation failed: claudeService not available
# [CRE-PLAN] Creating empty plan skeleton — user will need to request changes
# [CRE-AI] No claudeService available for refine-plan, returning empty result
# [CRE-PLAN] AI refinement unavailable, plan unchanged
# [CRE-AI] No claudeService available for refine-plan, returning empty result
# [CRE-PLAN] AI refinement unavailable, plan unchanged
# [CRE-AI] No claudeService available for analyze-ambiguities, returning empty result
# [CRE-PLAN] AI ambiguity analysis unavailable, proceeding without questions
# Subtest: Prompt templates — structure
    # Subtest: analyze-ambiguities exports buildPrompt function
    ok 1 - analyze-ambiguities exports buildPrompt function
      ---
      duration_ms: 2.9098
      ...
    # Subtest: analyze-ambiguities returns { system, task, constraints }
    ok 2 - analyze-ambiguities returns { system, task, constraints }
      ---
      duration_ms: 0.7715
      ...
    # Subtest: analyze-ambiguities constraints require raw JSON output
    ok 3 - analyze-ambiguities constraints require raw JSON output
      ---
      duration_ms: 0.3003
      ...
    # Subtest: generate-plan exports buildPrompt function
    ok 4 - generate-plan exports buildPrompt function
      ---
      duration_ms: 0.3298
      ...
    # Subtest: generate-plan returns { system, task, constraints }
    ok 5 - generate-plan returns { system, task, constraints }
      ---
      duration_ms: 0.5826
      ...
    # Subtest: generate-plan constraints require raw JSON output
    ok 6 - generate-plan constraints require raw JSON output
      ---
      duration_ms: 0.2771
      ...
    # Subtest: refine-plan exports buildPrompt function
    ok 7 - refine-plan exports buildPrompt function
      ---
      duration_ms: 0.184
      ...
    # Subtest: refine-plan returns { system, task, constraints }
    ok 8 - refine-plan returns { system, task, constraints }
      ---
      duration_ms: 0.7173
      ...
    # Subtest: refine-plan constraints require raw JSON output
    ok 9 - refine-plan constraints require raw JSON output
      ---
      duration_ms: 0.5729
      ...
    # Subtest: generate-assertions exports buildPrompt function
    ok 10 - generate-assertions exports buildPrompt function
      ---
      duration_ms: 0.5951
      ...
    # Subtest: generate-assertions returns { system, task, constraints }
    ok 11 - generate-assertions returns { system, task, constraints }
      ---
      duration_ms: 0.7481
      ...
    # Subtest: generate-assertions constraints require raw JSON output
    ok 12 - generate-assertions constraints require raw JSON output
      ---
      duration_ms: 0.3959
      ...
    # Subtest: generate-ris exports buildPrompt function
    ok 13 - generate-ris exports buildPrompt function
      ---
      duration_ms: 0.6833
      ...
    # Subtest: generate-ris returns { system, task, constraints }
    ok 14 - generate-ris returns { system, task, constraints }
      ---
      duration_ms: 0.9661
      ...
    # Subtest: generate-ris constraints require raw JSON output
    ok 15 - generate-ris constraints require raw JSON output
      ---
      duration_ms: 0.8799
      ...
    # Subtest: infer-intent exports buildPrompt function
    ok 16 - infer-intent exports buildPrompt function
      ---
      duration_ms: 0.4059
      ...
    # Subtest: infer-intent returns { system, task, constraints }
    ok 17 - infer-intent returns { system, task, constraints }
      ---
      duration_ms: 0.6328
      ...
    # Subtest: infer-intent constraints require raw JSON output
    ok 18 - infer-intent constraints require raw JSON output
      ---
      duration_ms: 0.9218
      ...
    # Subtest: assess-relevance exports buildPrompt function
    ok 19 - assess-relevance exports buildPrompt function
      ---
      duration_ms: 0.4924
      ...
    # Subtest: assess-relevance returns { system, task, constraints }
    ok 20 - assess-relevance returns { system, task, constraints }
      ---
      duration_ms: 0.6872
      ...
    # Subtest: assess-relevance constraints require raw JSON output
    ok 21 - assess-relevance constraints require raw JSON output
      ---
      duration_ms: 0.33
      ...
    # Subtest: identify-schema-gaps exports buildPrompt function
    ok 22 - identify-schema-gaps exports buildPrompt function
      ---
      duration_ms: 0.3073
      ...
    # Subtest: identify-schema-gaps returns { system, task, constraints }
    ok 23 - identify-schema-gaps returns { system, task, constraints }
      ---
      duration_ms: 0.6258
      ...
    # Subtest: identify-schema-gaps constraints require raw JSON output
    ok 24 - identify-schema-gaps constraints require raw JSON output
      ---
      duration_ms: 0.2691
      ...
    1..24
ok 42 - Prompt templates — structure
  ---
  duration_ms: 23.8058
  type: 'suite'
  ...
# Subtest: analyze-ambiguities (GROUND)
    # Subtest: includes GROUND principle in system
    ok 1 - includes GROUND principle in system
      ---
      duration_ms: 0.8753
      ...
    # Subtest: embeds story data in task
    ok 2 - embeds story data in task
      ---
      duration_ms: 0.4666
      ...
    # Subtest: includes optional codeModelSummary when provided
    ok 3 - includes optional codeModelSummary when provided
      ---
      duration_ms: 0.5588
      ...
    1..3
ok 43 - analyze-ambiguities (GROUND)
  ---
  duration_ms: 2.5079
  type: 'suite'
  ...
# Subtest: generate-plan (FOLLOW)
    # Subtest: includes FOLLOW principle in system
    ok 1 - includes FOLLOW principle in system
      ---
      duration_ms: 0.5912
      ...
    # Subtest: includes clarification answers when provided
    ok 2 - includes clarification answers when provided
      ---
      duration_ms: 0.7288
      ...
    # Subtest: output schema includes planItems, sharedComponents, risks
    ok 3 - output schema includes planItems, sharedComponents, risks
      ---
      duration_ms: 0.8566
      ...
    1..3
ok 44 - generate-plan (FOLLOW)
  ---
  duration_ms: 2.8275
  type: 'suite'
  ...
# Subtest: refine-plan (FOLLOW)
    # Subtest: includes iteration number in task
    ok 1 - includes iteration number in task
      ---
      duration_ms: 0.6502
      ...
    # Subtest: requires changelog in output
    ok 2 - requires changelog in output
      ---
      duration_ms: 2.7304
      ...
    1..2
ok 45 - refine-plan (FOLLOW)
  ---
  duration_ms: 4.2311
  type: 'suite'
  ...
# Subtest: generate-assertions (DERIVE)
    # Subtest: includes DERIVE principle in system
    ok 1 - includes DERIVE principle in system
      ---
      duration_ms: 0.788
      ...
    # Subtest: references acceptance criteria in task
    ok 2 - references acceptance criteria in task
      ---
      duration_ms: 0.433
      ...
    # Subtest: supports assertion types: file_exists, function_exists, export_exists, pattern_match
    ok 3 - supports assertion types: file_exists, function_exists, export_exists, pattern_match
      ---
      duration_ms: 0.5343
      ...
    1..3
ok 46 - generate-assertions (DERIVE)
  ---
  duration_ms: 2.2372
  type: 'suite'
  ...
# Subtest: generate-ris (FOLLOW)
    # Subtest: references RIS markdown sections
    ok 1 - references RIS markdown sections
      ---
      duration_ms: 0.6672
      ...
    # Subtest: respects maxLength parameter
    ok 2 - respects maxLength parameter
      ---
      duration_ms: 0.4671
      ...
    1..2
ok 47 - generate-ris (FOLLOW)
  ---
  duration_ms: 1.5199
  type: 'suite'
  ...
# Subtest: infer-intent (GROUND)
    # Subtest: includes GROUND principle in system
    ok 1 - includes GROUND principle in system
      ---
      duration_ms: 0.5064
      ...
    # Subtest: embeds source code in task
    ok 2 - embeds source code in task
      ---
      duration_ms: 0.3687
      ...
    # Subtest: output includes PROSE fields: summary, intent, behavior
    ok 3 - output includes PROSE fields: summary, intent, behavior
      ---
      duration_ms: 0.7298
      ...
    1..3
ok 48 - infer-intent (GROUND)
  ---
  duration_ms: 2.0384
  type: 'suite'
  ...
# Subtest: assess-relevance (JUDGE)
    # Subtest: includes JUDGE principle in system
    ok 1 - includes JUDGE principle in system
      ---
      duration_ms: 0.7705
      ...
    # Subtest: embeds artifact list in task
    ok 2 - embeds artifact list in task
      ---
      duration_ms: 0.8543
      ...
    # Subtest: output includes ranked array with score
    ok 3 - output includes ranked array with score
      ---
      duration_ms: 1.0301
      ...
    1..3
ok 49 - assess-relevance (JUDGE)
  ---
  duration_ms: 3.208
  type: 'suite'
  ...
# Subtest: identify-schema-gaps (DERIVE)
    # Subtest: includes DERIVE principle and h-M3 reference in system
    ok 1 - includes DERIVE principle and h-M3 reference in system
      ---
      duration_ms: 0.7015
      ...
    # Subtest: includes instance statistics in task
    ok 2 - includes instance statistics in task
      ---
      duration_ms: 0.5412
      ...
    # Subtest: includes recent changes when provided
    ok 3 - includes recent changes when provided
      ---
      duration_ms: 0.4695
      ...
    1..3
ok 50 - identify-schema-gaps (DERIVE)
  ---
  duration_ms: 2.6772
  type: 'suite'
  ...
# Subtest: CompletionSummaryRepository
    # Subtest: Row to Summary Transformation (_rowToSummary)
        # Subtest: should transform a full database row to a summary object
        ok 1 - should transform a full database row to a summary object
          ---
          duration_ms: 10.908
          ...
        # Subtest: should return null for null row
        ok 2 - should return null for null row
          ---
          duration_ms: 1.0715
          ...
        # Subtest: should default summary to empty string when missing
        ok 3 - should default summary to empty string when missing
          ---
          duration_ms: 0.8265
          ...
        # Subtest: should default testsStatus to unknown when missing
        ok 4 - should default testsStatus to unknown when missing
          ---
          duration_ms: 0.7364
          ...
        # Subtest: should default JSON columns to empty arrays on null
        ok 5 - should default JSON columns to empty arrays on null
          ---
          duration_ms: 0.718
          ...
        # Subtest: should default JSON columns to empty arrays on invalid JSON
        ok 6 - should default JSON columns to empty arrays on invalid JSON
          ---
          duration_ms: 0.7872
          ...
        # Subtest: should default numeric fields to 0 when missing
        ok 7 - should default numeric fields to 0 when missing
          ---
          duration_ms: 0.9394
          ...
        1..7
    ok 1 - Row to Summary Transformation (_rowToSummary)
      ---
      duration_ms: 20.6364
      type: 'suite'
      ...
    # Subtest: Summary to Row Transformation (_summaryToRow)
        # Subtest: should transform a full summary object to a database row
        ok 1 - should transform a full summary object to a database row
          ---
          duration_ms: 1.9669
          ...
        # Subtest: should generate an ID when not provided
        ok 2 - should generate an ID when not provided
          ---
          duration_ms: 3.9978
          ...
        # Subtest: should default sessionId to null when not provided
        ok 3 - should default sessionId to null when not provided
          ---
          duration_ms: 0.9695
          ...
        # Subtest: should default testsStatus to unknown when not provided
        ok 4 - should default testsStatus to unknown when not provided
          ---
          duration_ms: 0.9117
          ...
        # Subtest: should serialize empty arrays for missing JSON fields
        ok 5 - should serialize empty arrays for missing JSON fields
          ---
          duration_ms: 0.7104
          ...
        # Subtest: should default numeric fields to 0 when not provided
        ok 6 - should default numeric fields to 0 when not provided
          ---
          duration_ms: 1.1172
          ...
        1..6
    ok 2 - Summary to Row Transformation (_summaryToRow)
      ---
      duration_ms: 11.0588
      type: 'suite'
      ...
    # Subtest: Round-trip Transformation
        # Subtest: should preserve data through summary -> row -> summary cycle
        ok 1 - should preserve data through summary -> row -> summary cycle
          ---
          duration_ms: 1.3728
          ...
        # Subtest: should handle criteria with unknown met status through round-trip
        ok 2 - should handle criteria with unknown met status through round-trip
          ---
          duration_ms: 0.7633
          ...
        1..2
    ok 3 - Round-trip Transformation
      ---
      duration_ms: 2.6186
      type: 'suite'
      ...
    # Subtest: Edge Cases
        # Subtest: should handle zero-value cost and duration (falsy but valid)
        ok 1 - should handle zero-value cost and duration (falsy but valid)
          ---
          duration_ms: 0.8095
          ...
        # Subtest: should handle special characters in summary text
        ok 2 - should handle special characters in summary text
          ---
          duration_ms: 0.4935
          ...
        # Subtest: should handle file paths with special characters
        ok 3 - should handle file paths with special characters
          ---
          duration_ms: 1.0191
          ...
        # Subtest: should handle empty criteria array serialization
        ok 4 - should handle empty criteria array serialization
          ---
          duration_ms: 0.5216
          ...
        1..4
    ok 4 - Edge Cases
      ---
      duration_ms: 3.6145
      type: 'suite'
      ...
    # Subtest: SQL Query Structure
        # Subtest: should build correct INSERT query with all columns
        ok 1 - should build correct INSERT query with all columns
          ---
          duration_ms: 0.6042
          ...
        # Subtest: should build findByStoryId query with ORDER BY and LIMIT
        ok 2 - should build findByStoryId query with ORDER BY and LIMIT
          ---
          duration_ms: 0.3087
          ...
        # Subtest: should build findAllByStoryId query without LIMIT
        ok 3 - should build findAllByStoryId query without LIMIT
          ---
          duration_ms: 0.3074
          ...
        # Subtest: should build deleteByStoryId query
        ok 4 - should build deleteByStoryId query
          ---
          duration_ms: 0.3317
          ...
        1..4
    ok 5 - SQL Query Structure
      ---
      duration_ms: 1.9565
      type: 'suite'
      ...
    1..5
ok 51 - CompletionSummaryRepository
  ---
  duration_ms: 46.7078
  type: 'suite'
  ...
# Subtest: DatabaseConnection
    # Subtest: Connection Lifecycle
        # Subtest: should track connection state correctly
        ok 1 - should track connection state correctly
          ---
          duration_ms: 14.5088
          ...
        # Subtest: should generate correct database path
        ok 2 - should generate correct database path
          ---
          duration_ms: 6.9149
          ...
        1..2
    ok 1 - Connection Lifecycle
      ---
      duration_ms: 24.2431
      type: 'suite'
      ...
    # Subtest: Multi-Project Isolation
        # Subtest: should generate unique paths for different projects
        ok 1 - should generate unique paths for different projects
          ---
          duration_ms: 6.1361
          ...
        1..1
    ok 2 - Multi-Project Isolation
      ---
      duration_ms: 6.6359
      type: 'suite'
      ...
    # Subtest: Transaction Support
        # Subtest: should wrap functions in transactions
        ok 1 - should wrap functions in transactions
          ---
          duration_ms: 6.4341
          ...
        1..1
    ok 3 - Transaction Support
      ---
      duration_ms: 7.0322
      type: 'suite'
      ...
    1..3
ok 52 - DatabaseConnection
  ---
  duration_ms: 41.5541
  type: 'suite'
  ...
# Subtest: MigrationRunner
    # Subtest: Migration Discovery
        # Subtest: should parse migration filenames correctly
        ok 1 - should parse migration filenames correctly
          ---
          duration_ms: 1.38
          ...
        # Subtest: should reject invalid migration filenames
        ok 2 - should reject invalid migration filenames
          ---
          duration_ms: 0.9176
          ...
        # Subtest: should sort migrations by version
        ok 3 - should sort migrations by version
          ---
          duration_ms: 46.9472
          ...
        1..3
    ok 1 - Migration Discovery
      ---
      duration_ms: 50.5504
      type: 'suite'
      ...
    1..1
ok 53 - MigrationRunner
  ---
  duration_ms: 51.2182
  type: 'suite'
  ...
# Subtest: JsonMigrator
    # Subtest: JSON File Detection
        # Subtest: should detect existing JSON files
        ok 1 - should detect existing JSON files
          ---
          duration_ms: 13.6256
          ...
        # Subtest: should handle missing JSON files gracefully
        ok 2 - should handle missing JSON files gracefully
          ---
          duration_ms: 7.2786
          ...
        1..2
    ok 1 - JSON File Detection
      ---
      duration_ms: 21.4994
      type: 'suite'
      ...
    # Subtest: Data Transformation
        # Subtest: should transform camelCase to snake_case for database
        ok 1 - should transform camelCase to snake_case for database
          ---
          duration_ms: 7.9066
          ...
        # Subtest: should handle both camelCase and snake_case input
        ok 2 - should handle both camelCase and snake_case input
          ---
          duration_ms: 8.0213
          ...
        1..2
    ok 2 - Data Transformation
      ---
      duration_ms: 16.7057
      type: 'suite'
      ...
    1..2
ok 54 - JsonMigrator
  ---
  duration_ms: 39.6675
  type: 'suite'
  ...
# Subtest: MigrationRunner
    # Subtest: Migration Discovery
        # Subtest: should parse migration filenames correctly
        ok 1 - should parse migration filenames correctly
          ---
          duration_ms: 3.3979
          ...
        # Subtest: should reject invalid migration filenames
        ok 2 - should reject invalid migration filenames
          ---
          duration_ms: 1.0082
          ...
        # Subtest: should sort migrations by version
        ok 3 - should sort migrations by version
          ---
          duration_ms: 40.2827
          ...
        1..3
    ok 1 - Migration Discovery
      ---
      duration_ms: 47.7164
      type: 'suite'
      ...
    # Subtest: Version Tracking
        # Subtest: should determine current version from applied migrations
        ok 1 - should determine current version from applied migrations
          ---
          duration_ms: 2.3731
          ...
        # Subtest: should identify pending migrations
        ok 2 - should identify pending migrations
          ---
          duration_ms: 0.5843
          ...
        # Subtest: should detect when migrations are needed
        ok 3 - should detect when migrations are needed
          ---
          duration_ms: 0.7167
          ...
        1..3
    ok 2 - Version Tracking
      ---
      duration_ms: 4.5482
      type: 'suite'
      ...
    # Subtest: Transaction and Rollback
        # Subtest: should wrap migration in transaction simulation
        ok 1 - should wrap migration in transaction simulation
          ---
          duration_ms: 2.6533
          ...
        # Subtest: should rollback on error
        ok 2 - should rollback on error
          ---
          duration_ms: 3.0092
          ...
        # Subtest: should record rollback actions
        ok 3 - should record rollback actions
          ---
          duration_ms: 0.8138
          ...
        1..3
    ok 3 - Transaction and Rollback
      ---
      duration_ms: 7.1546
      type: 'suite'
      ...
    # Subtest: Migration History Logging
        # Subtest: should log migration actions
        ok 1 - should log migration actions
          ---
          duration_ms: 4.1171
          ...
        # Subtest: should log failed migrations with error details
        ok 2 - should log failed migrations with error details
          ---
          duration_ms: 1.1593
          ...
        # Subtest: should filter history by status
        ok 3 - should filter history by status
          ---
          duration_ms: 0.8829
          ...
        # Subtest: should filter history by version
        ok 4 - should filter history by version
          ---
          duration_ms: 0.5567
          ...
        1..4
    ok 4 - Migration History Logging
      ---
      duration_ms: 7.4623
      type: 'suite'
      ...
    # Subtest: Checksum Verification
        # Subtest: should calculate MD5 checksum
        ok 1 - should calculate MD5 checksum
          ---
          duration_ms: 2.4448
          ...
        # Subtest: should detect checksum mismatch
        ok 2 - should detect checksum mismatch
          ---
          duration_ms: 0.9092
          ...
        # Subtest: should verify migration integrity
        ok 3 - should verify migration integrity
          ---
          duration_ms: 0.8738
          ...
        # Subtest: should handle missing migration files
        ok 4 - should handle missing migration files
          ---
          duration_ms: 0.7136
          ...
        1..4
    ok 5 - Checksum Verification
      ---
      duration_ms: 5.7635
      type: 'suite'
      ...
    # Subtest: Execution Timing
        # Subtest: should track execution time
        ok 1 - should track execution time
          ---
          duration_ms: 65.9427
          ...
        # Subtest: should include timing in migration record
        ok 2 - should include timing in migration record
          ---
          duration_ms: 1.2312
          ...
        1..2
    ok 6 - Execution Timing
      ---
      duration_ms: 67.908
      type: 'suite'
      ...
    # Subtest: Status Summary
        # Subtest: should provide complete status summary
        ok 1 - should provide complete status summary
          ---
          duration_ms: 2.7244
          ...
        1..1
    ok 7 - Status Summary
      ---
      duration_ms: 3.7585
      type: 'suite'
      ...
    # Subtest: Error Handling
        # Subtest: should enhance error with migration context
        ok 1 - should enhance error with migration context
          ---
          duration_ms: 0.8757
          ...
        # Subtest: should stop on first error
        ok 2 - should stop on first error
          ---
          duration_ms: 1.3873
          ...
        1..2
    ok 8 - Error Handling
      ---
      duration_ms: 3.0469
      type: 'suite'
      ...
    # Subtest: History Cleanup
        # Subtest: should clear old history entries
        ok 1 - should clear old history entries
          ---
          duration_ms: 0.6561
          ...
        1..1
    ok 9 - History Cleanup
      ---
      duration_ms: 1.1221
      type: 'suite'
      ...
    1..9
ok 55 - MigrationRunner
  ---
  duration_ms: 153.9218
  type: 'suite'
  ...
# Subtest: SprintRepository
    # Subtest: Data Transformation
        # Subtest: should transform database row to sprint object
        ok 1 - should transform database row to sprint object
          ---
          duration_ms: 6.524
          ...
        # Subtest: should transform sprint object to database row
        ok 2 - should transform sprint object to database row
          ---
          duration_ms: 1.1997
          ...
        # Subtest: should transform sprint history row correctly
        ok 3 - should transform sprint history row correctly
          ---
          duration_ms: 1.198
          ...
        1..3
    ok 1 - Data Transformation
      ---
      duration_ms: 11.8587
      type: 'suite'
      ...
    # Subtest: Status Enum
        # Subtest: should define valid status values
        ok 1 - should define valid status values
          ---
          duration_ms: 0.6679
          ...
        1..1
    ok 2 - Status Enum
      ---
      duration_ms: 1.1494
      type: 'suite'
      ...
    # Subtest: Query Building
        # Subtest: should build findActive query
        ok 1 - should build findActive query
          ---
          duration_ms: 0.7823
          ...
        # Subtest: should build findByStatus query
        ok 2 - should build findByStatus query
          ---
          duration_ms: 0.5149
          ...
        # Subtest: should build sprint stories join query
        ok 3 - should build sprint stories join query
          ---
          duration_ms: 0.6722
          ...
        # Subtest: should build archived sprints query with limit
        ok 4 - should build archived sprints query with limit
          ---
          duration_ms: 0.8987
          ...
        # Subtest: should build findSprintContainingStory query
        ok 5 - should build findSprintContainingStory query
          ---
          duration_ms: 0.8225
          ...
        1..5
    ok 3 - Query Building
      ---
      duration_ms: 5.4633
      type: 'suite'
      ...
    # Subtest: Sprint-Story Relationships
        # Subtest: should build add story relationship query
        ok 1 - should build add story relationship query
          ---
          duration_ms: 4.7191
          ...
        # Subtest: should build remove story relationship query
        ok 2 - should build remove story relationship query
          ---
          duration_ms: 1.1938
          ...
        # Subtest: should extract story IDs from sprint
        ok 3 - should extract story IDs from sprint
          ---
          duration_ms: 1.1619
          ...
        1..3
    ok 4 - Sprint-Story Relationships
      ---
      duration_ms: 8.615
      type: 'suite'
      ...
    # Subtest: Progress Tracking
        # Subtest: should initialize story progress structure
        ok 1 - should initialize story progress structure
          ---
          duration_ms: 1.0447
          ...
        # Subtest: should update branch progress
        ok 2 - should update branch progress
          ---
          duration_ms: 1.0622
          ...
        # Subtest: should detect all branches completed
        ok 3 - should detect all branches completed
          ---
          duration_ms: 0.6276
          ...
        # Subtest: should detect not all branches completed
        ok 4 - should detect not all branches completed
          ---
          duration_ms: 1.093
          ...
        # Subtest: should calculate progress summary
        ok 5 - should calculate progress summary
          ---
          duration_ms: 0.9552
          ...
        1..5
    ok 5 - Progress Tracking
      ---
      duration_ms: 5.7399
      type: 'suite'
      ...
    # Subtest: Archive Operations
        # Subtest: should prepare sprint for archiving
        ok 1 - should prepare sprint for archiving
          ---
          duration_ms: 1.2722
          ...
        1..1
    ok 6 - Archive Operations
      ---
      duration_ms: 1.6049
      type: 'suite'
      ...
    # Subtest: Statistics
        # Subtest: should aggregate status counts
        ok 1 - should aggregate status counts
          ---
          duration_ms: 0.9116
          ...
        # Subtest: should calculate story percentage
        ok 2 - should calculate story percentage
          ---
          duration_ms: 0.5789
          ...
        # Subtest: should calculate branch percentage
        ok 3 - should calculate branch percentage
          ---
          duration_ms: 0.4525
          ...
        1..3
    ok 7 - Statistics
      ---
      duration_ms: 2.4599
      type: 'suite'
      ...
    # Subtest: Status Transitions
        # Subtest: should set planApprovedAt when status changes to in-progress
        ok 1 - should set planApprovedAt when status changes to in-progress
          ---
          duration_ms: 3.4765
          ...
        # Subtest: should set completedAt when status changes to completed
        ok 2 - should set completedAt when status changes to completed
          ---
          duration_ms: 0.5329
          ...
        # Subtest: should set closedAt when status changes to closed
        ok 3 - should set closedAt when status changes to closed
          ---
          duration_ms: 0.8093
          ...
        1..3
    ok 8 - Status Transitions
      ---
      duration_ms: 5.9075
      type: 'suite'
      ...
    # Subtest: Story Status Synchronization
        # Subtest: should have syncStoryStatus method
        ok 1 - should have syncStoryStatus method
          ---
          duration_ms: 11.0929
          ...
        # Subtest: should atomically update both sprint progress and user story status
        ok 2 - should atomically update both sprint progress and user story status
          ---
          duration_ms: 0.5578
          ...
        # Subtest: should map sprint status to backlog status correctly
        ok 3 - should map sprint status to backlog status correctly
          ---
          duration_ms: 0.4772
          ...
        # Subtest: should return updated sprint and story data
        ok 4 - should return updated sprint and story data
          ---
          duration_ms: 0.5845
          ...
        # Subtest: should update sprint status when all stories complete
        ok 5 - should update sprint status when all stories complete
          ---
          duration_ms: 0.5609
          ...
        # Subtest: should revert sprint status when story marked incomplete
        ok 6 - should revert sprint status when story marked incomplete
          ---
          duration_ms: 0.4006
          ...
        1..6
    ok 9 - Story Status Synchronization
      ---
      duration_ms: 14.3734
      type: 'suite'
      ...
    # Subtest: Transactional Operations
        # Subtest: should have immediateTransaction method in BaseRepository
        ok 1 - should have immediateTransaction method in BaseRepository
          ---
          duration_ms: 1.3409
          ...
        # Subtest: should use immediateTransaction for atomic create
        ok 2 - should use immediateTransaction for atomic create
          ---
          duration_ms: 0.5716
          ...
        # Subtest: should use immediateTransaction for atomic archive
        ok 3 - should use immediateTransaction for atomic archive
          ---
          duration_ms: 0.431
          ...
        # Subtest: should rollback on create failure
        ok 4 - should rollback on create failure
          ---
          duration_ms: 0.5551
          ...
        # Subtest: should rollback on archive failure
        ok 5 - should rollback on archive failure
          ---
          duration_ms: 0.5347
          ...
        # Subtest: should ensure cache updates happen after transaction commit
        ok 6 - should ensure cache updates happen after transaction commit
          ---
          duration_ms: 0.5082
          ...
        1..6
    ok 10 - Transactional Operations
      ---
      duration_ms: 4.5723
      type: 'suite'
      ...
    # Subtest: Sprint Title Persistence
        # Subtest: should include title in sprint row transformation
        ok 1 - should include title in sprint row transformation
          ---
          duration_ms: 0.6969
          ...
        # Subtest: should generate title for single story sprint
        ok 2 - should generate title for single story sprint
          ---
          duration_ms: 0.9361
          ...
        # Subtest: should generate title for multi-story sprint
        ok 3 - should generate title for multi-story sprint
          ---
          duration_ms: 1.7258
          ...
        # Subtest: should persist title with sprint creation atomically
        ok 4 - should persist title with sprint creation atomically
          ---
          duration_ms: 0.8634
          ...
        # Subtest: should retrieve title from database row correctly
        ok 5 - should retrieve title from database row correctly
          ---
          duration_ms: 0.8528
          ...
        # Subtest: should display title immediately after creation without reload
        ok 6 - should display title immediately after creation without reload
          ---
          duration_ms: 0.7818
          ...
        1..6
    ok 11 - Sprint Title Persistence
      ---
      duration_ms: 7.9382
      type: 'suite'
      ...
    # Subtest: Single Active Sprint Enforcement
        # Subtest: should have hasActiveSprint method
        ok 1 - should have hasActiveSprint method
          ---
          duration_ms: 1.0806
          ...
        # Subtest: should return false when no active sprint exists
        ok 2 - should return false when no active sprint exists
          ---
          duration_ms: 0.4382
          ...
        # Subtest: should return true when active sprint exists
        ok 3 - should return true when active sprint exists
          ---
          duration_ms: 0.6376
          ...
        # Subtest: should throw descriptive error when creating sprint with one active
        ok 4 - should throw descriptive error when creating sprint with one active
          ---
          duration_ms: 0.5057
          ...
        # Subtest: should use database trigger as final enforcement
        ok 5 - should use database trigger as final enforcement
          ---
          duration_ms: 0.4509
          ...
        # Subtest: should check for active sprint before creation in repository
        ok 6 - should check for active sprint before creation in repository
          ---
          duration_ms: 0.5806
          ...
        # Subtest: should define active sprint as one with closed_at IS NULL
        ok 7 - should define active sprint as one with closed_at IS NULL
          ---
          duration_ms: 0.6611
          ...
        # Subtest: should provide IPC handler for checking active sprint
        ok 8 - should provide IPC handler for checking active sprint
          ---
          duration_ms: 0.8073
          ...
        1..8
    ok 12 - Single Active Sprint Enforcement
      ---
      duration_ms: 6.299
      type: 'suite'
      ...
    # Subtest: User Story Status Synchronization
        # Subtest: should have _updateStoryStatuses private method
        ok 1 - should have _updateStoryStatuses private method
          ---
          duration_ms: 0.8988
          ...
        # Subtest: should update story status to in-progress when added to sprint
        ok 2 - should update story status to in-progress when added to sprint
          ---
          duration_ms: 1.5561
          ...
        # Subtest: should reset story status to pending when removed from sprint
        ok 3 - should reset story status to pending when removed from sprint
          ---
          duration_ms: 0.5494
          ...
        # Subtest: should keep completed status when archiving sprint
        ok 4 - should keep completed status when archiving sprint
          ---
          duration_ms: 1.7033
          ...
        # Subtest: should return incomplete stories to pending when archiving sprint
        ok 5 - should return incomplete stories to pending when archiving sprint
          ---
          duration_ms: 1.0057
          ...
        # Subtest: should synchronize story status atomically in create flow
        ok 6 - should synchronize story status atomically in create flow
          ---
          duration_ms: 0.8734
          ...
        # Subtest: should synchronize story status atomically in archive flow
        ok 7 - should synchronize story status atomically in archive flow
          ---
          duration_ms: 0.7856
          ...
        # Subtest: should preserve story existence across sprint lifecycle
        ok 8 - should preserve story existence across sprint lifecycle
          ---
          duration_ms: 0.4552
          ...
        # Subtest: should handle reload consistency with database as source of truth
        ok 9 - should handle reload consistency with database as source of truth
          ---
          duration_ms: 0.4151
          ...
        1..9
    ok 13 - User Story Status Synchronization
      ---
      duration_ms: 9.9199
      type: 'suite'
      ...
    # Subtest: Sprint Story Reference Validation
        # Subtest: should validate story IDs exist before sprint creation
        ok 1 - should validate story IDs exist before sprint creation
          ---
          duration_ms: 0.9327
          ...
        # Subtest: should throw InvalidStoryIdsError for non-existent stories
        ok 2 - should throw InvalidStoryIdsError for non-existent stories
          ---
          duration_ms: 34.3559
          ...
        # Subtest: should allow sprint creation with valid story IDs
        ok 3 - should allow sprint creation with valid story IDs
          ---
          duration_ms: 0.5782
          ...
        # Subtest: should allow sprint creation with empty story list
        ok 4 - should allow sprint creation with empty story list
          ---
          duration_ms: 0.4624
          ...
        # Subtest: should filter orphaned stories from sprint on load
        ok 5 - should filter orphaned stories from sprint on load
          ---
          duration_ms: 0.7414
          ...
        # Subtest: should use INNER JOIN to filter orphaned sprint_stories
        ok 6 - should use INNER JOIN to filter orphaned sprint_stories
          ---
          duration_ms: 0.3939
          ...
        # Subtest: should remove story from sprint when story is deleted
        ok 7 - should remove story from sprint when story is deleted
          ---
          duration_ms: 0.412
          ...
        # Subtest: should clean storyProgress JSON when story is deleted
        ok 8 - should clean storyProgress JSON when story is deleted
          ---
          duration_ms: 0.4986
          ...
        # Subtest: should handle delete when story is not in any sprint
        ok 9 - should handle delete when story is not in any sprint
          ---
          duration_ms: 0.3918
          ...
        # Subtest: should maintain referential integrity in transaction
        ok 10 - should maintain referential integrity in transaction
          ---
          duration_ms: 0.3614
          ...
        1..10
    ok 14 - Sprint Story Reference Validation
      ---
      duration_ms: 40.2123
      type: 'suite'
      ...
    # Subtest: Atomic Sprint Closure
        # Subtest: should use immediateTransaction for archive operation
        ok 1 - should use immediateTransaction for archive operation
          ---
          duration_ms: 5.3795
          ...
        # Subtest: should update completed stories to completed status
        ok 2 - should update completed stories to completed status
          ---
          duration_ms: 0.7574
          ...
        # Subtest: should update incomplete stories to pending status
        ok 3 - should update incomplete stories to pending status
          ---
          duration_ms: 0.5773
          ...
        # Subtest: should archive sprint only after story updates succeed
        ok 4 - should archive sprint only after story updates succeed
          ---
          duration_ms: 0.7167
          ...
        # Subtest: should rollback all changes if any operation fails
        ok 5 - should rollback all changes if any operation fails
          ---
          duration_ms: 0.6693
          ...
        # Subtest: should store inline story data in sprint_history
        ok 6 - should store inline story data in sprint_history
          ---
          duration_ms: 0.5447
          ...
        # Subtest: should have SprintService.closeAndArchive method
        ok 7 - should have SprintService.closeAndArchive method
          ---
          duration_ms: 0.4654
          ...
        # Subtest: should throw SprintNotFoundError for non-existent sprint
        ok 8 - should throw SprintNotFoundError for non-existent sprint
          ---
          duration_ms: 0.7233
          ...
        # Subtest: should trigger onSprintArchived callback after successful archive
        ok 9 - should trigger onSprintArchived callback after successful archive
          ---
          duration_ms: 0.488
          ...
        # Subtest: should include assertionResults in inline story data
        ok 10 - should include assertionResults in inline story data
          ---
          duration_ms: 0.509
          ...
        1..10
    ok 15 - Atomic Sprint Closure
      ---
      duration_ms: 12.2196
      type: 'suite'
      ...
    # Subtest: Inspection Assertions Integration
        # Subtest: should include inspectionAssertions in _getSprintStories output
        ok 1 - should include inspectionAssertions in _getSprintStories output
          ---
          duration_ms: 0.5965
          ...
        # Subtest: should preserve inspectionAssertions when story moves to sprint
        ok 2 - should preserve inspectionAssertions when story moves to sprint
          ---
          duration_ms: 0.6367
          ...
        # Subtest: should preserve assertionResults when story moves to sprint
        ok 3 - should preserve assertionResults when story moves to sprint
          ---
          duration_ms: 0.5766
          ...
        # Subtest: should include inspectionAssertions in archived sprint stories
        ok 4 - should include inspectionAssertions in archived sprint stories
          ---
          duration_ms: 0.5264
          ...
        # Subtest: should handle stories without assertions gracefully
        ok 5 - should handle stories without assertions gracefully
          ---
          duration_ms: 0.4516
          ...
        # Subtest: should preserve assertion data after application reload
        ok 6 - should preserve assertion data after application reload
          ---
          duration_ms: 0.8148
          ...
        # Subtest: should display assertion status correctly based on results
        ok 7 - should display assertion status correctly based on results
          ---
          duration_ms: 0.568
          ...
        1..7
    ok 16 - Inspection Assertions Integration
      ---
      duration_ms: 4.9122
      type: 'suite'
      ...
    1..16
ok 56 - SprintRepository
  ---
  duration_ms: 153.1681
  type: 'suite'
  ...
# Subtest: UserStoryRepository
    # Subtest: Data Transformation
        # Subtest: should convert camelCase to snake_case
        ok 1 - should convert camelCase to snake_case
          ---
          duration_ms: 4.5432
          ...
        # Subtest: should convert snake_case to camelCase
        ok 2 - should convert snake_case to camelCase
          ---
          duration_ms: 0.908
          ...
        # Subtest: should transform database row to story object
        ok 3 - should transform database row to story object
          ---
          duration_ms: 2.4945
          ...
        # Subtest: should transform story object to database row
        ok 4 - should transform story object to database row
          ---
          duration_ms: 0.832
          ...
        1..4
    ok 1 - Data Transformation
      ---
      duration_ms: 11.5384
      type: 'suite'
      ...
    # Subtest: Status Enum
        # Subtest: should define valid status values
        ok 1 - should define valid status values
          ---
          duration_ms: 0.6919
          ...
        1..1
    ok 2 - Status Enum
      ---
      duration_ms: 1.1708
      type: 'suite'
      ...
    # Subtest: Query Building
        # Subtest: should build findAll query with default options
        ok 1 - should build findAll query with default options
          ---
          duration_ms: 2.5994
          ...
        # Subtest: should build findAll query with limit and offset
        ok 2 - should build findAll query with limit and offset
          ---
          duration_ms: 0.5809
          ...
        # Subtest: should build findBySprintId query with join
        ok 3 - should build findBySprintId query with join
          ---
          duration_ms: 0.9857
          ...
        # Subtest: should build search query with LIKE pattern
        ok 4 - should build search query with LIKE pattern
          ---
          duration_ms: 3.9555
          ...
        # Subtest: should build findByDateRange query
        ok 5 - should build findByDateRange query
          ---
          duration_ms: 1.1552
          ...
        1..5
    ok 3 - Query Building
      ---
      duration_ms: 10.5646
      type: 'suite'
      ...
    # Subtest: JSON Parsing
        # Subtest: should parse JSON safely with default value
        ok 1 - should parse JSON safely with default value
          ---
          duration_ms: 1.4721
          ...
        # Subtest: should stringify values for JSON columns
        ok 2 - should stringify values for JSON columns
          ---
          duration_ms: 0.7705
          ...
        1..2
    ok 4 - JSON Parsing
      ---
      duration_ms: 2.8095
      type: 'suite'
      ...
    # Subtest: ID Generation
        # Subtest: should generate unique IDs
        ok 1 - should generate unique IDs
          ---
          duration_ms: 0.9106
          ...
        1..1
    ok 5 - ID Generation
      ---
      duration_ms: 1.3124
      type: 'suite'
      ...
    # Subtest: Bulk Operations
        # Subtest: should process bulk upsert correctly
        ok 1 - should process bulk upsert correctly
          ---
          duration_ms: 3.6607
          ...
        1..1
    ok 6 - Bulk Operations
      ---
      duration_ms: 5.2279
      type: 'suite'
      ...
    # Subtest: Archive Operations
        # Subtest: should prepare story for archiving
        ok 1 - should prepare story for archiving
          ---
          duration_ms: 0.9337
          ...
        # Subtest: should prepare story for restoration
        ok 2 - should prepare story for restoration
          ---
          duration_ms: 0.6206
          ...
        1..2
    ok 7 - Archive Operations
      ---
      duration_ms: 2.2521
      type: 'suite'
      ...
    # Subtest: Statistics
        # Subtest: should aggregate status counts correctly
        ok 1 - should aggregate status counts correctly
          ---
          duration_ms: 0.7927
          ...
        1..1
    ok 8 - Statistics
      ---
      duration_ms: 1.1241
      type: 'suite'
      ...
    1..8
ok 57 - UserStoryRepository
  ---
  duration_ms: 41.4276
  type: 'suite'
  ...
# Subtest: Inspection Assertions Integration
    # Subtest: Story Creation with Assertions
        # Subtest: should include inspectionAssertions in story object
        ok 1 - should include inspectionAssertions in story object
          ---
          duration_ms: 1.2843
          ...
        # Subtest: should transform inspectionAssertions to database row
        ok 2 - should transform inspectionAssertions to database row
          ---
          duration_ms: 0.8319
          ...
        # Subtest: should transform database row to story with inspectionAssertions
        ok 3 - should transform database row to story with inspectionAssertions
          ---
          duration_ms: 0.8826
          ...
        # Subtest: should default to empty array when inspectionAssertions is null
        ok 4 - should default to empty array when inspectionAssertions is null
          ---
          duration_ms: 1.0068
          ...
        1..4
    ok 1 - Story Creation with Assertions
      ---
      duration_ms: 4.7263
      type: 'suite'
      ...
    # Subtest: Assertion Action and Model Integration
        # Subtest: should include inspectionAssertions in ADD_USER_STORY payload
        ok 1 - should include inspectionAssertions in ADD_USER_STORY payload
          ---
          duration_ms: 1.6704
          ...
        # Subtest: should include inspectionAssertions in model after acceptor
        ok 2 - should include inspectionAssertions in model after acceptor
          ---
          duration_ms: 0.807
          ...
        1..2
    ok 2 - Assertion Action and Model Integration
      ---
      duration_ms: 2.9207
      type: 'suite'
      ...
    # Subtest: Assertion Persistence Flow
        # Subtest: should serialize assertions for database storage
        ok 1 - should serialize assertions for database storage
          ---
          duration_ms: 1.305
          ...
        # Subtest: should preserve assertion structure through save and load cycle
        ok 2 - should preserve assertion structure through save and load cycle
          ---
          duration_ms: 1.218
          ...
        1..2
    ok 3 - Assertion Persistence Flow
      ---
      duration_ms: 2.9722
      type: 'suite'
      ...
    1..3
ok 58 - Inspection Assertions Integration
  ---
  duration_ms: 11.5393
  type: 'suite'
  ...
# Subtest: BaseRepository
    # Subtest: Utility Methods
        # Subtest: should check record existence
        ok 1 - should check record existence
          ---
          duration_ms: 4.7008
          ...
        # Subtest: should count records with filter
        ok 2 - should count records with filter
          ---
          duration_ms: 0.8252
          ...
        # Subtest: should delete by ID
        ok 3 - should delete by ID
          ---
          duration_ms: 0.7156
          ...
        # Subtest: should delete multiple by IDs
        ok 4 - should delete multiple by IDs
          ---
          duration_ms: 0.9128
          ...
        # Subtest: should generate ISO timestamp
        ok 5 - should generate ISO timestamp
          ---
          duration_ms: 0.5326
          ...
        1..5
    ok 1 - Utility Methods
      ---
      duration_ms: 8.6357
      type: 'suite'
      ...
    # Subtest: Transaction Simulation
        # Subtest: should execute operations atomically
        ok 1 - should execute operations atomically
          ---
          duration_ms: 0.7383
          ...
        1..1
    ok 2 - Transaction Simulation
      ---
      duration_ms: 1.0161
      type: 'suite'
      ...
    1..2
ok 59 - BaseRepository
  ---
  duration_ms: 12.4583
  type: 'suite'
  ...
# Subtest: DeveloperProfileManager
    # Subtest: validate
        # Subtest: should accept valid profile data
        ok 1 - should accept valid profile data
          ---
          duration_ms: 44.725
          ...
        # Subtest: should require name
        ok 2 - should require name
          ---
          duration_ms: 9.3273
          ...
        # Subtest: should require preferredCodingStyle
        ok 3 - should require preferredCodingStyle
          ---
          duration_ms: 10.4781
          ...
        # Subtest: should reject invalid coding style
        ok 4 - should reject invalid coding style
          ---
          duration_ms: 5.93
          ...
        # Subtest: should validate email format
        ok 5 - should validate email format
          ---
          duration_ms: 10.1473
          ...
        # Subtest: should accept valid email
        ok 6 - should accept valid email
          ---
          duration_ms: 8.0461
          ...
        # Subtest: should limit bio length
        ok 7 - should limit bio length
          ---
          duration_ms: 6.7163
          ...
        # Subtest: should validate nested preferences
        ok 8 - should validate nested preferences
          ---
          duration_ms: 5.3396
          ...
        1..8
    ok 1 - validate
      ---
      duration_ms: 112.7578
      type: 'suite'
      ...
    # Subtest: create
        # Subtest: should create a valid profile
        ok 1 - should create a valid profile
          ---
          duration_ms: 26.8146
          ...
        # Subtest: should throw on missing name
        ok 2 - should throw on missing name
          ---
          duration_ms: 8.8319
          ...
        # Subtest: should throw on invalid coding style
        ok 3 - should throw on invalid coding style
          ---
          duration_ms: 8.3884
          ...
        # Subtest: should trim whitespace from name
        ok 4 - should trim whitespace from name
          ---
          duration_ms: 11.5959
          ...
        1..4
    ok 2 - create
      ---
      duration_ms: 57.2911
      type: 'suite'
      ...
    # Subtest: update
        # Subtest: should update existing profile
        ok 1 - should update existing profile
          ---
          duration_ms: 21.5156
          ...
        # Subtest: should preserve existing fields
        ok 2 - should preserve existing fields
          ---
          duration_ms: 17.0188
          ...
        # Subtest: should reject empty name
        ok 3 - should reject empty name
          ---
          duration_ms: 16.4253
          ...
        1..3
    ok 3 - update
      ---
      duration_ms: 55.9559
      type: 'suite'
      ...
    # Subtest: delete
        # Subtest: should delete existing profile
        ok 1 - should delete existing profile
          ---
          duration_ms: 11.7151
          ...
        # Subtest: should return false when no profile exists
        ok 2 - should return false when no profile exists
          ---
          duration_ms: 4.855
          ...
        1..2
    ok 4 - delete
      ---
      duration_ms: 17.3803
      type: 'suite'
      ...
    # Subtest: exists
        # Subtest: should return false when no profile
        ok 1 - should return false when no profile
          ---
          duration_ms: 4.7132
          ...
        # Subtest: should return true after creation
        ok 2 - should return true after creation
          ---
          duration_ms: 12.3499
          ...
        1..2
    ok 5 - exists
      ---
      duration_ms: 17.7
      type: 'suite'
      ...
    # Subtest: exportProfile / importProfile
        # Subtest: should export profile as JSON
        ok 1 - should export profile as JSON
          ---
          duration_ms: 16.2485
          ...
        # Subtest: should import valid profile JSON
        ok 2 - should import valid profile JSON
          ---
          duration_ms: 12.311
          ...
        # Subtest: should reject invalid JSON
        ok 3 - should reject invalid JSON
          ---
          duration_ms: 5.1906
          ...
        # Subtest: should reject import without overwrite when profile exists
        ok 4 - should reject import without overwrite when profile exists
          ---
          duration_ms: 11.7794
          ...
        1..4
    ok 6 - exportProfile / importProfile
      ---
      duration_ms: 47.1242
      type: 'suite'
      ...
    # Subtest: getOptions
        # Subtest: should return all coding style options
        ok 1 - should return all coding style options
          ---
          duration_ms: 5.1422
          ...
        # Subtest: should include expected programming styles
        ok 2 - should include expected programming styles
          ---
          duration_ms: 3.619
          ...
        1..2
    ok 7 - getOptions
      ---
      duration_ms: 9.4701
      type: 'suite'
      ...
    1..7
ok 60 - DeveloperProfileManager
  ---
  duration_ms: 325.7658
  type: 'suite'
  ...
# Subtest: CODING_STYLE_OPTIONS
    # Subtest: should have all expected categories
    ok 1 - should have all expected categories
      ---
      duration_ms: 0.3956
      ...
    1..1
ok 61 - CODING_STYLE_OPTIONS
  ---
  duration_ms: 0.6413
  type: 'suite'
  ...
# Subtest: DEFAULT_PROFILE
    # Subtest: should have required default fields
    ok 1 - should have required default fields
      ---
      duration_ms: 4.0081
      ...
    1..1
ok 62 - DEFAULT_PROFILE
  ---
  duration_ms: 4.2321
  type: 'suite'
  ...
# Subtest: AssertionEvaluator
    # Subtest: FILE_EXISTS
        # Subtest: should pass when file exists
        ok 1 - should pass when file exists
          ---
          duration_ms: 87.6204
          ...
        # Subtest: should fail when file does not exist
        ok 2 - should fail when file does not exist
          ---
          duration_ms: 9.4517
          ...
        # Subtest: should check for directory when type is directory
        ok 3 - should check for directory when type is directory
          ---
          duration_ms: 8.4572
          ...
        1..3
    ok 1 - FILE_EXISTS
      ---
      duration_ms: 109.021
      type: 'suite'
      ...
    # Subtest: FILE_CONTAINS
        # Subtest: should pass when file contains literal content
        ok 1 - should pass when file contains literal content
          ---
          duration_ms: 18.7361
          ...
        # Subtest: should fail when file does not contain literal content
        ok 2 - should fail when file does not contain literal content
          ---
          duration_ms: 14.0659
          ...
        # Subtest: should pass when file matches regex
        ok 3 - should pass when file matches regex
          ---
          duration_ms: 13.1985
          ...
        1..3
    ok 2 - FILE_CONTAINS
      ---
      duration_ms: 47.9004
      type: 'suite'
      ...
    # Subtest: JSON_PROPERTY
        # Subtest: should pass when JSON property exists
        ok 1 - should pass when JSON property exists
          ---
          duration_ms: 13.7298
          ...
        # Subtest: should pass when JSON property equals expected value
        ok 2 - should pass when JSON property equals expected value
          ---
          duration_ms: 8.9207
          ...
        # Subtest: should handle nested paths
        ok 3 - should handle nested paths
          ---
          duration_ms: 9.5151
          ...
        1..3
    ok 3 - JSON_PROPERTY
      ---
      duration_ms: 33.3751
      type: 'suite'
      ...
    # Subtest: EXPORT_EXISTS
        # Subtest: should find CommonJS exports
        ok 1 - should find CommonJS exports
          ---
          duration_ms: 16.6332
          ...
        # Subtest: should find ES module exports
        ok 2 - should find ES module exports
          ---
          duration_ms: 10.2992
          ...
        1..2
    ok 4 - EXPORT_EXISTS
      ---
      duration_ms: 27.7133
      type: 'suite'
      ...
    # Subtest: CLASS_STRUCTURE
        # Subtest: should verify class methods exist
        ok 1 - should verify class methods exist
          ---
          duration_ms: 15.3673
          ...
        # Subtest: should verify class extends
        ok 2 - should verify class extends
          ---
          duration_ms: 17.4791
          ...
        1..2
    ok 5 - CLASS_STRUCTURE
      ---
      duration_ms: 34.2407
      type: 'suite'
      ...
    # Subtest: FUNCTION_SIGNATURE
        # Subtest: should verify function parameters
        ok 1 - should verify function parameters
          ---
          duration_ms: 17.2897
          ...
        # Subtest: should verify async functions
        ok 2 - should verify async functions
          ---
          duration_ms: 9.4429
          ...
        1..2
    ok 6 - FUNCTION_SIGNATURE
      ---
      duration_ms: 28.0212
      type: 'suite'
      ...
    # Subtest: IMPORT_EXISTS
        # Subtest: should find CommonJS requires
        ok 1 - should find CommonJS requires
          ---
          duration_ms: 15.4232
          ...
        # Subtest: should find ES imports
        ok 2 - should find ES imports
          ---
          duration_ms: 12.0941
          ...
        1..2
    ok 7 - IMPORT_EXISTS
      ---
      duration_ms: 29.1572
      type: 'suite'
      ...
    # Subtest: IPC_HANDLER_REGISTERED
        # Subtest: should find ipcMain.handle registrations
        ok 1 - should find ipcMain.handle registrations
          ---
          duration_ms: 11.2007
          ...
        1..1
    ok 8 - IPC_HANDLER_REGISTERED
      ---
      duration_ms: 11.7601
      type: 'suite'
      ...
    # Subtest: CSS_SELECTOR_EXISTS
        # Subtest: should find CSS selectors
        ok 1 - should find CSS selectors
          ---
          duration_ms: 12.0098
          ...
        1..1
    ok 9 - CSS_SELECTOR_EXISTS
      ---
      duration_ms: 12.5846
      type: 'suite'
      ...
    # Subtest: PATTERN_MATCH
        # Subtest: should pass when pattern is present
        ok 1 - should pass when pattern is present
          ---
          duration_ms: 9.8386
          ...
        # Subtest: should pass when pattern is absent
        ok 2 - should pass when pattern is absent
          ---
          duration_ms: 7.6179
          ...
        1..2
    ok 10 - PATTERN_MATCH
      ---
      duration_ms: 18.3194
      type: 'suite'
      ...
    # Subtest: evaluateAll
        # Subtest: should evaluate multiple assertions with summary
        ok 1 - should evaluate multiple assertions with summary
          ---
          duration_ms: 14.3807
          ...
        # Subtest: should call progress callback
        ok 2 - should call progress callback
          ---
          duration_ms: 4.6219
          ...
        # Subtest: should return empty summary for no assertions
        ok 3 - should return empty summary for no assertions
          ---
          duration_ms: 2.3572
          ...
        1..3
    ok 11 - evaluateAll
      ---
      duration_ms: 22.0217
      type: 'suite'
      ...
    # Subtest: error handling
        # Subtest: should return error status for unknown assertion type
        ok 1 - should return error status for unknown assertion type
          ---
          duration_ms: 3.9858
          ...
        # Subtest: should handle file read errors gracefully
        ok 2 - should handle file read errors gracefully
          ---
          duration_ms: 7.5981
          ...
        1..2
    ok 12 - error handling
      ---
      duration_ms: 12.2015
      type: 'suite'
      ...
    1..12
ok 63 - AssertionEvaluator
  ---
  duration_ms: 392.8859
  type: 'suite'
  ...
# Subtest: C:\\Users\\jjdub\\code\\puffin\\tests\\evaluators\\fixtures\\test.js
ok 16 - C:\\Users\\jjdub\\code\\puffin\\tests\\evaluators\\fixtures\\test.js
  ---
  duration_ms: 470.9149
  ...
# Subtest: AssertionGenerator
    # Subtest: FILE_EXISTS patterns
        # Subtest: should detect file creation from criterion
        ok 1 - should detect file creation from criterion
          ---
          duration_ms: 18.4466
          ...
        # Subtest: should detect directory creation
        ok 2 - should detect directory creation
          ---
          duration_ms: 8.8265
          ...
        # Subtest: should detect file should exist
        ok 3 - should detect file should exist
          ---
          duration_ms: 2.1237
          ...
        1..3
    ok 1 - FILE_EXISTS patterns
      ---
      duration_ms: 33.1806
      type: 'suite'
      ...
    # Subtest: CLASS_STRUCTURE patterns
        # Subtest: should detect class creation
        ok 1 - should detect class creation
          ---
          duration_ms: 1.7895
          ...
        # Subtest: should detect class with methods
        ok 2 - should detect class with methods
          ---
          duration_ms: 1.8827
          ...
        # Subtest: should detect class inheritance
        ok 3 - should detect class inheritance
          ---
          duration_ms: 1.1048
          ...
        1..3
    ok 2 - CLASS_STRUCTURE patterns
      ---
      duration_ms: 5.8632
      type: 'suite'
      ...
    # Subtest: FUNCTION_SIGNATURE patterns
        # Subtest: should detect function creation
        ok 1 - should detect function creation
          ---
          duration_ms: 2.0879
          ...
        # Subtest: should detect async function
        ok 2 - should detect async function
          ---
          duration_ms: 0.9829
          ...
        # Subtest: should detect function parameters
        ok 3 - should detect function parameters
          ---
          duration_ms: 0.9337
          ...
        1..3
    ok 3 - FUNCTION_SIGNATURE patterns
      ---
      duration_ms: 5.5712
      type: 'suite'
      ...
    # Subtest: EXPORT_EXISTS patterns
        # Subtest: should detect module exports
        ok 1 - should detect module exports
          ---
          duration_ms: 1.5539
          ...
        # Subtest: should detect class export
        ok 2 - should detect class export
          ---
          duration_ms: 1.4024
          ...
        1..2
    ok 4 - EXPORT_EXISTS patterns
      ---
      duration_ms: 3.7599
      type: 'suite'
      ...
    # Subtest: IPC_HANDLER_REGISTERED patterns
        # Subtest: should detect IPC handler registration
        ok 1 - should detect IPC handler registration
          ---
          duration_ms: 1.3519
          ...
        # Subtest: should detect IPC channel should be available
        ok 2 - should detect IPC channel should be available
          ---
          duration_ms: 1.1306
          ...
        1..2
    ok 5 - IPC_HANDLER_REGISTERED patterns
      ---
      duration_ms: 3.3517
      type: 'suite'
      ...
    # Subtest: CSS_SELECTOR_EXISTS patterns
        # Subtest: should detect CSS class creation
        ok 1 - should detect CSS class creation
          ---
          duration_ms: 1.1708
          ...
        # Subtest: should detect button style
        ok 2 - should detect button style
          ---
          duration_ms: 2.1851
          ...
        1..2
    ok 6 - CSS_SELECTOR_EXISTS patterns
      ---
      duration_ms: 3.9299
      type: 'suite'
      ...
    # Subtest: JSON_PROPERTY patterns
        # Subtest: should detect package.json property
        ok 1 - should detect package.json property
          ---
          duration_ms: 1.2451
          ...
        # Subtest: should detect config property
        ok 2 - should detect config property
          ---
          duration_ms: 0.7332
          ...
        1..2
    ok 7 - JSON_PROPERTY patterns
      ---
      duration_ms: 2.3451
      type: 'suite'
      ...
    # Subtest: FILE_CONTAINS patterns
        # Subtest: should detect file contains content
        ok 1 - should detect file contains content
          ---
          duration_ms: 1.37
          ...
        1..1
    ok 8 - FILE_CONTAINS patterns
      ---
      duration_ms: 1.6189
      type: 'suite'
      ...
    # Subtest: PATTERN_MATCH patterns
        # Subtest: should detect no console.log
        ok 1 - should detect no console.log
          ---
          duration_ms: 1.4711
          ...
        1..1
    ok 9 - PATTERN_MATCH patterns
      ---
      duration_ms: 1.7634
      type: 'suite'
      ...
    # Subtest: generateAssertions
        # Subtest: should generate from story with title and description
        ok 1 - should generate from story with title and description
          ---
          duration_ms: 1.6118
          ...
        # Subtest: should generate from acceptance criteria
        ok 2 - should generate from acceptance criteria
          ---
          duration_ms: 1.3106
          ...
        # Subtest: should deduplicate assertions
        ok 3 - should deduplicate assertions
          ---
          duration_ms: 0.9322
          ...
        # Subtest: should handle empty story
        ok 4 - should handle empty story
          ---
          duration_ms: 0.4434
          ...
        # Subtest: should set criterion reference
        ok 5 - should set criterion reference
          ---
          duration_ms: 1.5809
          ...
        1..5
    ok 10 - generateAssertions
      ---
      duration_ms: 6.888
      type: 'suite'
      ...
    # Subtest: suggestAssertions
        # Subtest: should suggest tests for new features
        ok 1 - should suggest tests for new features
          ---
          duration_ms: 1.9302
          ...
        # Subtest: should suggest documentation for APIs
        ok 2 - should suggest documentation for APIs
          ---
          duration_ms: 1.3788
          ...
        # Subtest: should suggest IPC bridge for Electron
        ok 3 - should suggest IPC bridge for Electron
          ---
          duration_ms: 0.5949
          ...
        1..3
    ok 11 - suggestAssertions
      ---
      duration_ms: 4.4364
      type: 'suite'
      ...
    # Subtest: AssertionGenerator class
        # Subtest: should generate with options
        ok 1 - should generate with options
          ---
          duration_ms: 3.4904
          ...
        # Subtest: should return assertion types
        ok 2 - should return assertion types
          ---
          duration_ms: 1.1412
          ...
        # Subtest: should return pattern descriptions
        ok 3 - should return pattern descriptions
          ---
          duration_ms: 1.4842
          ...
        1..3
    ok 12 - AssertionGenerator class
      ---
      duration_ms: 6.6123
      type: 'suite'
      ...
    1..12
ok 65 - AssertionGenerator
  ---
  duration_ms: 91.0497
  type: 'suite'
  ...
# Subtest: ClaudeMdGenerator — getBranchMemoryContent
    # Subtest: returns empty string when no memory file exists
    ok 1 - returns empty string when no memory file exists
      ---
      duration_ms: 47.6015
      ...
    # Subtest: returns empty string when all included sections are empty
    ok 2 - returns empty string when all included sections are empty
      ---
      duration_ms: 30.9704
      ...
    # Subtest: extracts Conventions section
    ok 3 - extracts Conventions section
      ---
      duration_ms: 29.9958
      ...
    # Subtest: extracts Architectural Decisions section
    ok 4 - extracts Architectural Decisions section
      ---
      duration_ms: 26.9325
      ...
    # Subtest: extracts Bug Patterns section when non-empty
    ok 5 - extracts Bug Patterns section when non-empty
      ---
      duration_ms: 23.4035
      ...
    # Subtest: excludes Facts section (not actionable for implementation)
    ok 6 - excludes Facts section (not actionable for implementation)
      ---
      duration_ms: 21.9645
      ...
    # Subtest: includes header "Branch Memory (auto-extracted)"
    ok 7 - includes header "Branch Memory (auto-extracted)"
      ---
      duration_ms: 19.5109
      ...
    # Subtest: respects size limit by truncating lower-priority sections
    ok 8 - respects size limit by truncating lower-priority sections
      ---
      duration_ms: 21.5411
      ...
    # Subtest: truncates items within a section when hitting limit
    ok 9 - truncates items within a section when hitting limit
      ---
      duration_ms: 20.3889
      ...
    1..9
ok 66 - ClaudeMdGenerator — getBranchMemoryContent
  ---
  duration_ms: 249.9315
  type: 'suite'
  ...
# Subtest: ClaudeMdGenerator — malformed memory files
    # Subtest: handles empty file gracefully
    ok 1 - handles empty file gracefully
      ---
      duration_ms: 23.7726
      ...
    # Subtest: handles file with only whitespace
    ok 2 - handles file with only whitespace
      ---
      duration_ms: 22.9863
      ...
    # Subtest: handles file with no recognized sections
    ok 3 - handles file with no recognized sections
      ---
      duration_ms: 17.456
      ...
    # Subtest: handles file with malformed markdown (no list items)
    ok 4 - handles file with malformed markdown (no list items)
      ---
      duration_ms: 18.1794
      ...
    # Subtest: handles binary-like content without crashing
    ok 5 - handles binary-like content without crashing
      ---
      duration_ms: 23.3036
      ...
    # Subtest: handles file with only boilerplate entries
    ok 6 - handles file with only boilerplate entries
      ---
      duration_ms: 19.6186
      ...
    # Subtest: handles very large memory file within size limit
    ok 7 - handles very large memory file within size limit
      ---
      duration_ms: 22.5812
      ...
    1..7
ok 67 - ClaudeMdGenerator — malformed memory files
  ---
  duration_ms: 149.8199
  type: 'suite'
  ...
# Subtest: ClaudeMdGenerator — generateBranch with memory
    # Subtest: includes branch memory in generated CLAUDE_{branch}.md
    ok 1 - includes branch memory in generated CLAUDE_{branch}.md
      ---
      duration_ms: 27.9037
      ...
    # Subtest: generates branch file normally when no memory exists
    ok 2 - generates branch file normally when no memory exists
      ---
      duration_ms: 19.5314
      ...
    1..2
ok 68 - ClaudeMdGenerator — generateBranch with memory
  ---
  duration_ms: 48.0326
  type: 'suite'
  ...
# Subtest: patternToRegex
    # Subtest: converts wildcard to regex
    ok 1 - converts wildcard to regex
      ---
      duration_ms: 4.6265
      ...
    # Subtest: is case-insensitive
    ok 2 - is case-insensitive
      ---
      duration_ms: 0.7492
      ...
    # Subtest: escapes special regex characters
    ok 3 - escapes special regex characters
      ---
      duration_ms: 0.7237
      ...
    1..3
ok 69 - patternToRegex
  ---
  duration_ms: 11.0479
  type: 'suite'
  ...
# Subtest: executeQuery — artifact
    # Subtest: returns all artifacts without filters
    ok 1 - returns all artifacts without filters
      ---
      duration_ms: 1.579
      ...
    # Subtest: filters by pattern
    ok 2 - filters by pattern
      ---
      duration_ms: 1.0704
      ...
    # Subtest: filters by elementType
    ok 3 - filters by elementType
      ---
      duration_ms: 0.5737
      ...
    # Subtest: filters by kind
    ok 4 - filters by kind
      ---
      duration_ms: 0.6366
      ...
    # Subtest: respects limit
    ok 5 - respects limit
      ---
      duration_ms: 0.5466
      ...
    1..5
ok 70 - executeQuery — artifact
  ---
  duration_ms: 6.2339
  type: 'suite'
  ...
# Subtest: executeQuery — deps
    # Subtest: returns outbound deps
    ok 1 - returns outbound deps
      ---
      duration_ms: 1.0997
      ...
    # Subtest: returns inbound deps
    ok 2 - returns inbound deps
      ---
      duration_ms: 0.5849
      ...
    # Subtest: returns both directions
    ok 3 - returns both directions
      ---
      duration_ms: 0.7521
      ...
    # Subtest: filters by dep kind
    ok 4 - filters by dep kind
      ---
      duration_ms: 2.6966
      ...
    # Subtest: throws without artifact field
    ok 5 - throws without artifact field
      ---
      duration_ms: 1.5392
      ...
    1..5
ok 71 - executeQuery — deps
  ---
  duration_ms: 7.5144
  type: 'suite'
  ...
# Subtest: executeQuery — flow
    # Subtest: returns all flows
    ok 1 - returns all flows
      ---
      duration_ms: 0.8619
      ...
    # Subtest: filters by pattern
    ok 2 - filters by pattern
      ---
      duration_ms: 0.9401
      ...
    1..2
ok 72 - executeQuery — flow
  ---
  duration_ms: 2.3052
  type: 'suite'
  ...
# Subtest: executeQuery — type
    # Subtest: lists element types
    ok 1 - lists element types
      ---
      duration_ms: 0.9945
      ...
    1..1
ok 73 - executeQuery — type
  ---
  duration_ms: 1.5252
  type: 'suite'
  ...
# Subtest: executeQuery — stats
    # Subtest: returns aggregate statistics
    ok 1 - returns aggregate statistics
      ---
      duration_ms: 1.0611
      ...
    1..1
ok 74 - executeQuery — stats
  ---
  duration_ms: 1.3202
  type: 'suite'
  ...
# Subtest: executeQuery — search
    # Subtest: finds artifacts by text match
    ok 1 - finds artifacts by text match
      ---
      duration_ms: 2.431
      ...
    # Subtest: ranks by relevance
    ok 2 - ranks by relevance
      ---
      duration_ms: 1.1522
      ...
    # Subtest: throws without pattern
    ok 3 - throws without pattern
      ---
      duration_ms: 0.4708
      ...
    1..3
ok 75 - executeQuery — search
  ---
  duration_ms: 4.5185
  type: 'suite'
  ...
# Subtest: executeQuery — unknown type
    # Subtest: throws for unknown query type
    ok 1 - throws for unknown query type
      ---
      duration_ms: 0.6143
      ...
    1..1
ok 76 - executeQuery — unknown type
  ---
  duration_ms: 0.8596
  type: 'suite'
  ...
# Subtest: classifyNewFile
    # Subtest: classifies test files
    ok 1 - classifies test files
      ---
      duration_ms: 4.0626
      ...
    # Subtest: classifies config files
    ok 2 - classifies config files
      ---
      duration_ms: 0.9626
      ...
    # Subtest: classifies jsx as view
    ok 3 - classifies jsx as view
      ---
      duration_ms: 0.6648
      ...
    # Subtest: classifies service files
    ok 4 - classifies service files
      ---
      duration_ms: 0.8093
      ...
    # Subtest: classifies utility files
    ok 5 - classifies utility files
      ---
      duration_ms: 1.2206
      ...
    # Subtest: classifies barrel files
    ok 6 - classifies barrel files
      ---
      duration_ms: 1.1559
      ...
    # Subtest: defaults to module
    ok 7 - defaults to module
      ---
      duration_ms: 1.425
      ...
    1..7
ok 77 - classifyNewFile
  ---
  duration_ms: 15.8264
  type: 'suite'
  ...
# Subtest: SOURCE_EXTENSIONS
    # Subtest: includes JS/TS extensions
    ok 1 - includes JS/TS extensions
      ---
      duration_ms: 2.3072
      ...
    # Subtest: excludes non-source extensions
    ok 2 - excludes non-source extensions
      ---
      duration_ms: 0.935
      ...
    1..2
ok 78 - SOURCE_EXTENSIONS
  ---
  duration_ms: 4.5348
  type: 'suite'
  ...
# Subtest: checkFreshness — missing model
    # Subtest: returns missing status when instance.json does not exist
    ok 1 - returns missing status when instance.json does not exist
      ---
      duration_ms: 60.1057
      ...
    1..1
ok 79 - checkFreshness — missing model
  ---
  duration_ms: 61.058
  type: 'suite'
  ...
# Subtest: checkFreshness — non-git project
    # Subtest: returns unknown status for non-git directory
    ok 1 - returns unknown status for non-git directory
      ---
      duration_ms: 259.1438
      ...
    1..1
ok 80 - checkFreshness — non-git project
  ---
  duration_ms: 260.4961
  type: 'suite'
  ...
# Subtest: incrementalUpdate
    # Subtest: removes deleted artifacts
    ok 1 - removes deleted artifacts
      ---
      duration_ms: 36.0852
      ...
    # Subtest: adds new artifacts
    ok 2 - adds new artifacts
      ---
      duration_ms: 33.0202
      ...
    # Subtest: updates modified artifacts
    ok 3 - updates modified artifacts
      ---
      duration_ms: 33.9146
      ...
    # Subtest: handles mixed adds, modifications, and removals
    ok 4 - handles mixed adds, modifications, and removals
      ---
      duration_ms: 33.9093
      ...
    1..4
ok 81 - incrementalUpdate
  ---
  duration_ms: 139.4992
  type: 'suite'
  ...
# Subtest: ensureFresh
    # Subtest: returns bootstrap-required when model is missing
    ok 1 - returns bootstrap-required when model is missing
      ---
      duration_ms: 15.1967
      ...
    # Subtest: returns force-refresh action when flag is set
    ok 2 - returns force-refresh action when flag is set
      ---
      duration_ms: 19.2304
      ...
    # Subtest: returns none action when model exists in non-git project
    ok 3 - returns none action when model exists in non-git project
      ---
      duration_ms: 282.5827
      ...
    1..3
ok 82 - ensureFresh
  ---
  duration_ms: 318.3187
  type: 'suite'
  ...
# Subtest: classifyNewFile — edge cases
    # Subtest: classifies model files
    ok 1 - classifies model files
      ---
      duration_ms: 0.8686
      ...
    # Subtest: classifies tsx as view
    ok 2 - classifies tsx as view
      ---
      duration_ms: 0.5025
      ...
    # Subtest: classifies api files as service
    ok 3 - classifies api files as service
      ---
      duration_ms: 0.3909
      ...
    1..3
ok 83 - classifyNewFile — edge cases
  ---
  duration_ms: 2.3151
  type: 'suite'
  ...
# Subtest: buildAdjacency
    # Subtest: builds full adjacency when no type filter
    ok 1 - builds full adjacency when no type filter
      ---
      duration_ms: 4.3412
      ...
    # Subtest: filters by relationship type
    ok 2 - filters by relationship type
      ---
      duration_ms: 0.909
      ...
    # Subtest: excludes non-matching types
    ok 3 - excludes non-matching types
      ---
      duration_ms: 0.8554
      ...
    1..3
ok 84 - buildAdjacency
  ---
  duration_ms: 12.3197
  type: 'suite'
  ...
# Subtest: walk
    # Subtest: walks outgoing from a starting entity
    ok 1 - walks outgoing from a starting entity
      ---
      duration_ms: 6.2364
      ...
    # Subtest: walks incoming to a target entity
    ok 2 - walks incoming to a target entity
      ---
      duration_ms: 1.5262
      ...
    # Subtest: filters by relationship type
    ok 3 - filters by relationship type
      ---
      duration_ms: 1.3594
      ...
    # Subtest: respects maxDepth
    ok 4 - respects maxDepth
      ---
      duration_ms: 1.2372
      ...
    # Subtest: returns layers showing BFS depth
    ok 5 - returns layers showing BFS depth
      ---
      duration_ms: 3.1012
      ...
    # Subtest: respects limit
    ok 6 - respects limit
      ---
      duration_ms: 5.0736
      ...
    # Subtest: returns empty for non-matching start
    ok 7 - returns empty for non-matching start
      ---
      duration_ms: 1.0349
      ...
    # Subtest: throws without start
    ok 8 - throws without start
      ---
      duration_ms: 1.6102
      ...
    1..8
ok 85 - walk
  ---
  duration_ms: 23.8157
  type: 'suite'
  ...
# Subtest: findPath
    # Subtest: finds path between connected entities
    ok 1 - finds path between connected entities
      ---
      duration_ms: 3.2369
      ...
    # Subtest: returns path edges
    ok 2 - returns path edges
      ---
      duration_ms: 1.0986
      ...
    # Subtest: includes pathNodes with details
    ok 3 - includes pathNodes with details
      ---
      duration_ms: 0.7711
      ...
    # Subtest: returns not-found for disconnected entities
    ok 4 - returns not-found for disconnected entities
      ---
      duration_ms: 1.7608
      ...
    # Subtest: returns not-found for nonexistent entity
    ok 5 - returns not-found for nonexistent entity
      ---
      duration_ms: 1.249
      ...
    # Subtest: respects relationship type filter
    ok 6 - respects relationship type filter
      ---
      duration_ms: 0.7605
      ...
    # Subtest: throws without from/to
    ok 7 - throws without from/to
      ---
      duration_ms: 1.3963
      ...
    1..7
ok 86 - findPath
  ---
  duration_ms: 12.1928
  type: 'suite'
  ...
# Subtest: getEntityNeighbors
    # Subtest: returns neighbors grouped by relationship kind
    ok 1 - returns neighbors grouped by relationship kind
      ---
      duration_ms: 1.7926
      ...
    # Subtest: only outgoing when direction is outgoing
    ok 2 - only outgoing when direction is outgoing
      ---
      duration_ms: 0.9044
      ...
    # Subtest: only incoming when direction is incoming
    ok 3 - only incoming when direction is incoming
      ---
      duration_ms: 1.0454
      ...
    # Subtest: includes neighbor metadata
    ok 4 - includes neighbor metadata
      ---
      duration_ms: 0.7464
      ...
    # Subtest: returns empty for non-matching entity
    ok 5 - returns empty for non-matching entity
      ---
      duration_ms: 0.5955
      ...
    # Subtest: throws without entity
    ok 6 - throws without entity
      ---
      duration_ms: 0.3986
      ...
    1..6
ok 87 - getEntityNeighbors
  ---
  duration_ms: 6.6511
  type: 'suite'
  ...
# Subtest: navigate
    # Subtest: dispatches walk operation
    ok 1 - dispatches walk operation
      ---
      duration_ms: 1.1706
      ...
    # Subtest: dispatches path operation
    ok 2 - dispatches path operation
      ---
      duration_ms: 0.6028
      ...
    # Subtest: dispatches neighbors operation
    ok 3 - dispatches neighbors operation
      ---
      duration_ms: 0.4136
      ...
    # Subtest: throws for unknown operation
    ok 4 - throws for unknown operation
      ---
      duration_ms: 0.8524
      ...
    1..4
ok 88 - navigate
  ---
  duration_ms: 3.652
  type: 'suite'
  ...
# Subtest: TOOLS definition
    # Subtest: defines 9 tools
    ok 1 - defines 9 tools
      ---
      duration_ms: 5.3431
      ...
    # Subtest: each tool has name, description, and inputSchema
    ok 2 - each tool has name, description, and inputSchema
      ---
      duration_ms: 1.0401
      ...
    # Subtest: tool names follow hdsl_ prefix convention
    ok 3 - tool names follow hdsl_ prefix convention
      ---
      duration_ms: 0.6358
      ...
    # Subtest: includes all expected tools
    ok 4 - includes all expected tools
      ---
      duration_ms: 0.5994
      ...
    # Subtest: required fields are declared in inputSchema
    ok 5 - required fields are declared in inputSchema
      ---
      duration_ms: 3.568
      ...
    1..5
ok 89 - TOOLS definition
  ---
  duration_ms: 16.1063
  type: 'suite'
  ...
# Subtest: handleMessage — protocol
    # Subtest: returns parse error for invalid JSON
    not ok 1 - returns parse error for invalid JSON
      ---
      duration_ms: 2.4161
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\h-dsl-engine\\hdsl-tool-server.test.js:102:3'
      failureType: 'testCodeFailure'
      error: "Cannot read properties of null (reading 'error')"
      code: 'ERR_TEST_FAILURE'
      name: 'TypeError'
      stack: |-
        TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\h-dsl-engine\hdsl-tool-server.test.js:105:25)
        async Test.run (node:internal/test_runner/test:797:9)
        async Promise.all (index 0)
        async Suite.run (node:internal/test_runner/test:1135:7)
        async Test.processPendingSubtests (node:internal/test_runner/test:526:7)
      ...
    # Subtest: handles initialize
    ok 2 - handles initialize
      ---
      duration_ms: 1.2036
      ...
    # Subtest: handles initialized notification (returns null)
    ok 3 - handles initialized notification (returns null)
      ---
      duration_ms: 0.8296
      ...
    # Subtest: handles tools/list
    ok 4 - handles tools/list
      ---
      duration_ms: 3.8441
      ...
    # Subtest: returns method-not-found for unknown method
    ok 5 - returns method-not-found for unknown method
      ---
      duration_ms: 1.5675
      ...
    # Subtest: returns error for tools/call with missing tool name
    ok 6 - returns error for tools/call with missing tool name
      ---
      duration_ms: 1.4642
      ...
    # Subtest: returns error for tools/call with unknown tool
    ok 7 - returns error for tools/call with unknown tool
      ---
      duration_ms: 1.5066
      ...
    1..7
not ok 90 - handleMessage — protocol
  ---
  duration_ms: 14.7043
  type: 'suite'
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\h-dsl-engine\\hdsl-tool-server.test.js:101:1'
  failureType: 'subtestsFailed'
  error: '1 subtest failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: Tool descriptions — LLM-friendly
    # Subtest: descriptions are concise (under 200 chars)
    ok 1 - descriptions are concise (under 200 chars)
      ---
      duration_ms: 0.9822
      ...
    # Subtest: descriptions explain when to use the tool
    ok 2 - descriptions explain when to use the tool
      ---
      duration_ms: 0.8391
      ...
    # Subtest: input schemas have property descriptions
    ok 3 - input schemas have property descriptions
      ---
      duration_ms: 0.7064
      ...
    1..3
ok 91 - Tool descriptions — LLM-friendly
  ---
  duration_ms: 3.4908
  type: 'suite'
  ...
# Subtest: handleToolCall — integration
    # Subtest: hdsl_stats returns artifact and dependency counts
    ok 1 - hdsl_stats returns artifact and dependency counts
      ---
      duration_ms: 8.918
      ...
    # Subtest: hdsl_peek returns artifact details
    ok 2 - hdsl_peek returns artifact details
      ---
      duration_ms: 1.6375
      ...
    # Subtest: hdsl_peek returns error for unknown artifact
    ok 3 - hdsl_peek returns error for unknown artifact
      ---
      duration_ms: 1.6769
      ...
    # Subtest: hdsl_search text mode finds matching artifacts
    ok 4 - hdsl_search text mode finds matching artifacts
      ---
      duration_ms: 2.4123
      ...
    # Subtest: hdsl_search artifact mode filters by kind
    ok 5 - hdsl_search artifact mode filters by kind
      ---
      duration_ms: 1.9092
      ...
    # Subtest: hdsl_deps returns dependencies for an artifact
    ok 6 - hdsl_deps returns dependencies for an artifact
      ---
      duration_ms: 6.791
      ...
    # Subtest: hdsl_trace returns BFS traversal from starting node
    ok 7 - hdsl_trace returns BFS traversal from starting node
      ---
      duration_ms: 2.1701
      ...
    # Subtest: hdsl_impact returns impact report for a target
    ok 8 - hdsl_impact returns impact report for a target
      ---
      duration_ms: 9.234
      ...
    # Subtest: hdsl_patterns returns pattern analysis
    ok 9 - hdsl_patterns returns pattern analysis
      ---
      duration_ms: 10.6762
      ...
    # Subtest: hdsl_path returns path between two entities
    ok 10 - hdsl_path returns path between two entities
      ---
      duration_ms: 2.2919
      ...
    # Subtest: hdsl_path returns no-path for disconnected entities
    ok 11 - hdsl_path returns no-path for disconnected entities
      ---
      duration_ms: 1.4718
      ...
    1..11
ok 92 - handleToolCall — integration
  ---
  duration_ms: 50.8775
  type: 'suite'
  ...
# Subtest: analyzeImpact — report structure
    # Subtest: returns a valid impact report for a target
    ok 1 - returns a valid impact report for a target
      ---
      duration_ms: 8.9745
      ...
    # Subtest: returns empty report for non-matching target
    ok 2 - returns empty report for non-matching target
      ---
      duration_ms: 1.1757
      ...
    # Subtest: throws without name
    ok 3 - throws without name
      ---
      duration_ms: 2.3179
      ...
    1..3
ok 93 - analyzeImpact — report structure
  ---
  duration_ms: 19.7887
  type: 'suite'
  ...
# Subtest: analyzeImpact — dependency chains
    # Subtest: finds reverse dependents (who depends on utils)
    ok 1 - finds reverse dependents (who depends on utils)
      ---
      duration_ms: 1.4912
      ...
    # Subtest: finds forward dependencies (what api.js depends on)
    ok 2 - finds forward dependencies (what api.js depends on)
      ---
      duration_ms: 1.8842
      ...
    # Subtest: respects depth parameter
    ok 3 - respects depth parameter
      ---
      duration_ms: 3.7009
      ...
    # Subtest: skips reverse when includeReverseImpact is false
    ok 4 - skips reverse when includeReverseImpact is false
      ---
      duration_ms: 0.6268
      ...
    1..4
ok 94 - analyzeImpact — dependency chains
  ---
  duration_ms: 8.7715
  type: 'suite'
  ...
# Subtest: analyzeImpact — affected files
    # Subtest: marks target entities with isTarget=true
    ok 1 - marks target entities with isTarget=true
      ---
      duration_ms: 1.5115
      ...
    # Subtest: includes type and kind for each file
    ok 2 - includes type and kind for each file
      ---
      duration_ms: 1.2112
      ...
    # Subtest: includes dependents and dependencies lists
    ok 3 - includes dependents and dependencies lists
      ---
      duration_ms: 0.7814
      ...
    # Subtest: sorts targets first, then by risk score
    ok 4 - sorts targets first, then by risk score
      ---
      duration_ms: 1.2463
      ...
    1..4
ok 95 - analyzeImpact — affected files
  ---
  duration_ms: 5.5753
  type: 'suite'
  ...
# Subtest: analyzeImpact — risk scoring
    # Subtest: assigns risk scores to affected files
    ok 1 - assigns risk scores to affected files
      ---
      duration_ms: 0.7911
      ...
    # Subtest: gives higher risk to utils (many dependents)
    ok 2 - gives higher risk to utils (many dependents)
      ---
      duration_ms: 0.7273
      ...
    # Subtest: includes risk factors breakdown
    ok 3 - includes risk factors breakdown
      ---
      duration_ms: 0.6447
      ...
    1..3
ok 96 - analyzeImpact — risk scoring
  ---
  duration_ms: 2.8069
  type: 'suite'
  ...
# Subtest: analyzeImpact — high risk entities
    # Subtest: identifies entities with risk >= 0.6 as high-risk
    ok 1 - identifies entities with risk >= 0.6 as high-risk
      ---
      duration_ms: 0.7242
      ...
    # Subtest: sorts high-risk entities by risk descending
    ok 2 - sorts high-risk entities by risk descending
      ---
      duration_ms: 0.4724
      ...
    1..2
ok 97 - analyzeImpact — high risk entities
  ---
  duration_ms: 1.5288
  type: 'suite'
  ...
# Subtest: analyzeImpact — summary
    # Subtest: includes overall risk level
    ok 1 - includes overall risk level
      ---
      duration_ms: 0.4326
      ...
    # Subtest: includes affected-by-type breakdown
    ok 2 - includes affected-by-type breakdown
      ---
      duration_ms: 0.6138
      ...
    # Subtest: counts match expectations for utils.js
    ok 3 - counts match expectations for utils.js
      ---
      duration_ms: 0.3913
      ...
    1..3
ok 98 - analyzeImpact — summary
  ---
  duration_ms: 1.7001
  type: 'suite'
  ...
# Subtest: categorizeOverallRisk
    # Subtest: returns low for minimal impact
    ok 1 - returns low for minimal impact
      ---
      duration_ms: 0.333
      ...
    # Subtest: returns medium for moderate impact
    ok 2 - returns medium for moderate impact
      ---
      duration_ms: 0.2279
      ...
    # Subtest: returns high for significant impact
    ok 3 - returns high for significant impact
      ---
      duration_ms: 0.2052
      ...
    # Subtest: returns critical for large-scale impact
    ok 4 - returns critical for large-scale impact
      ---
      duration_ms: 0.1786
      ...
    1..4
ok 99 - categorizeOverallRisk
  ---
  duration_ms: 1.2239
  type: 'suite'
  ...
# Subtest: computeRiskScores
    # Subtest: returns scores for given paths
    ok 1 - returns scores for given paths
      ---
      duration_ms: 1.767
      ...
    # Subtest: skips artifacts not in instance
    ok 2 - skips artifacts not in instance
      ---
      duration_ms: 0.3559
      ...
    1..2
ok 100 - computeRiskScores
  ---
  duration_ms: 2.3796
  type: 'suite'
  ...
# Subtest: analyzeImpact — glob pattern support
    # Subtest: matches multiple targets with wildcard
    ok 1 - matches multiple targets with wildcard
      ---
      duration_ms: 0.7835
      ...
    1..1
ok 101 - analyzeImpact — glob pattern support
  ---
  duration_ms: 1.0218
  type: 'suite'
  ...
# Subtest: detectNamingConvention
    # Subtest: detects camelCase
    ok 1 - detects camelCase
      ---
      duration_ms: 3.779
      ...
    # Subtest: detects PascalCase
    ok 2 - detects PascalCase
      ---
      duration_ms: 0.5482
      ...
    # Subtest: detects snake_case
    ok 3 - detects snake_case
      ---
      duration_ms: 0.5698
      ...
    # Subtest: detects kebab-case
    ok 4 - detects kebab-case
      ---
      duration_ms: 2.9325
      ...
    # Subtest: detects UPPER_SNAKE
    ok 5 - detects UPPER_SNAKE
      ---
      duration_ms: 1.0837
      ...
    # Subtest: returns other for mixed
    ok 6 - returns other for mixed
      ---
      duration_ms: 0.5656
      ...
    1..6
ok 102 - detectNamingConvention
  ---
  duration_ms: 14.026
  type: 'suite'
  ...
# Subtest: findDominant
    # Subtest: returns key with highest count
    ok 1 - returns key with highest count
      ---
      duration_ms: 1.1761
      ...
    # Subtest: returns null for empty map
    ok 2 - returns null for empty map
      ---
      duration_ms: 3.324
      ...
    1..2
ok 103 - findDominant
  ---
  duration_ms: 5.975
  type: 'suite'
  ...
# Subtest: discoverPatterns — naming
    # Subtest: returns file name convention distribution
    ok 1 - returns file name convention distribution
      ---
      duration_ms: 3.1808
      ...
    # Subtest: returns export convention distribution
    ok 2 - returns export convention distribution
      ---
      duration_ms: 2.0899
      ...
    # Subtest: includes examples
    ok 3 - includes examples
      ---
      duration_ms: 2.2033
      ...
    1..3
ok 104 - discoverPatterns — naming
  ---
  duration_ms: 8.73
  type: 'suite'
  ...
# Subtest: discoverPatterns — organization
    # Subtest: returns directory analysis
    ok 1 - returns directory analysis
      ---
      duration_ms: 2.0147
      ...
    # Subtest: detects top-level directories
    ok 2 - detects top-level directories
      ---
      duration_ms: 1.1287
      ...
    # Subtest: includes extension distribution
    ok 3 - includes extension distribution
      ---
      duration_ms: 1.2935
      ...
    1..3
ok 105 - discoverPatterns — organization
  ---
  duration_ms: 5.2812
  type: 'suite'
  ...
# Subtest: discoverPatterns — modules
    # Subtest: finds barrel files
    ok 1 - finds barrel files
      ---
      duration_ms: 3.1061
      ...
    # Subtest: finds shared utilities
    ok 2 - finds shared utilities
      ---
      duration_ms: 0.8587
      ...
    # Subtest: detects barrel-exports pattern
    ok 3 - detects barrel-exports pattern
      ---
      duration_ms: 1.3245
      ...
    # Subtest: includes dependency kind distribution
    ok 4 - includes dependency kind distribution
      ---
      duration_ms: 1.0063
      ...
    # Subtest: finds high-export modules
    ok 5 - finds high-export modules
      ---
      duration_ms: 0.7046
      ...
    1..5
ok 106 - discoverPatterns — modules
  ---
  duration_ms: 7.9011
  type: 'suite'
  ...
# Subtest: discoverPatterns — architecture
    # Subtest: detects architectural layers
    ok 1 - detects architectural layers
      ---
      duration_ms: 2.8429
      ...
    # Subtest: identifies presentation and service layers
    ok 2 - identifies presentation and service layers
      ---
      duration_ms: 1.4159
      ...
    # Subtest: detects cross-layer dependencies
    ok 3 - detects cross-layer dependencies
      ---
      duration_ms: 0.9878
      ...
    # Subtest: includes layer examples with file paths
    ok 4 - includes layer examples with file paths
      ---
      duration_ms: 0.9282
      ...
    # Subtest: includes element type usage
    ok 5 - includes element type usage
      ---
      duration_ms: 2.3155
      ...
    1..5
ok 107 - discoverPatterns — architecture
  ---
  duration_ms: 9.09
  type: 'suite'
  ...
# Subtest: discoverPatterns — similar
    # Subtest: finds similar implementations by feature type
    ok 1 - finds similar implementations by feature type
      ---
      duration_ms: 2.1982
      ...
    # Subtest: includes dependency context for matches
    ok 2 - includes dependency context for matches
      ---
      duration_ms: 0.9726
      ...
    # Subtest: includes relevance scores
    ok 3 - includes relevance scores
      ---
      duration_ms: 0.4846
      ...
    # Subtest: throws without featureType
    ok 4 - throws without featureType
      ---
      duration_ms: 1.2094
      ...
    1..4
ok 108 - discoverPatterns — similar
  ---
  duration_ms: 5.6193
  type: 'suite'
  ...
# Subtest: discoverPatterns — area filtering
    # Subtest: scopes analysis to a specific area
    ok 1 - scopes analysis to a specific area
      ---
      duration_ms: 1.673
      ...
    1..1
ok 109 - discoverPatterns — area filtering
  ---
  duration_ms: 2.5167
  type: 'suite'
  ...
# Subtest: discoverPatterns — all categories
    # Subtest: returns all sections when category is all
    ok 1 - returns all sections when category is all
      ---
      duration_ms: 1.18
      ...
    1..1
ok 110 - discoverPatterns — all categories
  ---
  duration_ms: 1.4178
  type: 'suite'
  ...
# Subtest: buildNodeSummary
    # Subtest: builds compact summary from artifact
    ok 1 - builds compact summary from artifact
      ---
      duration_ms: 4.9266
      ...
    # Subtest: handles missing optional fields
    ok 2 - handles missing optional fields
      ---
      duration_ms: 0.7563
      ...
    1..2
ok 111 - buildNodeSummary
  ---
  duration_ms: 10.254
  type: 'suite'
  ...
# Subtest: extractSubgraph
    # Subtest: returns root and depth-1 neighbors
    ok 1 - returns root and depth-1 neighbors
      ---
      duration_ms: 1.8901
      ...
    # Subtest: depth 0 returns only root nodes with no expansion
    ok 2 - depth 0 returns only root nodes with no expansion
      ---
      duration_ms: 0.6965
      ...
    1..2
ok 112 - extractSubgraph
  ---
  duration_ms: 3.5208
  type: 'suite'
  ...
# Subtest: queryModel — entity
    # Subtest: finds entities by name pattern and returns subgraph
    ok 1 - finds entities by name pattern and returns subgraph
      ---
      duration_ms: 2.7379
      ...
    # Subtest: filters by entityType
    ok 2 - filters by entityType
      ---
      duration_ms: 1.1406
      ...
    # Subtest: enriches nodes with typeDescription
    ok 3 - enriches nodes with typeDescription
      ---
      duration_ms: 1.1688
      ...
    # Subtest: respects depth parameter
    ok 4 - respects depth parameter
      ---
      duration_ms: 5.0001
      ...
    # Subtest: throws without name
    ok 5 - throws without name
      ---
      duration_ms: 2.3379
      ...
    1..5
ok 113 - queryModel — entity
  ---
  duration_ms: 13.7739
  type: 'suite'
  ...
# Subtest: queryModel — relation
    # Subtest: finds relations from a source pattern
    ok 1 - finds relations from a source pattern
      ---
      duration_ms: 2.3125
      ...
    # Subtest: finds relations to a target
    ok 2 - finds relations to a target
      ---
      duration_ms: 1.7949
      ...
    # Subtest: filters by depKind
    ok 3 - filters by depKind
      ---
      duration_ms: 1.2035
      ...
    # Subtest: finds relations by name (either end)
    ok 4 - finds relations by name (either end)
      ---
      duration_ms: 1.2038
      ...
    # Subtest: includes involved nodes
    ok 5 - includes involved nodes
      ---
      duration_ms: 1.0912
      ...
    # Subtest: throws without from/to/name
    ok 6 - throws without from/to/name
      ---
      duration_ms: 0.8292
      ...
    1..6
ok 114 - queryModel — relation
  ---
  duration_ms: 10.4062
  type: 'suite'
  ...
# Subtest: queryModel — structure
    # Subtest: returns directory tree and type breakdown
    ok 1 - returns directory tree and type breakdown
      ---
      duration_ms: 2.1209
      ...
    # Subtest: filters by pattern
    ok 2 - filters by pattern
      ---
      duration_ms: 1.0795
      ...
    # Subtest: filters by entityType
    ok 3 - filters by entityType
      ---
      duration_ms: 1.2706
      ...
    # Subtest: includes type descriptions from schema
    ok 4 - includes type descriptions from schema
      ---
      duration_ms: 1.2678
      ...
    1..4
ok 115 - queryModel — structure
  ---
  duration_ms: 6.5734
  type: 'suite'
  ...
# Subtest: queryModel — impact
    # Subtest: returns transitive dependency graph
    ok 1 - returns transitive dependency graph
      ---
      duration_ms: 1.9693
      ...
    # Subtest: marks root nodes
    ok 2 - marks root nodes
      ---
      duration_ms: 0.7421
      ...
    # Subtest: returns layers showing BFS depth
    ok 3 - returns layers showing BFS depth
      ---
      duration_ms: 1.391
      ...
    # Subtest: supports direction filtering
    ok 4 - supports direction filtering
      ---
      duration_ms: 0.8881
      ...
    # Subtest: returns empty result for non-matching pattern
    ok 5 - returns empty result for non-matching pattern
      ---
      duration_ms: 0.9271
      ...
    # Subtest: throws without name
    ok 6 - throws without name
      ---
      duration_ms: 0.9288
      ...
    1..6
ok 116 - queryModel — impact
  ---
  duration_ms: 7.8978
  type: 'suite'
  ...
# Subtest: queryModel — unknown type
    # Subtest: throws for unknown query type
    ok 1 - throws for unknown query type
      ---
      duration_ms: 1.2439
      ...
    1..1
ok 117 - queryModel — unknown type
  ---
  duration_ms: 1.8046
  type: 'suite'
  ...
# Subtest: Calendar Escape Utilities
    # Subtest: escapeHtml
        # Subtest: should escape < and > characters
        ok 1 - should escape < and > characters
          ---
          duration_ms: 3.6112
          ...
        # Subtest: should escape & character
        ok 2 - should escape & character
          ---
          duration_ms: 0.6477
          ...
        # Subtest: should handle null input
        ok 3 - should handle null input
          ---
          duration_ms: 0.5124
          ...
        # Subtest: should handle undefined input
        ok 4 - should handle undefined input
          ---
          duration_ms: 0.4782
          ...
        # Subtest: should handle non-string input
        ok 5 - should handle non-string input
          ---
          duration_ms: 2.5475
          ...
        # Subtest: should preserve safe strings
        ok 6 - should preserve safe strings
          ---
          duration_ms: 0.9102
          ...
        # Subtest: should handle empty string
        ok 7 - should handle empty string
          ---
          duration_ms: 0.7189
          ...
        1..7
    ok 1 - escapeHtml
      ---
      duration_ms: 12.2249
      type: 'suite'
      ...
    # Subtest: escapeAttr
        # Subtest: should escape double quotes
        ok 1 - should escape double quotes
          ---
          duration_ms: 1.1831
          ...
        # Subtest: should escape single quotes
        ok 2 - should escape single quotes
          ---
          duration_ms: 0.814
          ...
        # Subtest: should escape < > & characters
        ok 3 - should escape < > & characters
          ---
          duration_ms: 1.4283
          ...
        # Subtest: should handle null input
        ok 4 - should handle null input
          ---
          duration_ms: 0.7962
          ...
        # Subtest: should handle undefined input
        ok 5 - should handle undefined input
          ---
          duration_ms: 0.8952
          ...
        # Subtest: should handle non-string input
        ok 6 - should handle non-string input
          ---
          duration_ms: 1.0032
          ...
        # Subtest: should preserve safe strings
        ok 7 - should preserve safe strings
          ---
          duration_ms: 1.0634
          ...
        # Subtest: should handle complex XSS payloads
        ok 8 - should handle complex XSS payloads
          ---
          duration_ms: 0.9322
          ...
        1..8
    ok 2 - escapeAttr
      ---
      duration_ms: 12.8939
      type: 'suite'
      ...
    1..2
ok 118 - Calendar Escape Utilities
  ---
  duration_ms: 70.8348
  type: 'suite'
  ...
# Subtest: BranchIndicator XSS Prevention
    # Subtest: renderInline static method
        # Subtest: should escape HTML in branch names
        ok 1 - should escape HTML in branch names
          ---
          duration_ms: 2.9747
          ...
        # Subtest: should escape quotes in title attributes
        ok 2 - should escape quotes in title attributes
          ---
          duration_ms: 0.5173
          ...
        # Subtest: should escape single quotes in branch names
        ok 3 - should escape single quotes in branch names
          ---
          duration_ms: 0.3504
          ...
        # Subtest: should escape overflow tooltip content
        ok 4 - should escape overflow tooltip content
          ---
          duration_ms: 0.691
          ...
        # Subtest: should handle branches with ampersands
        ok 5 - should handle branches with ampersands
          ---
          duration_ms: 1.0248
          ...
        # Subtest: should handle empty branches array
        ok 6 - should handle empty branches array
          ---
          duration_ms: 0.7959
          ...
        # Subtest: should handle null branches
        ok 7 - should handle null branches
          ---
          duration_ms: 0.4504
          ...
        # Subtest: should handle string branch names
        ok 8 - should handle string branch names
          ---
          duration_ms: 0.3657
          ...
        # Subtest: should escape abbreviated names
        ok 9 - should escape abbreviated names
          ---
          duration_ms: 0.5032
          ...
        # Subtest: should preserve valid CSS color values
        ok 10 - should preserve valid CSS color values
          ---
          duration_ms: 0.575
          ...
        1..10
    ok 1 - renderInline static method
      ---
      duration_ms: 9.8723
      type: 'suite'
      ...
    1..1
ok 119 - BranchIndicator XSS Prevention
  ---
  duration_ms: 60.2184
  type: 'suite'
  ...
# Subtest: BranchIndicator Memory Management
    # Subtest: class structure
        # Subtest: should export BranchIndicator class
        ok 1 - should export BranchIndicator class
          ---
          duration_ms: 0.4249
          ...
        # Subtest: should have prototype methods for memory management
        ok 2 - should have prototype methods for memory management
          ---
          duration_ms: 0.3007
          ...
        # Subtest: should have prototype methods for event binding
        ok 3 - should have prototype methods for event binding
          ---
          duration_ms: 0.412
          ...
        1..3
    ok 1 - class structure
      ---
      duration_ms: 1.5255
      type: 'suite'
      ...
    # Subtest: listener tracking (requires DOM)
    ok 2 - listener tracking (requires DOM) # SKIP
      ---
      duration_ms: 0.2186
      type: 'suite'
      ...
    # Subtest: popover cleanup (requires DOM)
    ok 3 - popover cleanup (requires DOM) # SKIP
      ---
      duration_ms: 0.1571
      type: 'suite'
      ...
    # Subtest: cleanupListeners behavior (requires DOM)
    ok 4 - cleanupListeners behavior (requires DOM) # SKIP
      ---
      duration_ms: 0.1155
      type: 'suite'
      ...
    1..4
ok 120 - BranchIndicator Memory Management
  ---
  duration_ms: 3.5472
  type: 'suite'
  ...
# (node:35748) [MODULE_TYPELESS_PACKAGE_JSON] Warning: Module type of file:///C:/Users/jjdub/code/puffin/plugins/calendar/utils/escape.js is not specified and it doesn't parse as CommonJS.
# Reparsing as ES module because module syntax was detected. This incurs a performance overhead.
# To eliminate this warning, add "type": "module" to C:\\Users\\jjdub\\code\\puffin\\package.json.
# (Use `node --trace-warnings ...` to show where the warning was created)
# Subtest: Calendar Plugin
    # Subtest: Plugin Structure
        # Subtest: should have valid manifest
        ok 1 - should have valid manifest
          ---
          duration_ms: 25.7479
          ...
        # Subtest: should export activate and deactivate methods
        ok 2 - should export activate and deactivate methods
          ---
          duration_ms: 1.1706
          ...
        # Subtest: should export getMonthData method
        ok 3 - should export getMonthData method
          ---
          duration_ms: 0.5482
          ...
        # Subtest: should export getDayActivity method
        ok 4 - should export getDayActivity method
          ---
          duration_ms: 0.5119
          ...
        1..4
    ok 1 - Plugin Structure
      ---
      duration_ms: 30.6829
      type: 'suite'
      ...
    # Subtest: Plugin Activation
        # Subtest: should activate successfully with valid context
        ok 1 - should activate successfully with valid context
          ---
          duration_ms: 69.1937
          ...
        # Subtest: should throw error without projectPath
        ok 2 - should throw error without projectPath
          ---
          duration_ms: 5.4765
          ...
        # Subtest: should deactivate successfully
        ok 3 - should deactivate successfully
          ---
          duration_ms: 1.236
          ...
        1..3
    ok 2 - Plugin Activation
      ---
      duration_ms: 77.4626
      type: 'suite'
      ...
    # Subtest: getMonthData
        # Subtest: should return correct structure for January 2025
        not ok 1 - should return correct structure for January 2025
          ---
          duration_ms: 3.2687
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\calendar-plugin.test.js:113:5'
          failureType: 'testCodeFailure'
          error: 'this.context.log.warn is not a function'
          code: 'ERR_TEST_FAILURE'
          name: 'TypeError'
          stack: |-
            Object.getSprintHistory (C:\Users\jjdub\code\puffin\plugins\calendar\index.js:104:24)
            Object.getMonthData (C:\Users\jjdub\code\puffin\plugins\calendar\index.js:187:16)
            TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\plugins\calendar-plugin.test.js:114:41)
            Test.runInAsyncScope (node:async_hooks:206:9)
            Test.run (node:internal/test_runner/test:796:25)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1135:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
        # Subtest: should return correct structure for February 2024 (leap year)
        not ok 2 - should return correct structure for February 2024 (leap year)
          ---
          duration_ms: 1.316
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\calendar-plugin.test.js:124:5'
          failureType: 'testCodeFailure'
          error: 'this.context.log.warn is not a function'
          code: 'ERR_TEST_FAILURE'
          name: 'TypeError'
          stack: |-
            Object.getSprintHistory (C:\Users\jjdub\code\puffin\plugins\calendar\index.js:104:24)
            Object.getMonthData (C:\Users\jjdub\code\puffin\plugins\calendar\index.js:187:16)
            TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\plugins\calendar-plugin.test.js:125:41)
            Test.runInAsyncScope (node:async_hooks:206:9)
            Test.run (node:internal/test_runner/test:796:25)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
        # Subtest: should return day data with activity placeholder
        not ok 3 - should return day data with activity placeholder
          ---
          duration_ms: 1.5859
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\calendar-plugin.test.js:133:5'
          failureType: 'testCodeFailure'
          error: 'this.context.log.warn is not a function'
          code: 'ERR_TEST_FAILURE'
          name: 'TypeError'
          stack: |-
            Object.getSprintHistory (C:\Users\jjdub\code\puffin\plugins\calendar\index.js:104:24)
            Object.getMonthData (C:\Users\jjdub\code\puffin\plugins\calendar\index.js:187:16)
            TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\plugins\calendar-plugin.test.js:134:41)
            Test.runInAsyncScope (node:async_hooks:206:9)
            Test.run (node:internal/test_runner/test:796:25)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
        1..3
    not ok 3 - getMonthData
      ---
      duration_ms: 8.2316
      type: 'suite'
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\calendar-plugin.test.js:100:3'
      failureType: 'subtestsFailed'
      error: '3 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: getDayActivity
        # Subtest: should return empty activity structure
        not ok 1 - should return empty activity structure
          ---
          duration_ms: 1.9276
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\calendar-plugin.test.js:145:5'
          failureType: 'testCodeFailure'
          error: 'this.context.log.warn is not a function'
          code: 'ERR_TEST_FAILURE'
          name: 'TypeError'
          stack: |-
            Object.getSprintHistory (C:\Users\jjdub\code\puffin\plugins\calendar\index.js:104:24)
            Object.getSprintsForDate (C:\Users\jjdub\code\puffin\plugins\calendar\index.js:149:32)
            Object.getDayActivity (C:\Users\jjdub\code\puffin\plugins\calendar\index.js:220:32)
            TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\plugins\calendar-plugin.test.js:146:45)
            Test.runInAsyncScope (node:async_hooks:206:9)
            Test.run (node:internal/test_runner/test:796:25)
            Test.start (node:internal/test_runner/test:702:17)
            node:internal/test_runner/test:1133:71
            node:internal/per_context/primordials:482:82
            new Promise (<anonymous>)
          ...
        1..1
    not ok 4 - getDayActivity
      ---
      duration_ms: 2.7482
      type: 'suite'
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\calendar-plugin.test.js:144:3'
      failureType: 'subtestsFailed'
      error: '1 subtest failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: IPC Handlers
        # Subtest: should handle getMonthData IPC call
        not ok 1 - should handle getMonthData IPC call
          ---
          duration_ms: 1.8771
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\calendar-plugin.test.js:172:5'
          failureType: 'testCodeFailure'
          error: 'this.context.log.warn is not a function'
          code: 'ERR_TEST_FAILURE'
          name: 'TypeError'
          stack: |-
            Object.getSprintHistory (C:\Users\jjdub\code\puffin\plugins\calendar\index.js:104:24)
            Object.getMonthData (C:\Users\jjdub\code\puffin\plugins\calendar\index.js:187:16)
            Object.handleGetMonthData (C:\Users\jjdub\code\puffin\plugins\calendar\index.js:448:17)
            TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\plugins\calendar-plugin.test.js:174:28)
            Test.runInAsyncScope (node:async_hooks:206:9)
            Test.run (node:internal/test_runner/test:796:25)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1135:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
        # Subtest: should handle getDayActivity IPC call
        not ok 2 - should handle getDayActivity IPC call
          ---
          duration_ms: 1.6631
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\calendar-plugin.test.js:181:5'
          failureType: 'testCodeFailure'
          error: 'this.context.log.warn is not a function'
          code: 'ERR_TEST_FAILURE'
          name: 'TypeError'
          stack: |-
            Object.getSprintHistory (C:\Users\jjdub\code\puffin\plugins\calendar\index.js:104:24)
            Object.getSprintsForDate (C:\Users\jjdub\code\puffin\plugins\calendar\index.js:149:32)
            Object.getDayActivity (C:\Users\jjdub\code\puffin\plugins\calendar\index.js:220:32)
            Object.handleGetDayActivity (C:\Users\jjdub\code\puffin\plugins\calendar\index.js:452:17)
            TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\plugins\calendar-plugin.test.js:183:28)
            Test.runInAsyncScope (node:async_hooks:206:9)
            Test.run (node:internal/test_runner/test:796:25)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
        1..2
    not ok 5 - IPC Handlers
      ---
      duration_ms: 5.4587
      type: 'suite'
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\calendar-plugin.test.js:156:3'
      failureType: 'subtestsFailed'
      error: '2 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    1..5
not ok 121 - Calendar Plugin
  ---
  duration_ms: 145.5914
  type: 'suite'
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\calendar-plugin.test.js:10:1'
  failureType: 'subtestsFailed'
  error: '3 subtests failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: Date Utilities
    # Subtest: getDaysInMonth
        # Subtest: should return 31 for January
        ok 1 - should return 31 for January
          ---
          duration_ms: 0.8059
          ...
        # Subtest: should return 28 for February non-leap year
        ok 2 - should return 28 for February non-leap year
          ---
          duration_ms: 0.3962
          ...
        # Subtest: should return 29 for February leap year
        ok 3 - should return 29 for February leap year
          ---
          duration_ms: 0.5186
          ...
        # Subtest: should return 30 for April
        ok 4 - should return 30 for April
          ---
          duration_ms: 0.3475
          ...
        1..4
    ok 1 - getDaysInMonth
      ---
      duration_ms: 3.0588
      type: 'suite'
      ...
    # Subtest: getFirstDayOfMonth
        # Subtest: should return Wednesday (3) for January 2025
        ok 1 - should return Wednesday (3) for January 2025
          ---
          duration_ms: 0.9909
          ...
        # Subtest: should return Sunday (0) for September 2024
        ok 2 - should return Sunday (0) for September 2024
          ---
          duration_ms: 0.572
          ...
        1..2
    ok 2 - getFirstDayOfMonth
      ---
      duration_ms: 1.9163
      type: 'suite'
      ...
    # Subtest: formatDateISO
        # Subtest: should format date as YYYY-MM-DD
        ok 1 - should format date as YYYY-MM-DD
          ---
          duration_ms: 1.3363
          ...
        1..1
    ok 3 - formatDateISO
      ---
      duration_ms: 1.9683
      type: 'suite'
      ...
    # Subtest: getMonthName
        # Subtest: should return full month name
        ok 1 - should return full month name
          ---
          duration_ms: 67.9477
          ...
        # Subtest: should return short month name
        ok 2 - should return short month name
          ---
          duration_ms: 1.8117
          ...
        1..2
    ok 4 - getMonthName
      ---
      duration_ms: 70.4794
      type: 'suite'
      ...
    # Subtest: isToday
        # Subtest: should return true for today
        ok 1 - should return true for today
          ---
          duration_ms: 0.5893
          ...
        # Subtest: should return false for yesterday
        ok 2 - should return false for yesterday
          ---
          duration_ms: 0.4475
          ...
        # Subtest: should work with date strings
        not ok 3 - should work with date strings
          ---
          duration_ms: 4.3876
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\calendar-plugin.test.js:255:5'
          failureType: 'testCodeFailure'
          error: |-
            Expected values to be strictly equal:
            
            false !== true
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: true
          actual: false
          operator: 'strictEqual'
          stack: |-
            TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\plugins\calendar-plugin.test.js:257:14)
            Test.runInAsyncScope (node:async_hooks:206:9)
            Test.run (node:internal/test_runner/test:796:25)
            Suite.processPendingSubtests (node:internal/test_runner/test:526:18)
            Test.postRun (node:internal/test_runner/test:889:19)
            Test.run (node:internal/test_runner/test:835:12)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
# (node:29540) [MODULE_TYPELESS_PACKAGE_JSON] Warning: Module type of file:///C:/Users/jjdub/code/puffin/plugins/calendar/renderer/components/NoteEditor.js is not specified and it doesn't parse as CommonJS.
# Reparsing as ES module because module syntax was detected. This incurs a performance overhead.
# To eliminate this warning, add "type": "module" to C:\\Users\\jjdub\\code\\puffin\\package.json.
# (Use `node --trace-warnings ...` to show where the warning was created)
        1..3
    not ok 5 - isToday
      ---
      duration_ms: 6.3415
      type: 'suite'
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\calendar-plugin.test.js:243:3'
      failureType: 'subtestsFailed'
      error: '1 subtest failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: isWeekend
        # Subtest: should return true for Saturday
        ok 1 - should return true for Saturday
          ---
          duration_ms: 0.5036
          ...
        # Subtest: should return true for Sunday
        ok 2 - should return true for Sunday
          ---
          duration_ms: 0.3037
          ...
        # Subtest: should return false for weekdays
        ok 3 - should return false for weekdays
          ---
          duration_ms: 0.2946
          ...
        1..3
    ok 6 - isWeekend
      ---
      duration_ms: 1.4878
      type: 'suite'
      ...
    # Subtest: addDays
        # Subtest: should add days correctly
        ok 1 - should add days correctly
          ---
          duration_ms: 0.3764
          ...
        # Subtest: should handle month rollover
        ok 2 - should handle month rollover
          ---
          duration_ms: 0.263
          ...
        1..2
    ok 7 - addDays
      ---
      duration_ms: 0.8613
      type: 'suite'
      ...
    # Subtest: addMonths
        # Subtest: should add months correctly
        ok 1 - should add months correctly
          ---
          duration_ms: 0.4016
          ...
        # Subtest: should handle year rollover
        ok 2 - should handle year rollover
          ---
          duration_ms: 0.6468
          ...
        1..2
    ok 8 - addMonths
      ---
      duration_ms: 1.4506
      type: 'suite'
      ...
    # Subtest: isSameDay
        # Subtest: should return true for same day
        ok 1 - should return true for same day
          ---
          duration_ms: 0.7169
          ...
        # Subtest: should return false for different days
        ok 2 - should return false for different days
          ---
          duration_ms: 0.5865
          ...
        1..2
    ok 9 - isSameDay
      ---
      duration_ms: 1.775
      type: 'suite'
      ...
    # Subtest: parseDate
        # Subtest: should parse valid date string
        ok 1 - should parse valid date string
          ---
          duration_ms: 0.5216
          ...
        # Subtest: should return null for invalid date
        ok 2 - should return null for invalid date
          ---
          duration_ms: 4.2278
          ...
        # Subtest: should return null for empty string
        ok 3 - should return null for empty string
          ---
          duration_ms: 0.5032
          ...
        1..3
    ok 10 - parseDate
      ---
      duration_ms: 5.6709
      type: 'suite'
      ...
    # Subtest: getMonthDateRange
        # Subtest: should return start and end of month
        ok 1 - should return start and end of month
          ---
          duration_ms: 0.4417
          ...
        1..1
    ok 11 - getMonthDateRange
      ---
      duration_ms: 0.6407
      type: 'suite'
      ...
    # Subtest: getWeekNumber
        # Subtest: should return week 1 for early January
        ok 1 - should return week 1 for early January
          ---
          duration_ms: 0.4353
          ...
        1..1
    ok 12 - getWeekNumber
      ---
      duration_ms: 0.6154
      type: 'suite'
      ...
    1..12
not ok 122 - Date Utilities
  ---
  duration_ms: 98.7393
  type: 'suite'
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\calendar-plugin.test.js:190:1'
  failureType: 'subtestsFailed'
  error: '1 subtest failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: CalendarView Component
    # Subtest: should export CalendarView class
    ok 1 - should export CalendarView class
      ---
      duration_ms: 49.7988
      ...
    1..1
ok 123 - CalendarView Component
  ---
  duration_ms: 50.078
  type: 'suite'
  ...
# Subtest: DayCell Component
    # Subtest: should export DayCell class
    ok 1 - should export DayCell class
      ---
      duration_ms: 4.7147
      ...
    1..1
ok 124 - DayCell Component
  ---
  duration_ms: 4.9883
  type: 'suite'
  ...
# Subtest: Renderer Components Index
    # Subtest: should export all components
    not ok 1 - should export all components
      ---
      duration_ms: 73.2051
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\calendar-plugin.test.js:376:3'
      failureType: 'testCodeFailure'
      error: |-
        The expression evaluated to a falsy value:
        
          assert.ok(typeof components.CalendarViewComponent.mount === 'function')
        
      code: 'ERR_ASSERTION'
      name: 'AssertionError'
      expected: true
      actual: false
      operator: '=='
      stack: |-
        TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\plugins\calendar-plugin.test.js:382:12)
        Test.runInAsyncScope (node:async_hooks:206:9)
        Test.run (node:internal/test_runner/test:796:25)
        Test.start (node:internal/test_runner/test:702:17)
        node:internal/test_runner/test:1133:71
        node:internal/per_context/primordials:482:82
        new Promise (<anonymous>)
        new SafePromise (node:internal/per_context/primordials:450:29)
        node:internal/per_context/primordials:482:9
        Array.map (<anonymous>)
      ...
    1..1
not ok 125 - Renderer Components Index
  ---
  duration_ms: 73.4753
  type: 'suite'
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\calendar-plugin.test.js:375:1'
  failureType: 'subtestsFailed'
  error: '1 subtest failed'
  code: 'ERR_TEST_FAILURE'
  ...
# C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\claude-config.test.js:15
# describe('ClaudeConfigPlugin', () => {
# ^
# ReferenceError: describe is not defined
#     at Object.<anonymous> (C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\claude-config.test.js:15:1)
#     at Module._compile (node:internal/modules/cjs/loader:1521:14)
#     at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
#     at Module.load (node:internal/modules/cjs/loader:1266:32)
#     at Module._load (node:internal/modules/cjs/loader:1091:12)
#     at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
#     at node:internal/main/run_main_module:28:49
# Node.js v20.19.6
# Subtest: C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\claude-config.test.js
not ok 28 - C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\claude-config.test.js
  ---
  duration_ms: 1017.0554
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\claude-config.test.js:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: ContributionParser
    # Subtest: VALID_VIEW_LOCATIONS
        # Subtest: should contain expected locations
        not ok 1 - should contain expected locations
          ---
          duration_ms: 16.131
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\contribution-parser.test.js:18:5'
          failureType: 'testCodeFailure'
          error: |-
            Expected values to be strictly deep-equal:
            + actual - expected ... Lines skipped
            
              [
                'sidebar',
            ...
                'toolbar',
                'editor',
            +   'nav'
              ]
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected:
            0: 'sidebar'
            1: 'panel'
            2: 'statusbar'
            3: 'toolbar'
            4: 'editor'
          actual:
            0: 'sidebar'
            1: 'panel'
            2: 'statusbar'
            3: 'toolbar'
            4: 'editor'
            5: 'nav'
          operator: 'deepStrictEqual'
          stack: |-
            TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\plugins\contribution-parser.test.js:19:14)
            Test.runInAsyncScope (node:async_hooks:206:9)
            Test.run (node:internal/test_runner/test:796:25)
            Test.start (node:internal/test_runner/test:702:17)
            node:internal/test_runner/test:1133:71
            node:internal/per_context/primordials:482:82
            new Promise (<anonymous>)
            new SafePromise (node:internal/per_context/primordials:450:29)
            node:internal/per_context/primordials:482:9
            Array.map (<anonymous>)
          ...
        1..1
    not ok 1 - VALID_VIEW_LOCATIONS
      ---
      duration_ms: 19.382
      type: 'suite'
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\contribution-parser.test.js:17:3'
      failureType: 'subtestsFailed'
      error: '1 subtest failed'
      code: 'ERR_TEST_FAILURE'
      stack: |-
        async Promise.all (index 0)
      ...
    # Subtest: parseViewContributions
        # Subtest: should return empty result for manifest without contributes
        ok 1 - should return empty result for manifest without contributes
          ---
          duration_ms: 2.0347
          ...
        # Subtest: should return empty result for manifest without views
        ok 2 - should return empty result for manifest without views
          ---
          duration_ms: 0.5239
          ...
        # Subtest: should error if views is not an array
        ok 3 - should error if views is not an array
          ---
          duration_ms: 0.6834
          ...
        # Subtest: should parse valid view contribution
        ok 4 - should parse valid view contribution
          ---
          duration_ms: 1.724
          ...
        # Subtest: should warn when icon is missing
        ok 5 - should warn when icon is missing
          ---
          duration_ms: 0.9729
          ...
        # Subtest: should parse optional when clause
        ok 6 - should parse optional when clause
          ---
          duration_ms: 0.9306
          ...
        # Subtest: should parse optional component name
        ok 7 - should parse optional component name
          ---
          duration_ms: 1.0849
          ...
        # Subtest: should parse multiple views
        ok 8 - should parse multiple views
          ---
          duration_ms: 0.891
          ...
        # Subtest: should error on duplicate view IDs
        ok 9 - should error on duplicate view IDs
          ---
          duration_ms: 0.6766
          ...
        # Subtest: should skip invalid view objects
        ok 10 - should skip invalid view objects
          ---
          duration_ms: 0.7345
          ...
        1..10
    ok 2 - parseViewContributions
      ---
      duration_ms: 13.4147
      type: 'suite'
      ...
    # Subtest: validateViewContribution
        # Subtest: should error on missing id
        ok 1 - should error on missing id
          ---
          duration_ms: 1.1062
          ...
        # Subtest: should error on invalid id type
        ok 2 - should error on invalid id type
          ---
          duration_ms: 0.4994
          ...
        # Subtest: should error on invalid id format
        ok 3 - should error on invalid id format
          ---
          duration_ms: 0.4229
          ...
        # Subtest: should error on missing name
        ok 4 - should error on missing name
          ---
          duration_ms: 0.4742
          ...
        # Subtest: should error on empty name
        not ok 5 - should error on empty name
          ---
          duration_ms: 27.5622
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\contribution-parser.test.js:233:5'
          failureType: 'testCodeFailure'
          error: |-
            The expression evaluated to a falsy value:
            
              assert.ok(errors.some(e => e.includes('"name" cannot be empty')))
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: true
          actual: false
          operator: '=='
          stack: |-
            TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\plugins\contribution-parser.test.js:240:14)
            Test.runInAsyncScope (node:async_hooks:206:9)
            Test.run (node:internal/test_runner/test:796:25)
            Suite.processPendingSubtests (node:internal/test_runner/test:526:18)
            Test.postRun (node:internal/test_runner/test:889:19)
            Test.run (node:internal/test_runner/test:835:12)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
        # Subtest: should error on name too long
        ok 6 - should error on name too long
          ---
          duration_ms: 0.8694
          ...
        # Subtest: should error on missing location
        ok 7 - should error on missing location
          ---
          duration_ms: 1.106
          ...
        # Subtest: should error on invalid location
        ok 8 - should error on invalid location
          ---
          duration_ms: 0.868
          ...
        # Subtest: should error on empty icon
        ok 9 - should error on empty icon
          ---
          duration_ms: 0.6136
          ...
        # Subtest: should error on non-integer order
        ok 10 - should error on non-integer order
          ---
          duration_ms: 0.5493
          ...
        # Subtest: should error on order out of range
        ok 11 - should error on order out of range
          ---
          duration_ms: 0.4781
          ...
        # Subtest: should error on invalid component name
        ok 12 - should error on invalid component name
          ---
          duration_ms: 0.7709
          ...
        # Subtest: should return no errors for valid view
        ok 13 - should return no errors for valid view
          ---
          duration_ms: 0.5747
          ...
        1..13
    not ok 3 - validateViewContribution
      ---
      duration_ms: 39.3686
      type: 'suite'
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\contribution-parser.test.js:192:3'
      failureType: 'subtestsFailed'
      error: '1 subtest failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: getViewsByLocation
        # Subtest: should filter views by location
        ok 1 - should filter views by location
          ---
          duration_ms: 0.8816
          ...
        # Subtest: should return empty array for unknown location
        ok 2 - should return empty array for unknown location
          ---
          duration_ms: 0.8274
          ...
        # Subtest: should sort by order
        ok 3 - should sort by order
          ---
          duration_ms: 0.5443
          ...
        1..3
    ok 4 - getViewsByLocation
      ---
      duration_ms: 4.7222
      type: 'suite'
      ...
    # Subtest: getViewLocations
        # Subtest: should return unique locations
        ok 1 - should return unique locations
          ---
          duration_ms: 1.089
          ...
        # Subtest: should return empty array for no views
        ok 2 - should return empty array for no views
          ---
          duration_ms: 0.4403
          ...
        1..2
    ok 5 - getViewLocations
      ---
      duration_ms: 1.9561
      type: 'suite'
      ...
    # Subtest: mergeViewContributions
        # Subtest: should merge views from multiple plugins
        ok 1 - should merge views from multiple plugins
          ---
          duration_ms: 0.6786
          ...
        # Subtest: should sort merged views by order
        ok 2 - should sort merged views by order
          ---
          duration_ms: 0.3647
          ...
        # Subtest: should handle empty map
        ok 3 - should handle empty map
          ---
          duration_ms: 0.2754
          ...
        1..3
    ok 6 - mergeViewContributions
      ---
      duration_ms: 2.1273
      type: 'suite'
      ...
    1..6
not ok 127 - ContributionParser
  ---
  duration_ms: 85.8909
  type: 'suite'
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\contribution-parser.test.js:16:1'
  failureType: 'subtestsFailed'
  error: '2 subtests failed'
  code: 'ERR_TEST_FAILURE'
  ...
# C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\designer-storage.test.js:12
# describe('DesignerStorage', () => {
# ^
# ReferenceError: describe is not defined
#     at Object.<anonymous> (C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\designer-storage.test.js:12:1)
#     at Module._compile (node:internal/modules/cjs/loader:1521:14)
#     at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
#     at Module.load (node:internal/modules/cjs/loader:1266:32)
#     at Module._load (node:internal/modules/cjs/loader:1091:12)
#     at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
#     at node:internal/main/run_main_module:28:49
# Node.js v20.19.6
# Subtest: C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\designer-storage.test.js
not ok 30 - C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\designer-storage.test.js
  ---
  duration_ms: 988.1316
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\designer-storage.test.js:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\document-editor-plugin.test.js:14
# describe('DocumentEditorPlugin', () => {
# ^
# ReferenceError: describe is not defined
#     at Object.<anonymous> (C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\document-editor-plugin.test.js:14:1)
#     at Module._compile (node:internal/modules/cjs/loader:1521:14)
#     at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
#     at Module.load (node:internal/modules/cjs/loader:1266:32)
#     at Module._load (node:internal/modules/cjs/loader:1091:12)
#     at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
#     at node:internal/main/run_main_module:28:49
# Node.js v20.19.6
# Subtest: C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\document-editor-plugin.test.js
not ok 31 - C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\document-editor-plugin.test.js
  ---
  duration_ms: 997.4153
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\document-editor-plugin.test.js:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: HdslViewerPlugin — lifecycle
    # Subtest: activate registers 4 IPC handlers and 3 actions
    ok 1 - activate registers 4 IPC handlers and 3 actions
      ---
      duration_ms: 13.2758
      ...
    # Subtest: deactivate clears _creDir
    ok 2 - deactivate clears _creDir
      ---
      duration_ms: 3.261
      ...
    1..2
ok 130 - HdslViewerPlugin — lifecycle
  ---
  duration_ms: 23.0039
  type: 'suite'
  ...
# Subtest: HdslViewerPlugin — _readJson
    # Subtest: reads and parses a valid JSON file
    ok 1 - reads and parses a valid JSON file
      ---
      duration_ms: 42.5971
      ...
    # Subtest: throws descriptive error when file missing
    ok 2 - throws descriptive error when file missing
      ---
      duration_ms: 7.8198
      ...
    # Subtest: throws on malformed JSON
    ok 3 - throws on malformed JSON
      ---
      duration_ms: 14.1413
      ...
    1..3
ok 131 - HdslViewerPlugin — _readJson
  ---
  duration_ms: 65.9072
  type: 'suite'
  ...
# Subtest: HdslViewerPlugin — _walkDir
    # Subtest: finds files matching extension recursively
    ok 1 - finds files matching extension recursively
      ---
      duration_ms: 21.6767
      ...
    # Subtest: returns empty array for empty directory
    ok 2 - returns empty array for empty directory
      ---
      duration_ms: 6.5686
      ...
    # Subtest: throws for non-existent directory
    ok 3 - throws for non-existent directory
      ---
      duration_ms: 10.6183
      ...
    1..3
ok 132 - HdslViewerPlugin — _walkDir
  ---
  duration_ms: 40.8963
  type: 'suite'
  ...
# Subtest: HdslViewerPlugin — getAnnotation path traversal
    # Subtest: reads a valid annotation file
    ok 1 - reads a valid annotation file
      ---
      duration_ms: 24.1333
      ...
    # Subtest: rejects path traversal with ../
    ok 2 - rejects path traversal with ../
      ---
      duration_ms: 12.4944
      ...
    # Subtest: rejects absolute path traversal
    ok 3 - rejects absolute path traversal
      ---
      duration_ms: 14.0275
      ...
    # Subtest: throws when filePath is missing
    ok 4 - throws when filePath is missing
      ---
      duration_ms: 14.2969
      ...
    # Subtest: throws when args is null
    ok 5 - throws when args is null
      ---
      duration_ms: 14.7608
      ...
    1..5
ok 133 - HdslViewerPlugin — getAnnotation path traversal
  ---
  duration_ms: 81.2085
  type: 'suite'
  ...
# Subtest: HdslViewerPlugin — getAnnotations
    # Subtest: returns empty array when annotations dir missing
    ok 1 - returns empty array when annotations dir missing
      ---
      duration_ms: 13.3022
      ...
    # Subtest: lists annotation files with normalized paths
    ok 2 - lists annotation files with normalized paths
      ---
      duration_ms: 28.2221
      ...
    1..2
ok 134 - HdslViewerPlugin — getAnnotations
  ---
  duration_ms: 42.7111
  type: 'suite'
  ...
# Subtest: HdslViewerPlugin — getSchema / getInstance
    # Subtest: getSchema returns parsed schema.json
    ok 1 - getSchema returns parsed schema.json
      ---
      duration_ms: 20.1201
      ...
    # Subtest: getInstance returns parsed instance.json
    ok 2 - getInstance returns parsed instance.json
      ---
      duration_ms: 15.379
      ...
    # Subtest: getSchema throws when file missing
    ok 3 - getSchema throws when file missing
      ---
      duration_ms: 6.7538
      ...
    1..3
ok 135 - HdslViewerPlugin — getSchema / getInstance
  ---
  duration_ms: 43.6415
  type: 'suite'
  ...
# Subtest: Manifest Schema
    # Subtest: should be valid JSON
    ok 1 - should be valid JSON
      ---
      duration_ms: 3.7096
      ...
    # Subtest: should have correct $schema
    ok 2 - should have correct $schema
      ---
      duration_ms: 0.5962
      ...
    # Subtest: should require name, version, displayName, description, main
    ok 3 - should require name, version, displayName, description, main
      ---
      duration_ms: 2.42
      ...
    # Subtest: should define name with correct pattern
    ok 4 - should define name with correct pattern
      ---
      duration_ms: 0.5356
      ...
    # Subtest: should define version with semver pattern
    ok 5 - should define version with semver pattern
      ---
      duration_ms: 0.4277
      ...
    # Subtest: should define extensionPoints with all required properties
    ok 6 - should define extensionPoints with all required properties
      ---
      duration_ms: 3.344
      ...
    # Subtest: should define ipcHandlers with namespace:action pattern
    ok 7 - should define ipcHandlers with namespace:action pattern
      ---
      duration_ms: 0.5888
      ...
    # Subtest: should define optional author field with string or object
    ok 8 - should define optional author field with string or object
      ---
      duration_ms: 0.773
      ...
    # Subtest: should define engines with puffin version
    ok 9 - should define engines with puffin version
      ---
      duration_ms: 1.0039
      ...
    # Subtest: should not allow additional properties at root
    ok 10 - should not allow additional properties at root
      ---
      duration_ms: 0.6847
      ...
    # Subtest: should define renderer section
    ok 11 - should define renderer section
      ---
      duration_ms: 0.6958
      ...
    # Subtest: should define renderer.entry with correct pattern
    ok 12 - should define renderer.entry with correct pattern
      ---
      duration_ms: 0.726
      ...
    # Subtest: should define renderer.components array
    ok 13 - should define renderer.components array
      ---
      duration_ms: 0.8194
      ...
    # Subtest: should define renderer.styles array
    ok 14 - should define renderer.styles array
      ---
      duration_ms: 1.2875
      ...
    # Subtest: should define renderer.dependencies object
    ok 15 - should define renderer.dependencies object
      ---
      duration_ms: 1.2175
      ...
    1..15
ok 136 - Manifest Schema
  ---
  duration_ms: 45.6942
  type: 'suite'
  ...
# Subtest: Manifest Validation Logic
    # Subtest: should validate correct plugin names
    ok 1 - should validate correct plugin names
      ---
      duration_ms: 0.7926
      ...
    # Subtest: should validate semver versions
    ok 2 - should validate semver versions
      ---
      duration_ms: 1.5929
      ...
    # Subtest: should validate ipcHandler format
    ok 3 - should validate ipcHandler format
      ---
      duration_ms: 1.0786
      ...
    # Subtest: should validate action names (camelCase)
    ok 4 - should validate action names (camelCase)
      ---
      duration_ms: 1.0112
      ...
    # Subtest: should validate component names (kebab-case)
    ok 5 - should validate component names (kebab-case)
      ---
      duration_ms: 1.1638
      ...
    1..5
ok 137 - Manifest Validation Logic
  ---
  duration_ms: 6.8665
  type: 'suite'
  ...
# Subtest: Renderer Manifest Schema
    # Subtest: should be valid JSON
    ok 1 - should be valid JSON
      ---
      duration_ms: 1.4808
      ...
    # Subtest: should have correct $schema
    ok 2 - should have correct $schema
      ---
      duration_ms: 0.6641
      ...
    # Subtest: should require entry field
    ok 3 - should require entry field
      ---
      duration_ms: 0.9464
      ...
    # Subtest: should define entry with correct pattern
    ok 4 - should define entry with correct pattern
      ---
      duration_ms: 1.559
      ...
    # Subtest: should define components array
    ok 5 - should define components array
      ---
      duration_ms: 0.6708
      ...
    # Subtest: should define styles array with CSS pattern
    ok 6 - should define styles array with CSS pattern
      ---
      duration_ms: 0.9063
      ...
    # Subtest: should define dependencies object
    ok 7 - should define dependencies object
      ---
      duration_ms: 0.6696
      ...
    # Subtest: should define preload and sandbox booleans
    ok 8 - should define preload and sandbox booleans
      ---
      duration_ms: 0.4572
      ...
    # Subtest: should have componentExport definition
    ok 9 - should have componentExport definition
      ---
      duration_ms: 0.7489
      ...
    1..9
ok 138 - Renderer Manifest Schema
  ---
  duration_ms: 57.1357
  type: 'suite'
  ...
# Subtest: Renderer Validation Patterns
    # Subtest: should validate renderer entry paths
    not ok 1 - should validate renderer entry paths
      ---
      duration_ms: 27.2723
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\manifest-validator.test.js:228:3'
      failureType: 'testCodeFailure'
      error: |-
        The expression evaluated to a falsy value:
        
          assert.ok(!pattern.test('../outside/index.js'))
        
      code: 'ERR_ASSERTION'
      name: 'AssertionError'
      expected: true
      actual: false
      operator: '=='
      stack: |-
        TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\plugins\manifest-validator.test.js:235:12)
        Test.runInAsyncScope (node:async_hooks:206:9)
        Test.run (node:internal/test_runner/test:796:25)
        Test.start (node:internal/test_runner/test:702:17)
        node:internal/test_runner/test:1133:71
        node:internal/per_context/primordials:482:82
        new Promise (<anonymous>)
        new SafePromise (node:internal/per_context/primordials:450:29)
        node:internal/per_context/primordials:482:9
        Array.map (<anonymous>)
      ...
    # Subtest: should validate component names (PascalCase)
    ok 2 - should validate component names (PascalCase)
      ---
      duration_ms: 0.8276
      ...
    # Subtest: should validate export names
    ok 3 - should validate export names
      ---
      duration_ms: 1.1048
      ...
    # Subtest: should validate style file paths
    ok 4 - should validate style file paths
      ---
      duration_ms: 0.9099
      ...
    # Subtest: should validate dependency versions
    ok 5 - should validate dependency versions
      ---
      duration_ms: 1.0961
      ...
    1..5
not ok 139 - Renderer Validation Patterns
  ---
  duration_ms: 32.3695
  type: 'suite'
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\manifest-validator.test.js:227:1'
  failureType: 'subtestsFailed'
  error: '1 subtest failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: Sample Manifests
    # Subtest: should have valid minimal manifest structure
    ok 1 - should have valid minimal manifest structure
      ---
      duration_ms: 0.7199
      ...
    # Subtest: should have valid full manifest structure
    ok 2 - should have valid full manifest structure
      ---
      duration_ms: 0.6259
      ...
    # Subtest: should have valid manifest with renderer section
    ok 3 - should have valid manifest with renderer section
      ---
      duration_ms: 0.8513
      ...
    1..3
ok 140 - Sample Manifests
  ---
  duration_ms: 2.9159
  type: 'suite'
  ...
# C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\marker-utils.test.js:143
# describe('MarkerUtils', () => {
# ^
# ReferenceError: describe is not defined
#     at Object.<anonymous> (C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\marker-utils.test.js:143:1)
#     at Module._compile (node:internal/modules/cjs/loader:1521:14)
#     at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
#     at Module.load (node:internal/modules/cjs/loader:1266:32)
#     at Module._load (node:internal/modules/cjs/loader:1091:12)
#     at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
#     at node:internal/main/run_main_module:28:49
# Node.js v20.19.6
# Subtest: C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\marker-utils.test.js
not ok 34 - C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\marker-utils.test.js
  ---
  duration_ms: 827.9156
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\marker-utils.test.js:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: Cleanup - deactivate resilience
    # Subtest: should not throw if unsubscribe throws
    ok 1 - should not throw if unsubscribe throws
      ---
      duration_ms: 60.787
      ...
    # Subtest: should clean up all references even without unsubscribe
    ok 2 - should clean up all references even without unsubscribe
      ---
      duration_ms: 1.2099
      ...
    1..2
ok 142 - Cleanup - deactivate resilience
  ---
  duration_ms: 67.791
  type: 'suite'
  ...
# Subtest: Cleanup - Storage corrupted JSON handling
    # Subtest: should return defaults for malformed JSON
    ok 1 - should return defaults for malformed JSON
      ---
      duration_ms: 52.7642
      ...
    # Subtest: should return defaults for JSON with wrong structure
    ok 2 - should return defaults for JSON with wrong structure
      ---
      duration_ms: 14.4073
      ...
    # Subtest: should return valid data for correct JSON
    ok 3 - should return valid data for correct JSON
      ---
      duration_ms: 17.8032
      ...
# [outcome-lifecycle-plugin] Malformed JSON in data file, using defaults: Expected property name or '}' in JSON at position 1
# [outcome-lifecycle-plugin] Corrupted data file, using defaults
# [outcome-lifecycle-plugin] Deactivated
    # Subtest: should return defaults for missing file
    ok 4 - should return defaults for missing file
      ---
      duration_ms: 9.4991
      ...
    1..4
ok 143 - Cleanup - Storage corrupted JSON handling
  ---
  duration_ms: 97.0869
  type: 'suite'
  ...
# Subtest: Cleanup - activate failure does not throw
    # Subtest: should not throw when storage init fails
    ok 1 - should not throw when storage init fails
      ---
      duration_ms: 2.3921
      ...
    1..1
ok 144 - Cleanup - activate failure does not throw
  ---
  duration_ms: 3.633
  type: 'suite'
  ...
# Subtest: DAGEngine
    # Subtest: should throw if no repository provided
    ok 1 - should throw if no repository provided
      ---
      duration_ms: 7.7186
      ...
    # Subtest: addDependency
        # Subtest: should add a dependency
        ok 1 - should add a dependency
          ---
          duration_ms: 6.9652
          ...
        # Subtest: should reject self-dependency
        ok 2 - should reject self-dependency
          ---
          duration_ms: 1.9553
          ...
        # Subtest: should reject missing fromId
        ok 3 - should reject missing fromId
          ---
          duration_ms: 1.4606
          ...
        # Subtest: should reject missing toId
        ok 4 - should reject missing toId
          ---
          duration_ms: 1.1436
          ...
        # Subtest: should reject if from lifecycle not found
        ok 5 - should reject if from lifecycle not found
          ---
          duration_ms: 1.4483
          ...
        # Subtest: should reject if to lifecycle not found
        ok 6 - should reject if to lifecycle not found
          ---
          duration_ms: 1.6638
          ...
        # Subtest: should silently skip duplicate dependency
        ok 7 - should silently skip duplicate dependency
          ---
          duration_ms: 1.4369
          ...
        # Subtest: should detect direct cycle
        ok 8 - should detect direct cycle
          ---
          duration_ms: 3.0868
          ...
        # Subtest: should detect transitive cycle
        ok 9 - should detect transitive cycle
          ---
          duration_ms: 3.2903
          ...
        # Subtest: should allow diamond dependency (no cycle)
        ok 10 - should allow diamond dependency (no cycle)
          ---
          duration_ms: 2.0546
          ...
        1..10
    ok 2 - addDependency
      ---
      duration_ms: 30.7996
      type: 'suite'
      ...
    # Subtest: removeDependency
        # Subtest: should remove an existing dependency
        ok 1 - should remove an existing dependency
          ---
          duration_ms: 2.0414
          ...
        # Subtest: should return lifecycle unchanged if dep not present
        ok 2 - should return lifecycle unchanged if dep not present
          ---
          duration_ms: 1.0658
          ...
        # Subtest: should return null for missing lifecycle
        ok 3 - should return null for missing lifecycle
          ---
          duration_ms: 0.8328
          ...
        # Subtest: should return null for null args
        ok 4 - should return null for null args
          ---
          duration_ms: 0.859
          ...
        1..4
    ok 3 - removeDependency
      ---
      duration_ms: 5.7399
      type: 'suite'
      ...
    # Subtest: getDependencies
        # Subtest: should return dependency ids
        ok 1 - should return dependency ids
          ---
          duration_ms: 1.9703
          ...
        # Subtest: should return empty for unknown id
        ok 2 - should return empty for unknown id
          ---
          duration_ms: 0.8286
          ...
        # Subtest: should return defensive copy
        ok 3 - should return defensive copy
          ---
          duration_ms: 0.8821
          ...
        1..3
    ok 4 - getDependencies
      ---
      duration_ms: 4.7848
      type: 'suite'
      ...
    # Subtest: getDependents
        # Subtest: should return ids of dependents
        ok 1 - should return ids of dependents
          ---
          duration_ms: 4.3295
          ...
        # Subtest: should return empty if no dependents
        ok 2 - should return empty if no dependents
          ---
          duration_ms: 1.2476
          ...
        # Subtest: should return empty for null
        ok 3 - should return empty for null
          ---
          duration_ms: 1.2962
          ...
        1..3
    ok 5 - getDependents
      ---
      duration_ms: 7.5366
      type: 'suite'
      ...
    # Subtest: topologicalSort
        # Subtest: should return empty for no lifecycles
        ok 1 - should return empty for no lifecycles
          ---
          duration_ms: 1.4851
          ...
        # Subtest: should return single node
        ok 2 - should return single node
          ---
          duration_ms: 1.9693
          ...
        # Subtest: should return valid order for linear chain
        ok 3 - should return valid order for linear chain
          ---
          duration_ms: 1.5982
          ...
        # Subtest: should return valid order for diamond
        ok 4 - should return valid order for diamond
          ---
          duration_ms: 2.3332
          ...
        # Subtest: should handle disconnected components
        ok 5 - should handle disconnected components
          ---
          duration_ms: 2.249
          ...
        # Subtest: should throw on cycle
        ok 6 - should throw on cycle
          ---
          duration_ms: 3.8477
          ...
        # Subtest: should include cycle node names in error
        ok 7 - should include cycle node names in error
          ---
          duration_ms: 1.457
          ...
        1..7
    ok 6 - topologicalSort
      ---
      duration_ms: 16.9895
      type: 'suite'
      ...
    # Subtest: serialize
        # Subtest: should return empty graph for no lifecycles
        ok 1 - should return empty graph for no lifecycles
          ---
          duration_ms: 2.5536
          ...
        # Subtest: should serialize single node at origin
        ok 2 - should serialize single node at origin
          ---
          duration_ms: 1.3396
          ...
        # Subtest: should place dependent in deeper layer
        ok 3 - should place dependent in deeper layer
          ---
          duration_ms: 1.2069
          ...
        # Subtest: should produce correct edges
        ok 4 - should produce correct edges
          ---
          duration_ms: 1.5472
          ...
        # Subtest: should include status on nodes
        ok 5 - should include status on nodes
          ---
          duration_ms: 3.1519
          ...
        # Subtest: should handle diamond layout
        ok 6 - should handle diamond layout
          ---
          duration_ms: 1.9588
          ...
        1..6
    ok 7 - serialize
      ---
      duration_ms: 13.2594
      type: 'suite'
      ...
    1..7
ok 145 - DAGEngine
  ---
  duration_ms: 93.9269
  type: 'suite'
  ...
# Subtest: Event Hooks - _handleStoryStatusChanged
    # Subtest: should do nothing when storyId is missing
    ok 1 - should do nothing when storyId is missing
      ---
      duration_ms: 77.8677
      ...
    # Subtest: should do nothing when no lifecycles reference the story (AC4)
    ok 2 - should do nothing when no lifecycles reference the story (AC4)
      ---
      duration_ms: 4.813
      ...
    # Subtest: should update lifecycle to achieved when all mapped stories completed
    ok 3 - should update lifecycle to achieved when all mapped stories completed
      ---
      duration_ms: 3.2168
      ...
    # Subtest: should update lifecycle to in_progress when some stories completed
    ok 4 - should update lifecycle to in_progress when some stories completed
      ---
      duration_ms: 2.2753
      ...
    # Subtest: should not update lifecycle if status unchanged
    ok 5 - should not update lifecycle if status unchanged
      ---
      duration_ms: 1.4778
      ...
    # Subtest: should update multiple lifecycles sharing the same story
    ok 6 - should update multiple lifecycles sharing the same story
      ---
      duration_ms: 2.3712
      ...
    # Subtest: should update cache with new story status
    ok 7 - should update cache with new story status
      ---
      duration_ms: 1.4071
      ...
    # Subtest: should handle event data at top level (no .data wrapper)
    ok 8 - should handle event data at top level (no .data wrapper)
      ---
      duration_ms: 2.2003
      ...
    # Subtest: should not throw on repository errors
    ok 9 - should not throw on repository errors
      ---
      duration_ms: 3.1464
      ...
    1..9
ok 146 - Event Hooks - _handleStoryStatusChanged
  ---
  duration_ms: 108.2201
  type: 'suite'
  ...
# Subtest: Event Hooks - _getStoryStatusesForLifecycle
    # Subtest: should return cached statuses for mapped stories
    ok 1 - should return cached statuses for mapped stories
      ---
      duration_ms: 4.532
      ...
    # Subtest: should default to not_started for uncached stories
    ok 2 - should default to not_started for uncached stories
      ---
      duration_ms: 0.8263
      ...
    # Subtest: should return empty array for lifecycle with no mappings
    ok 3 - should return empty array for lifecycle with no mappings
      ---
      duration_ms: 0.8574
      ...
    1..3
ok 147 - Event Hooks - _getStoryStatusesForLifecycle
  ---
  duration_ms: 7.4669
  type: 'suite'
  ...
# Subtest: Event Hooks - plugin lifecycle
    # Subtest: should subscribe to story:status-changed on activate
    ok 1 - should subscribe to story:status-changed on activate
      ---
      duration_ms: 2.166
      ...
    # Subtest: should clear cache and unsubscribe on deactivate
    ok 2 - should clear cache and unsubscribe on deactivate
      ---
      duration_ms: 1.9213
      ...
    1..2
ok 148 - Event Hooks - plugin lifecycle
  ---
  duration_ms: 5.2334
  type: 'suite'
  ...
# Subtest: IPC Handlers - Registration
    # Subtest: should register all expected channels
    not ok 1 - should register all expected channels
      ---
      duration_ms: 33.3814
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\outcome-lifecycle\\ipc-handlers.test.js:60:3'
      failureType: 'testCodeFailure'
      error: |-
        Expected values to be strictly equal:
        
        15 !== 12
        
      code: 'ERR_ASSERTION'
      name: 'AssertionError'
      expected: 12
      actual: 15
      operator: 'strictEqual'
      stack: |-
        TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\plugins\outcome-lifecycle\ipc-handlers.test.js:76:12)
        Test.runInAsyncScope (node:async_hooks:206:9)
        Test.run (node:internal/test_runner/test:796:25)
        Test.start (node:internal/test_runner/test:702:17)
        node:internal/test_runner/test:1133:71
        node:internal/per_context/primordials:482:82
        new Promise (<anonymous>)
        new SafePromise (node:internal/per_context/primordials:450:29)
        node:internal/per_context/primordials:482:9
        Array.map (<anonymous>)
      ...
    1..1
not ok 149 - IPC Handlers - Registration
  ---
  duration_ms: 39.6517
  type: 'suite'
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\outcome-lifecycle\\ipc-handlers.test.js:59:1'
  failureType: 'subtestsFailed'
  error: '1 subtest failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: IPC Handlers - createLifecycle
    # Subtest: should create a lifecycle with title and description
    ok 1 - should create a lifecycle with title and description
      ---
      duration_ms: 7.1482
      ...
    # Subtest: should throw when title is missing
    ok 2 - should throw when title is missing
      ---
      duration_ms: 3.1354
      ...
    # Subtest: should throw when title is empty string
    ok 3 - should throw when title is empty string
      ---
      duration_ms: 1.423
      ...
    1..3
ok 150 - IPC Handlers - createLifecycle
  ---
  duration_ms: 12.6944
  type: 'suite'
  ...
# Subtest: IPC Handlers - getLifecycle
    # Subtest: should return a lifecycle by id
    ok 1 - should return a lifecycle by id
      ---
      duration_ms: 5.0277
      ...
    # Subtest: should throw when id not found
    ok 2 - should throw when id not found
      ---
      duration_ms: 1.0547
      ...
    # Subtest: should throw when id is missing
    ok 3 - should throw when id is missing
      ---
      duration_ms: 1.406
      ...
    1..3
ok 151 - IPC Handlers - getLifecycle
  ---
  duration_ms: 9.4107
  type: 'suite'
  ...
# Subtest: IPC Handlers - updateLifecycle
    # Subtest: should update lifecycle fields
    ok 1 - should update lifecycle fields
      ---
      duration_ms: 1.9357
      ...
    # Subtest: should throw when fields is missing
    ok 2 - should throw when fields is missing
      ---
      duration_ms: 1.0812
      ...
    # Subtest: should throw when lifecycle not found
    ok 3 - should throw when lifecycle not found
      ---
      duration_ms: 1.2046
      ...
    1..3
ok 152 - IPC Handlers - updateLifecycle
  ---
  duration_ms: 5.5449
  type: 'suite'
  ...
# Subtest: IPC Handlers - deleteLifecycle
    # Subtest: should delete and return { deleted: true }
    ok 1 - should delete and return { deleted: true }
      ---
      duration_ms: 1.8539
      ...
    # Subtest: should return { deleted: false } for missing lifecycle
    ok 2 - should return { deleted: false } for missing lifecycle
      ---
      duration_ms: 0.7351
      ...
    1..2
ok 153 - IPC Handlers - deleteLifecycle
  ---
  duration_ms: 3.0388
  type: 'suite'
  ...
# Subtest: IPC Handlers - listLifecycles
    # Subtest: should return all lifecycles
    ok 1 - should return all lifecycles
      ---
      duration_ms: 1.3338
      ...
    # Subtest: should filter by status
    ok 2 - should filter by status
      ---
      duration_ms: 1.0523
      ...
    1..2
ok 154 - IPC Handlers - listLifecycles
  ---
  duration_ms: 3.0641
  type: 'suite'
  ...
# Subtest: IPC Handlers - mapStory / unmapStory
    # Subtest: should map a story to a lifecycle
    ok 1 - should map a story to a lifecycle
      ---
      duration_ms: 2.0963
      ...
    # Subtest: should unmap a story
    ok 2 - should unmap a story
      ---
      duration_ms: 2.2513
      ...
    # Subtest: should throw when lifecycleId missing
    ok 3 - should throw when lifecycleId missing
      ---
      duration_ms: 1.0527
      ...
    # Subtest: should throw when lifecycle not found
    ok 4 - should throw when lifecycle not found
      ---
      duration_ms: 1.5941
      ...
    1..4
ok 155 - IPC Handlers - mapStory / unmapStory
  ---
  duration_ms: 7.8772
  type: 'suite'
  ...
# Subtest: IPC Handlers - getStoriesForLifecycle / getLifecyclesForStory
    # Subtest: should return story IDs for a lifecycle
    ok 1 - should return story IDs for a lifecycle
      ---
      duration_ms: 4.7512
      ...
    # Subtest: should return lifecycles for a story
    ok 2 - should return lifecycles for a story
      ---
      duration_ms: 1.6656
      ...
    1..2
ok 156 - IPC Handlers - getStoriesForLifecycle / getLifecyclesForStory
  ---
  duration_ms: 6.9811
  type: 'suite'
  ...
# Subtest: IPC Handlers - DAG operations
    # Subtest: should add a dependency
    ok 1 - should add a dependency
      ---
      duration_ms: 3.978
      ...
    # Subtest: should remove a dependency
    ok 2 - should remove a dependency
      ---
      duration_ms: 2.3241
      ...
    # Subtest: should throw when fromId missing
    ok 3 - should throw when fromId missing
      ---
      duration_ms: 1.4891
      ...
    # Subtest: should return serialized DAG
    ok 4 - should return serialized DAG
      ---
      duration_ms: 2.3986
      ...
    1..4
ok 157 - IPC Handlers - DAG operations
  ---
  duration_ms: 11.1021
  type: 'suite'
  ...
# Subtest: LifecycleRepository
    # Subtest: constructor
        # Subtest: should throw if storage is not provided
        ok 1 - should throw if storage is not provided
          ---
          duration_ms: 9.4938
          ...
        1..1
    ok 1 - constructor
      ---
      duration_ms: 13.9205
      type: 'suite'
      ...
    # Subtest: create
        # Subtest: should create a lifecycle with title and description
        ok 1 - should create a lifecycle with title and description
          ---
          duration_ms: 11.5882
          ...
        # Subtest: should create a lifecycle with title only
        ok 2 - should create a lifecycle with title only
          ---
          duration_ms: 3.2742
          ...
        # Subtest: should trim whitespace from title and description
        ok 3 - should trim whitespace from title and description
          ---
          duration_ms: 2.3097
          ...
        # Subtest: should persist the created lifecycle
        ok 4 - should persist the created lifecycle
          ---
          duration_ms: 5.3234
          ...
        # Subtest: should generate unique IDs
        ok 5 - should generate unique IDs
          ---
          duration_ms: 3.6148
          ...
        # Subtest: should throw if title is missing
        ok 6 - should throw if title is missing
          ---
          duration_ms: 3.8294
          ...
        # Subtest: should throw if title is whitespace-only
        ok 7 - should throw if title is whitespace-only
          ---
          duration_ms: 1.3303
          ...
        # Subtest: should handle non-string description gracefully
        ok 8 - should handle non-string description gracefully
          ---
          duration_ms: 1.9352
          ...
        1..8
    ok 2 - create
      ---
      duration_ms: 40.4185
      type: 'suite'
      ...
    # Subtest: get
        # Subtest: should retrieve a lifecycle by ID
        ok 1 - should retrieve a lifecycle by ID
          ---
          duration_ms: 3.0116
          ...
        # Subtest: should return null for non-existent ID
        ok 2 - should return null for non-existent ID
          ---
          duration_ms: 1.485
          ...
        # Subtest: should return null for null/undefined ID
        ok 3 - should return null for null/undefined ID
          ---
          duration_ms: 1.495
          ...
        1..3
    ok 3 - get
      ---
      duration_ms: 6.8986
      type: 'suite'
      ...
    # Subtest: update
        # Subtest: should update title
        ok 1 - should update title
          ---
          duration_ms: 3.0062
          ...
        # Subtest: should update description
        ok 2 - should update description
          ---
          duration_ms: 2.4401
          ...
        # Subtest: should update status
        ok 3 - should update status
          ---
          duration_ms: 2.3704
          ...
        # Subtest: should update multiple fields at once
        ok 4 - should update multiple fields at once
          ---
          duration_ms: 2.5381
          ...
        # Subtest: should set updatedAt timestamp
        ok 5 - should set updatedAt timestamp
          ---
          duration_ms: 1.9693
          ...
        # Subtest: should trim string values
        ok 6 - should trim string values
          ---
          duration_ms: 2.3533
          ...
        # Subtest: should ignore fields not in UPDATABLE_FIELDS
        ok 7 - should ignore fields not in UPDATABLE_FIELDS
          ---
          duration_ms: 2.4396
          ...
        # Subtest: should return null for non-existent ID
        ok 8 - should return null for non-existent ID
          ---
          duration_ms: 1.1578
          ...
        # Subtest: should return null for null/invalid args
        ok 9 - should return null for null/invalid args
          ---
          duration_ms: 1.2613
          ...
        # Subtest: should throw for invalid status
        ok 10 - should throw for invalid status
          ---
          duration_ms: 1.6202
          ...
        # Subtest: should throw if title is set to empty
        ok 11 - should throw if title is set to empty
          ---
          duration_ms: 2.4878
          ...
        1..11
    ok 4 - update
      ---
      duration_ms: 30.2305
      type: 'suite'
      ...
    # Subtest: delete
        # Subtest: should delete a lifecycle
        ok 1 - should delete a lifecycle
          ---
          duration_ms: 3.6087
          ...
        # Subtest: should return false for non-existent ID
        ok 2 - should return false for non-existent ID
          ---
          duration_ms: 0.9338
          ...
        # Subtest: should return false for null ID
        ok 3 - should return false for null ID
          ---
          duration_ms: 1.3968
          ...
        # Subtest: should remove deleted ID from other lifecycles dependencies
        ok 4 - should remove deleted ID from other lifecycles dependencies
          ---
          duration_ms: 1.6815
          ...
        # Subtest: should not affect unrelated lifecycles
        ok 5 - should not affect unrelated lifecycles
          ---
          duration_ms: 2.7821
          ...
        1..5
    ok 5 - delete
      ---
      duration_ms: 11.6669
      type: 'suite'
      ...
    # Subtest: list
        # Subtest: should return all lifecycles when no filters
        ok 1 - should return all lifecycles when no filters
          ---
          duration_ms: 4.8831
          ...
        # Subtest: should return empty array when no lifecycles exist
        ok 2 - should return empty array when no lifecycles exist
          ---
          duration_ms: 1.1764
          ...
        # Subtest: should filter by status
        ok 3 - should filter by status
          ---
          duration_ms: 2.2798
          ...
        # Subtest: should search in title and description
        ok 4 - should search in title and description
          ---
          duration_ms: 2.2541
          ...
        # Subtest: should search case-insensitively
        ok 5 - should search case-insensitively
          ---
          duration_ms: 1.207
          ...
        # Subtest: should sort by createdAt descending by default
        ok 6 - should sort by createdAt descending by default
          ---
          duration_ms: 1.8144
          ...
        # Subtest: should sort ascending when specified
        ok 7 - should sort ascending when specified
          ---
          duration_ms: 1.2588
          ...
        # Subtest: should sort by title
        ok 8 - should sort by title
          ---
          duration_ms: 1.595
          ...
        # Subtest: should combine status filter and search
        ok 9 - should combine status filter and search
          ---
          duration_ms: 3.4948
          ...
        1..9
    ok 6 - list
      ---
      duration_ms: 22.2399
      type: 'suite'
      ...
    # Subtest: VALID_STATUSES
        # Subtest: should contain expected values
        ok 1 - should contain expected values
          ---
          duration_ms: 1.6482
          ...
        1..1
    ok 7 - VALID_STATUSES
      ---
      duration_ms: 2.0921
      type: 'suite'
      ...
    1..7
ok 158 - LifecycleRepository
  ---
  duration_ms: 133.9714
  type: 'suite'
  ...
# Subtest: outcome-parser
    # Subtest: extractOutcome
        # Subtest: should extract outcome from standard user story format
        ok 1 - should extract outcome from standard user story format
          ---
          duration_ms: 10.4737
          ...
        # Subtest: should extract outcome from story with line breaks
        ok 2 - should extract outcome from story with line breaks
          ---
          duration_ms: 4.6394
          ...
        # Subtest: should extract multiline outcome text
        ok 3 - should extract multiline outcome text
          ---
          duration_ms: 0.7848
          ...
        # Subtest: should handle uppercase "So that"
        ok 4 - should handle uppercase "So that"
          ---
          duration_ms: 0.6721
          ...
        # Subtest: should handle all-uppercase "SO THAT"
        ok 5 - should handle all-uppercase "SO THAT"
          ---
          duration_ms: 0.6661
          ...
        # Subtest: should handle mixed case "So That"
        ok 6 - should handle mixed case "So That"
          ---
          duration_ms: 0.7251
          ...
        # Subtest: should handle extra whitespace between "so" and "that"
        ok 7 - should handle extra whitespace between "so" and "that"
          ---
          duration_ms: 0.7601
          ...
        # Subtest: should trim leading/trailing whitespace from outcome
        ok 8 - should trim leading/trailing whitespace from outcome
          ---
          duration_ms: 0.7
          ...
        # Subtest: should return null when no "so that" clause exists
        ok 9 - should return null when no "so that" clause exists
          ---
          duration_ms: 1.2855
          ...
        # Subtest: should return null for empty string
        ok 10 - should return null for empty string
          ---
          duration_ms: 0.9768
          ...
        # Subtest: should return null for null input
        ok 11 - should return null for null input
          ---
          duration_ms: 0.6549
          ...
        # Subtest: should return null for undefined input
        ok 12 - should return null for undefined input
          ---
          duration_ms: 0.8422
          ...
        # Subtest: should return null for non-string input
        ok 13 - should return null for non-string input
          ---
          duration_ms: 0.7018
          ...
        # Subtest: should return null when "so that" is followed by only whitespace
        ok 14 - should return null when "so that" is followed by only whitespace
          ---
          duration_ms: 0.9463
          ...
        # Subtest: should match first "so that" occurrence
        ok 15 - should match first "so that" occurrence
          ---
          duration_ms: 0.7486
          ...
        # Subtest: should handle "so that" at start of string
        ok 16 - should handle "so that" at start of string
          ---
          duration_ms: 0.6277
          ...
        # Subtest: should not match partial words like "also that"
        ok 17 - should not match partial words like "also that"
          ---
          duration_ms: 0.5812
          ...
        # Subtest: should handle story with only "so that" and nothing else
        ok 18 - should handle story with only "so that" and nothing else
          ---
          duration_ms: 1.0588
          ...
        1..18
    ok 1 - extractOutcome
      ---
      duration_ms: 35.0836
      type: 'suite'
      ...
    1..1
ok 159 - outcome-parser
  ---
  duration_ms: 39.4364
  type: 'suite'
  ...
# node:internal/modules/esm/resolve:283
#     throw new ERR_MODULE_NOT_FOUND(
#           ^
# Error [ERR_MODULE_NOT_FOUND]: Cannot find module 'C:\\Users\\jjdub\\code\\plugins\\outcome-lifecycle-plugin\\renderer\\components\\dag-renderer.js' imported from C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\outcome-lifecycle\\renderer.test.mjs
#     at finalizeResolution (node:internal/modules/esm/resolve:283:11)
#     at moduleResolve (node:internal/modules/esm/resolve:952:10)
#     at defaultResolve (node:internal/modules/esm/resolve:1188:11)
#     at ModuleLoader.defaultResolve (node:internal/modules/esm/loader:708:12)
#     at \#cachedDefaultResolve (node:internal/modules/esm/loader:657:25)
#     at ModuleLoader.resolve (node:internal/modules/esm/loader:640:38)
#     at ModuleLoader.getModuleJobForImport (node:internal/modules/esm/loader:264:38)
#     at ModuleLoader.import (node:internal/modules/esm/loader:605:34)
#     at defaultImportModuleDynamicallyForModule (node:internal/modules/esm/utils:221:31)
#     at importModuleDynamicallyCallback (node:internal/modules/esm/utils:260:12) {
#   code: 'ERR_MODULE_NOT_FOUND',
#   url: 'file:///C:/Users/jjdub/code/plugins/outcome-lifecycle-plugin/renderer/components/dag-renderer.js'
# }
# Node.js v20.19.6
# Subtest: C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\outcome-lifecycle\\renderer.test.mjs
not ok 41 - C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\outcome-lifecycle\\renderer.test.mjs
  ---
  duration_ms: 904.5234
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\outcome-lifecycle\\renderer.test.mjs:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: computeStatus
    # Subtest: should return not_started for empty array
    ok 1 - should return not_started for empty array
      ---
      duration_ms: 5.7172
      ...
    # Subtest: should return not_started for null
    ok 2 - should return not_started for null
      ---
      duration_ms: 1.2073
      ...
    # Subtest: should return not_started for undefined
    ok 3 - should return not_started for undefined
      ---
      duration_ms: 1.3259
      ...
    # Subtest: should return not_started for non-array
    ok 4 - should return not_started for non-array
      ---
      duration_ms: 1.0747
      ...
    # Subtest: should return not_started when no stories are completed
    ok 5 - should return not_started when no stories are completed
      ---
      duration_ms: 4.2989
      ...
    # Subtest: should return not_started for single non-completed story
    ok 6 - should return not_started for single non-completed story
      ---
      duration_ms: 0.9843
      ...
    # Subtest: should return not_started for mixed non-completed statuses
    ok 7 - should return not_started for mixed non-completed statuses
      ---
      duration_ms: 1.178
      ...
    # Subtest: should return achieved when all stories are completed
    ok 8 - should return achieved when all stories are completed
      ---
      duration_ms: 0.7067
      ...
    # Subtest: should return achieved for single completed story
    ok 9 - should return achieved for single completed story
      ---
      duration_ms: 1.8461
      ...
    # Subtest: should return achieved for many completed stories
    ok 10 - should return achieved for many completed stories
      ---
      duration_ms: 1.458
      ...
    # Subtest: should return in_progress when some stories are completed
    ok 11 - should return in_progress when some stories are completed
      ---
      duration_ms: 0.9328
      ...
    # Subtest: should return in_progress for one completed among many
    ok 12 - should return in_progress for one completed among many
      ---
      duration_ms: 0.7912
      ...
    # Subtest: should return in_progress for most completed but not all
    ok 13 - should return in_progress for most completed but not all
      ---
      duration_ms: 1.5272
      ...
    1..13
ok 161 - computeStatus
  ---
  duration_ms: 32.3237
  type: 'suite'
  ...
# Subtest: COMPLETED_STATUS
    # Subtest: should equal "completed"
    ok 1 - should equal "completed"
      ---
      duration_ms: 1.8181
      ...
    1..1
ok 162 - COMPLETED_STATUS
  ---
  duration_ms: 2.535
  type: 'suite'
  ...
# Subtest: Story Mapping
    # Subtest: mapStory
        # Subtest: should map a story to a lifecycle
        ok 1 - should map a story to a lifecycle
          ---
          duration_ms: 17.127
          ...
        # Subtest: should map multiple stories to a lifecycle
        ok 2 - should map multiple stories to a lifecycle
          ---
          duration_ms: 2.0422
          ...
        # Subtest: should prevent duplicate mappings
        ok 3 - should prevent duplicate mappings
          ---
          duration_ms: 1.2627
          ...
        # Subtest: should update updatedAt timestamp
        ok 4 - should update updatedAt timestamp
          ---
          duration_ms: 2.1489
          ...
        # Subtest: should persist the mapping
        ok 5 - should persist the mapping
          ---
          duration_ms: 5.598
          ...
        # Subtest: should return null for non-existent lifecycle
        ok 6 - should return null for non-existent lifecycle
          ---
          duration_ms: 2.2392
          ...
        # Subtest: should return null for null lifecycleId
        ok 7 - should return null for null lifecycleId
          ---
          duration_ms: 1.2321
          ...
        # Subtest: should throw for missing storyId
        ok 8 - should throw for missing storyId
          ---
          duration_ms: 3.4414
          ...
        1..8
    ok 1 - mapStory
      ---
      duration_ms: 41.1996
      type: 'suite'
      ...
    # Subtest: unmapStory
        # Subtest: should remove a story mapping
        ok 1 - should remove a story mapping
          ---
          duration_ms: 3.1164
          ...
        # Subtest: should persist the removal
        ok 2 - should persist the removal
          ---
          duration_ms: 2.8103
          ...
        # Subtest: should return lifecycle unchanged if story not mapped
        ok 3 - should return lifecycle unchanged if story not mapped
          ---
          duration_ms: 2.4372
          ...
        # Subtest: should return null for non-existent lifecycle
        ok 4 - should return null for non-existent lifecycle
          ---
          duration_ms: 1.1894
          ...
        # Subtest: should return null for null arguments
        ok 5 - should return null for null arguments
          ---
          duration_ms: 1.5016
          ...
        1..5
    ok 2 - unmapStory
      ---
      duration_ms: 12.7577
      type: 'suite'
      ...
    # Subtest: getStoriesForLifecycle
        # Subtest: should return mapped story IDs
        ok 1 - should return mapped story IDs
          ---
          duration_ms: 3.7938
          ...
        # Subtest: should return empty array for lifecycle with no mappings
        ok 2 - should return empty array for lifecycle with no mappings
          ---
          duration_ms: 1.7513
          ...
        # Subtest: should return empty array for non-existent lifecycle
        ok 3 - should return empty array for non-existent lifecycle
          ---
          duration_ms: 1.0898
          ...
        # Subtest: should return empty array for null id
        ok 4 - should return empty array for null id
          ---
          duration_ms: 1.2229
          ...
        # Subtest: should return a copy, not the original array
        ok 5 - should return a copy, not the original array
          ---
          duration_ms: 2.1277
          ...
        1..5
    ok 3 - getStoriesForLifecycle
      ---
      duration_ms: 11.5065
      type: 'suite'
      ...
    # Subtest: getLifecyclesForStory
        # Subtest: should return all lifecycles containing a story
        ok 1 - should return all lifecycles containing a story
          ---
          duration_ms: 7.0009
          ...
        # Subtest: should return empty array if story is not mapped anywhere
        ok 2 - should return empty array if story is not mapped anywhere
          ---
          duration_ms: 1.5598
          ...
        # Subtest: should return empty array for null storyId
        ok 3 - should return empty array for null storyId
          ---
          duration_ms: 0.8866
          ...
        # Subtest: should not include lifecycles after unmapping
        ok 4 - should not include lifecycles after unmapping
          ---
          duration_ms: 2.0194
          ...
        1..4
    ok 4 - getLifecyclesForStory
      ---
      duration_ms: 13.0559
      type: 'suite'
      ...
    # Subtest: delete lifecycle clears mappings
        # Subtest: should remove lifecycle and its mappings from getLifecyclesForStory
        ok 1 - should remove lifecycle and its mappings from getLifecyclesForStory
          ---
          duration_ms: 2.7802
          ...
        1..1
    ok 5 - delete lifecycle clears mappings
      ---
      duration_ms: 3.479
      type: 'suite'
      ...
    1..5
ok 163 - Story Mapping
  ---
  duration_ms: 88.2045
  type: 'suite'
  ...
# Already initialized
# Subtest: PluginComponentLoader
    # Subtest: initialization
        # Subtest: should initialize with empty state
        ok 1 - should initialize with empty state
          ---
          duration_ms: 6.9001
          ...
        # Subtest: should prevent double initialization
        ok 2 - should prevent double initialization
          ---
          duration_ms: 5.6154
          ...
        1..2
    ok 1 - initialization
      ---
      duration_ms: 15.8647
      type: 'suite'
      ...
    # Subtest: buildEntryUrl
        # Subtest: should build file:// URL for Unix paths
        ok 1 - should build file:// URL for Unix paths
          ---
          duration_ms: 2.4949
          ...
        # Subtest: should build file:// URL for Windows paths
        ok 2 - should build file:// URL for Windows paths
          ---
          duration_ms: 1.5499
          ...
        # Subtest: should handle mixed path separators
        ok 3 - should handle mixed path separators
          ---
          duration_ms: 1.4501
          ...
        1..3
    ok 2 - buildEntryUrl
      ---
      duration_ms: 6.6553
      type: 'suite'
      ...
    # Subtest: loadPluginComponents
        # Subtest: should skip plugins without renderer config
        ok 1 - should skip plugins without renderer config
          ---
          duration_ms: 4.3116
          ...
        # Subtest: should track loading state to prevent duplicate loads
        ok 2 - should track loading state to prevent duplicate loads
          ---
          duration_ms: 1.9517
          ...
        # Subtest: should return true for already loaded plugins
        ok 3 - should return true for already loaded plugins
          ---
          duration_ms: 1.5572
          ...
        # Subtest: should record errors when loading fails
        ok 4 - should record errors when loading fails
          ---
          duration_ms: 4.6077
          ...
        1..4
    ok 3 - loadPluginComponents
      ---
      duration_ms: 14.0679
      type: 'suite'
      ...
    # Subtest: unloadPluginComponents
        # Subtest: should unregister all components from a plugin
        ok 1 - should unregister all components from a plugin
          ---
          duration_ms: 4.1401
          ...
        # Subtest: should handle unloading non-existent plugins gracefully
        ok 2 - should handle unloading non-existent plugins gracefully
          ---
          duration_ms: 1.4654
          ...
        # Subtest: should clear load errors when unloading
        ok 3 - should clear load errors when unloading
          ---
          duration_ms: 1.2639
          ...
        1..3
    ok 4 - unloadPluginComponents
      ---
      duration_ms: 7.7495
      type: 'suite'
      ...
    # Subtest: query methods
        # Subtest: should check if plugin is loaded
        ok 1 - should check if plugin is loaded
          ---
          duration_ms: 1.9486
          ...
        # Subtest: should check if plugin is loading
        ok 2 - should check if plugin is loading
          ---
          duration_ms: 1.303
          ...
        # Subtest: should get load error for plugin
        ok 3 - should get load error for plugin
          ---
          duration_ms: 1.5823
          ...
        # Subtest: should get list of loaded plugins
        ok 4 - should get list of loaded plugins
          ---
          duration_ms: 0.9648
          ...
        # Subtest: should get component names for a plugin
        ok 5 - should get component names for a plugin
          ---
          duration_ms: 1.5847
          ...
        # Subtest: should return empty array for unknown plugin components
        ok 6 - should return empty array for unknown plugin components
          ---
          duration_ms: 1.7999
          ...
        1..6
    ok 5 - query methods
      ---
      duration_ms: 10.9724
      type: 'suite'
      ...
    # Subtest: getSummary
        # Subtest: should return comprehensive summary
        ok 1 - should return comprehensive summary
          ---
          duration_ms: 2.8477
          ...
        1..1
    ok 6 - getSummary
      ---
      duration_ms: 3.5822
      type: 'suite'
      ...
    # Subtest: reloadPlugin
        # Subtest: should unload and reload a plugin
        ok 1 - should unload and reload a plugin
          ---
          duration_ms: 1.8134
          ...
        1..1
    ok 7 - reloadPlugin
      ---
      duration_ms: 2.6717
      type: 'suite'
      ...
    # Subtest: destroy
        # Subtest: should unload all plugins and cleanup
        ok 1 - should unload all plugins and cleanup
          ---
          duration_ms: 2.8245
          ...
        1..1
    ok 8 - destroy
      ---
      duration_ms: 3.2447
      type: 'suite'
      ...
    1..8
ok 164 - PluginComponentLoader
  ---
  duration_ms: 75.1269
  type: 'suite'
  ...
# C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\plugin-context.test.js:10
# describe('PluginContext', () => {
# ^
# ReferenceError: describe is not defined
#     at Object.<anonymous> (C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\plugin-context.test.js:10:1)
#     at Module._compile (node:internal/modules/cjs/loader:1521:14)
#     at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
#     at Module.load (node:internal/modules/cjs/loader:1266:32)
#     at Module._load (node:internal/modules/cjs/loader:1091:12)
#     at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
#     at node:internal/main/run_main_module:28:49
# Node.js v20.19.6
# Subtest: C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\plugin-context.test.js
not ok 45 - C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\plugin-context.test.js
  ---
  duration_ms: 736.4075
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\plugin-context.test.js:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: PluginLifecycleManager
    # Subtest: callActivate
        # Subtest: should call onActivate hook on component
        ok 1 - should call onActivate hook on component
          ---
          duration_ms: 8.9707
          ...
        # Subtest: should pass context to onActivate hook
        ok 2 - should pass context to onActivate hook
          ---
          duration_ms: 4.039
          ...
        # Subtest: should handle async onActivate hooks
        ok 3 - should handle async onActivate hooks
          ---
          duration_ms: 37.1617
          ...
        # Subtest: should return true if component has no onActivate
        ok 4 - should return true if component has no onActivate
          ---
          duration_ms: 2.1099
          ...
        # Subtest: should track view as active after activation
        ok 5 - should track view as active after activation
          ---
          duration_ms: 2.1833
          ...
        # Subtest: should not call onActivate twice for already active view
        ok 6 - should not call onActivate twice for already active view
          ---
          duration_ms: 4.4121
          ...
        1..6
    ok 1 - callActivate
      ---
      duration_ms: 67.117
      type: 'suite'
      ...
    # Subtest: callDeactivate
        # Subtest: should call onDeactivate hook on component
        ok 1 - should call onDeactivate hook on component
          ---
          duration_ms: 3.4255
          ...
        # Subtest: should track view as inactive after deactivation
        ok 2 - should track view as inactive after deactivation
          ---
          duration_ms: 2.6203
          ...
        # Subtest: should not call onDeactivate for already inactive view
        ok 3 - should not call onDeactivate for already inactive view
          ---
          duration_ms: 3.1066
          ...
        1..3
    ok 2 - callDeactivate
      ---
      duration_ms: 10.9764
      type: 'suite'
      ...
    # Subtest: callDestroy
        # Subtest: should call onDestroy hook on component
        ok 1 - should call onDestroy hook on component
          ---
          duration_ms: 2.6491
          ...
        # Subtest: should call onDeactivate before onDestroy if view is active
        ok 2 - should call onDeactivate before onDestroy if view is active
          ---
          duration_ms: 6.1985
          ...
        # Subtest: should clean up view state after destroy
        ok 3 - should clean up view state after destroy
          ---
          duration_ms: 4.2888
          ...
        1..3
    ok 3 - callDestroy
      ---
      duration_ms: 14.0418
      type: 'suite'
      ...
    # Subtest: error handling
        # Subtest: should catch and log errors in onActivate
        ok 1 - should catch and log errors in onActivate
          ---
          duration_ms: 7.8189
          ...
        # Subtest: should catch and log errors in async hooks
        ok 2 - should catch and log errors in async hooks
          ---
          duration_ms: 43.4189
          ...
        # Subtest: should continue execution after errors
        ok 3 - should continue execution after errors
          ---
          duration_ms: 3.9275
          ...
        # Subtest: should limit error log size
        ok 4 - should limit error log size
          ---
          duration_ms: 2.632
          ...
        1..4
    ok 4 - error handling
      ---
      duration_ms: 59.1834
      type: 'suite'
      ...
    # Subtest: timeout handling
        # Subtest: should timeout slow async hooks
        ok 1 - should timeout slow async hooks
          ---
          duration_ms: 59.1434
          ...
        1..1
    ok 5 - timeout handling
      ---
      duration_ms: 59.9657
      type: 'suite'
      ...
    # Subtest: state queries
        # Subtest: should return active views
        ok 1 - should return active views
          ---
          duration_ms: 2.3346
          ...
        # Subtest: should track last activated time
        ok 2 - should track last activated time
          ---
          duration_ms: 2.1153
          ...
        # Subtest: should get errors filtered by viewId
        ok 3 - should get errors filtered by viewId
          ---
          duration_ms: 1.7189
          ...
        # Subtest: should clear errors
        ok 4 - should clear errors
          ---
          duration_ms: 1.0431
          ...
        1..4
    ok 6 - state queries
      ---
      duration_ms: 8.132
      type: 'suite'
      ...
    # Subtest: destroy
        # Subtest: should clear all state on destroy
        ok 1 - should clear all state on destroy
          ---
          duration_ms: 1.799
          ...
        1..1
    ok 7 - destroy
      ---
      duration_ms: 2.1621
      type: 'suite'
      ...
    1..7
ok 166 - PluginLifecycleManager
  ---
  duration_ms: 227.789
  type: 'suite'
  ...
# Subtest: PluginLoader
    # Subtest: Plugin class
        # Subtest: should create a plugin from manifest
        ok 1 - should create a plugin from manifest
          ---
          duration_ms: 6.6026
          ...
        # Subtest: should serialize to JSON
        ok 2 - should serialize to JSON
          ---
          duration_ms: 1.5299
          ...
        # Subtest: should track lifecycle state transitions
        ok 3 - should track lifecycle state transitions
          ---
          duration_ms: 4.97
          ...
        # Subtest: should record activation errors
        ok 4 - should record activation errors
          ---
          duration_ms: 1.3072
          ...
        # Subtest: should check if plugin can be activated
        ok 5 - should check if plugin can be activated
          ---
          duration_ms: 1.2876
          ...
        1..5
    ok 1 - Plugin class
      ---
      duration_ms: 19.5591
      type: 'suite'
      ...
    # Subtest: PluginLoader initialization
        # Subtest: should create with default plugins directory
        ok 1 - should create with default plugins directory
          ---
          duration_ms: 269.2923
          ...
        # Subtest: should create with custom plugins directory
        ok 2 - should create with custom plugins directory
          ---
          duration_ms: 141.4207
          ...
        # Subtest: should start with no plugins
        ok 3 - should start with no plugins
          ---
          duration_ms: 152.0956
          ...
        1..3
    ok 2 - PluginLoader initialization
      ---
      duration_ms: 564.6569
      type: 'suite'
      ...
    # Subtest: Plugin discovery
        # Subtest: should discover plugins with valid manifests
        ok 1 - should discover plugins with valid manifests
          ---
          duration_ms: 181.7462
          ...
        # Subtest: should skip directories without manifest
        ok 2 - should skip directories without manifest
          ---
          duration_ms: 150.3267
          ...
        # Subtest: should skip files (non-directories)
        ok 3 - should skip files (non-directories)
          ---
          duration_ms: 103.371
          ...
        # Subtest: should emit plugin:discovered event
        ok 4 - should emit plugin:discovered event
          ---
          duration_ms: 86.2508
          ...
        1..4
    ok 3 - Plugin discovery
      ---
      duration_ms: 523.5217
      type: 'suite'
      ...
    # Subtest: Dependency resolution
        # Subtest: should order plugins with no dependencies
        ok 1 - should order plugins with no dependencies
          ---
          duration_ms: 71.1654
          ...
        # Subtest: should order plugins respecting dependencies
        ok 2 - should order plugins respecting dependencies
          ---
          duration_ms: 72.4111
          ...
        # Subtest: should detect circular dependencies
        ok 3 - should detect circular dependencies
          ---
          duration_ms: 58.8678
          ...
        # Subtest: should detect missing dependencies
        ok 4 - should detect missing dependencies
          ---
          duration_ms: 74.8882
          ...
        1..4
    ok 4 - Dependency resolution
      ---
      duration_ms: 278.6248
      type: 'suite'
      ...
# [PluginLoader] Loaded 1 plugin(s), 0 failed
    # Subtest: Plugin loading
        # Subtest: should load a valid plugin
        ok 1 - should load a valid plugin
          ---
          duration_ms: 118.8062
          ...
# [PluginLoader] Failed to load plugin "no-activate": Plugin must export an activate() function
# [PluginLoader] Loaded 0 plugin(s), 1 failed
        # Subtest: should fail plugins without activate function
        ok 2 - should fail plugins without activate function
          ---
          duration_ms: 73.7872
          ...
# [PluginLoader] Loaded 0 plugin(s), 0 failed
        # Subtest: should emit plugins:complete event
        ok 3 - should emit plugins:complete event
          ---
          duration_ms: 49.9624
          ...
        1..3
    ok 5 - Plugin loading
      ---
      duration_ms: 243.5298
      type: 'suite'
      ...
# [PluginLoader] Loaded 1 plugin(s), 0 failed
    # Subtest: getSummary
        # Subtest: should return correct summary
        ok 1 - should return correct summary
          ---
          duration_ms: 63.3087
          ...
        1..1
    ok 6 - getSummary
      ---
      duration_ms: 63.7444
      type: 'suite'
      ...
    1..6
ok 167 - PluginLoader
  ---
  duration_ms: 2029.6238
  type: 'suite'
  ...
# [PluginLoader] Loaded 1 plugin(s), 0 failed
# Subtest: EventEmitter behavior
    # Subtest: should emit all lifecycle events in order
    ok 1 - should emit all lifecycle events in order
      ---
      duration_ms: 68.9025
      ...
    1..1
ok 168 - EventEmitter behavior
  ---
  duration_ms: 69.8285
  type: 'suite'
  ...
# [PluginLoader] Error reading C:\\Users\\jjdub\\AppData\\Local\\Temp\\puffin-validation-test-1770318769361\\missing-fields\\puffin-plugin.json: The "path" argument must be of type string. Received undefined
# [PluginLoader] Loaded 0 plugin(s), 0 failed
# Subtest: Manifest Validation Error Handling
    # Subtest: should reject plugin with missing required fields
    not ok 1 - should reject plugin with missing required fields
      ---
      duration_ms: 68.265
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\plugin-loader.test.js:533:3'
      failureType: 'testCodeFailure'
      error: |-
        Expected values to be strictly equal:
        
        0 !== 1
        
      code: 'ERR_ASSERTION'
      name: 'AssertionError'
      expected: 1
      actual: 0
      operator: 'strictEqual'
      stack: |-
        TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\plugins\plugin-loader.test.js:553:12)
        async Test.run (node:internal/test_runner/test:797:9)
        async Promise.all (index 0)
        async Suite.run (node:internal/test_runner/test:1135:7)
        async Test.processPendingSubtests (node:internal/test_runner/test:526:7)
      ...
# [PluginLoader] Manifest validation failed for "Invalid-Name":
# [PluginLoader] Loaded 0 plugin(s), 1 failed
#   ✗ Invalid format for "name": "Invalid-Name" does not match required pattern
#     Field: name
#     Got: "Invalid-Name"
#     Suggestion: Use lowercase letters, numbers, and hyphens. Must start with a letter (e.g., "my-plugin")
    # Subtest: should reject plugin with invalid name format
    ok 2 - should reject plugin with invalid name format
      ---
      duration_ms: 61.2035
      ...
# [PluginLoader] Manifest validation failed for "bad-version":
# [PluginLoader] Loaded 0 plugin(s), 1 failed
#   ✗ Invalid format for "version": "not-semver" does not match required pattern
#     Field: version
#     Got: "not-semver"
#     Suggestion: Use semantic versioning format: MAJOR.MINOR.PATCH (e.g., "1.0.0", "2.1.0-beta.1")
    # Subtest: should reject plugin with invalid version format
    ok 3 - should reject plugin with invalid version format
      ---
      duration_ms: 61.6029
      ...
# [PluginLoader] Manifest validation failed for "missing-main":
# [PluginLoader] Loaded 0 plugin(s), 1 failed
#   ✗ Entry point not found: nonexistent.js
#     Field: main
#     Got: "nonexistent.js"
#     Suggestion: Create the file "nonexistent.js" or update the "main" field
    # Subtest: should reject plugin with missing entry point file
    ok 4 - should reject plugin with missing entry point file
      ---
      duration_ms: 57.5072
      ...
# [PluginLoader] Manifest validation failed for "validation-errors-test":
#   ✗ Invalid format for "version": "bad" does not match required pattern
#     Field: version
#     Got: "bad"
#     Suggestion: Use semantic versioning format: MAJOR.MINOR.PATCH (e.g., "1.0.0", "2.1.0-beta.1")
# [PluginLoader] Loaded 0 plugin(s), 1 failed
    # Subtest: should include validationErrors in plugin object
    ok 5 - should include validationErrors in plugin object
      ---
      duration_ms: 52.5336
      ...
# [PluginLoader] Manifest validation failed for "get-errors-test":
#   ✗ Invalid format for "version": "1.0" does not match required pattern
#     Field: version
#     Got: "1.0"
#     Suggestion: Use semantic versioning format: MAJOR.MINOR.PATCH (e.g., "1.0.0", "2.1.0-beta.1")
# [PluginLoader] Loaded 0 plugin(s), 1 failed
    # Subtest: should include validationErrors in getErrors() result
    not ok 6 - should include validationErrors in getErrors() result
      ---
      duration_ms: 52.9894
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\plugin-loader.test.js:692:3'
      failureType: 'testCodeFailure'
      error: |-
        Expected values to be strictly equal:
        
        0 !== 1
        
      code: 'ERR_ASSERTION'
      name: 'AssertionError'
      expected: 1
      actual: 0
      operator: 'strictEqual'
      stack: |-
        TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\plugins\plugin-loader.test.js:710:12)
        async Test.run (node:internal/test_runner/test:797:9)
        async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
      ...
# [PluginLoader] Manifest validation failed for "wrong-type":
#   ✗ Invalid type for "description": expected string, got number
#     Field: description
#     Got: 12345
#     Suggestion: Change "description" to be a string
# [PluginLoader] Loaded 0 plugin(s), 1 failed
    # Subtest: should reject plugin with invalid type for field
    ok 7 - should reject plugin with invalid type for field
      ---
      duration_ms: 49.2416
      ...
# [PluginLoader] Loaded 1 plugin(s), 0 failed
    # Subtest: should allow valid plugins to proceed without issues
    not ok 8 - should allow valid plugins to proceed without issues
      ---
      duration_ms: 45.9875
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\plugin-loader.test.js:746:3'
      failureType: 'testCodeFailure'
      error: |-
        Expected values to be strictly equal:
        + actual - expected
        
        + 'loaded'
        - 'validated'
      code: 'ERR_ASSERTION'
      name: 'AssertionError'
      expected: 'validated'
      actual: 'loaded'
      operator: 'strictEqual'
      stack: |-
        TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\plugins\plugin-loader.test.js:780:12)
        async Test.run (node:internal/test_runner/test:797:9)
        async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
      ...
    1..8
not ok 169 - Manifest Validation Error Handling
  ---
  duration_ms: 457.0446
  type: 'suite'
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\plugin-loader.test.js:507:1'
  failureType: 'subtestsFailed'
  error: '3 subtests failed'
  code: 'ERR_TEST_FAILURE'
  ...
# C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\plugin-manager.test.js:55
# describe('PluginManager', () => {
# ^
# ReferenceError: describe is not defined
#     at Object.<anonymous> (C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\plugin-manager.test.js:55:1)
#     at Module._compile (node:internal/modules/cjs/loader:1521:14)
#     at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
#     at Module.load (node:internal/modules/cjs/loader:1266:32)
#     at Module._load (node:internal/modules/cjs/loader:1091:12)
#     at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
#     at node:internal/main/run_main_module:28:49
# Node.js v20.19.6
# Subtest: C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\plugin-manager.test.js
not ok 48 - C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\plugin-manager.test.js
  ---
  duration_ms: 1876.1077
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\plugin-manager.test.js:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\plugin-registry.test.js:9
# describe('PluginRegistry', () => {
# ^
# ReferenceError: describe is not defined
#     at Object.<anonymous> (C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\plugin-registry.test.js:9:1)
#     at Module._compile (node:internal/modules/cjs/loader:1521:14)
#     at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
#     at Module.load (node:internal/modules/cjs/loader:1266:32)
#     at Module._load (node:internal/modules/cjs/loader:1091:12)
#     at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
#     at node:internal/main/run_main_module:28:49
# Node.js v20.19.6
# Subtest: C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\plugin-registry.test.js
not ok 49 - C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\plugin-registry.test.js
  ---
  duration_ms: 924.5186
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\plugin-registry.test.js:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\plugin-state-store.test.js:12
# describe('PluginStateStore', () => {
# ^
# ReferenceError: describe is not defined
#     at Object.<anonymous> (C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\plugin-state-store.test.js:12:1)
#     at Module._compile (node:internal/modules/cjs/loader:1521:14)
#     at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
#     at Module.load (node:internal/modules/cjs/loader:1266:32)
#     at Module._load (node:internal/modules/cjs/loader:1091:12)
#     at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
#     at node:internal/main/run_main_module:28:49
# Node.js v20.19.6
# Subtest: C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\plugin-state-store.test.js
not ok 50 - C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\plugin-state-store.test.js
  ---
  duration_ms: 1769.1719
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\plugin-state-store.test.js:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-chunk-strategy.test.js:16
# describe('RLM Chunk Strategy', () => {
# ^
# ReferenceError: describe is not defined
#     at Object.<anonymous> (C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-chunk-strategy.test.js:16:1)
#     at Module._compile (node:internal/modules/cjs/loader:1521:14)
#     at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
#     at Module.load (node:internal/modules/cjs/loader:1266:32)
#     at Module._load (node:internal/modules/cjs/loader:1091:12)
#     at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
#     at node:internal/main/run_main_module:28:49
# Node.js v20.19.6
# Subtest: C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-chunk-strategy.test.js
not ok 51 - C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-chunk-strategy.test.js
  ---
  duration_ms: 1710.9502
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-chunk-strategy.test.js:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-exporters.test.js:15
# describe('RLM Exporters', () => {
# ^
# ReferenceError: describe is not defined
#     at Object.<anonymous> (C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-exporters.test.js:15:1)
#     at Module._compile (node:internal/modules/cjs/loader:1521:14)
#     at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
#     at Module.load (node:internal/modules/cjs/loader:1266:32)
#     at Module._load (node:internal/modules/cjs/loader:1091:12)
#     at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
#     at node:internal/main/run_main_module:28:49
# Node.js v20.19.6
# Subtest: C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-exporters.test.js
not ok 52 - C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-exporters.test.js
  ---
  duration_ms: 1664.9525
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-exporters.test.js:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-plugin-integration.test.js:18
# describe('RLM Plugin - Full Integration', () => {
# ^
# ReferenceError: describe is not defined
#     at Object.<anonymous> (C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-plugin-integration.test.js:18:1)
#     at Module._compile (node:internal/modules/cjs/loader:1521:14)
#     at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
#     at Module.load (node:internal/modules/cjs/loader:1266:32)
#     at Module._load (node:internal/modules/cjs/loader:1091:12)
#     at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
#     at node:internal/main/run_main_module:28:49
# Node.js v20.19.6
# Subtest: C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-plugin-integration.test.js
not ok 53 - C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-plugin-integration.test.js
  ---
  duration_ms: 1614.7547
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-plugin-integration.test.js:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-repl-integration.test.js:18
# describe('RLM REPL Integration', () => {
# ^
# ReferenceError: describe is not defined
#     at Object.<anonymous> (C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-repl-integration.test.js:18:1)
#     at Module._compile (node:internal/modules/cjs/loader:1521:14)
#     at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
#     at Module.load (node:internal/modules/cjs/loader:1266:32)
#     at Module._load (node:internal/modules/cjs/loader:1091:12)
#     at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
#     at node:internal/main/run_main_module:28:49
# Node.js v20.19.6
# Subtest: C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-repl-integration.test.js
not ok 54 - C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-repl-integration.test.js
  ---
  duration_ms: 1549.4708
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-repl-integration.test.js:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-schemas.test.js:27
# describe('RLM Schemas', () => {
# ^
# ReferenceError: describe is not defined
#     at Object.<anonymous> (C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-schemas.test.js:27:1)
#     at Module._compile (node:internal/modules/cjs/loader:1521:14)
#     at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
#     at Module.load (node:internal/modules/cjs/loader:1266:32)
#     at Module._load (node:internal/modules/cjs/loader:1091:12)
#     at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
#     at node:internal/main/run_main_module:28:49
# Node.js v20.19.6
# Subtest: C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-schemas.test.js
not ok 55 - C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-schemas.test.js
  ---
  duration_ms: 1488.404
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-schemas.test.js:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-semaphore.test.js:10
# describe('RLM Semaphore', () => {
# ^
# ReferenceError: describe is not defined
#     at Object.<anonymous> (C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-semaphore.test.js:10:1)
#     at Module._compile (node:internal/modules/cjs/loader:1521:14)
#     at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
#     at Module.load (node:internal/modules/cjs/loader:1266:32)
#     at Module._load (node:internal/modules/cjs/loader:1091:12)
#     at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
#     at node:internal/main/run_main_module:28:49
# Node.js v20.19.6
# Subtest: C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-semaphore.test.js
not ok 56 - C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-semaphore.test.js
  ---
  duration_ms: 1413.4696
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-semaphore.test.js:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-session-store.test.js:18
# describe('RLM SessionStore', () => {
# ^
# ReferenceError: describe is not defined
#     at Object.<anonymous> (C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-session-store.test.js:18:1)
#     at Module._compile (node:internal/modules/cjs/loader:1521:14)
#     at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
#     at Module.load (node:internal/modules/cjs/loader:1266:32)
#     at Module._load (node:internal/modules/cjs/loader:1091:12)
#     at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
#     at node:internal/main/run_main_module:28:49
# Node.js v20.19.6
# Subtest: C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-session-store.test.js
not ok 57 - C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-session-store.test.js
  ---
  duration_ms: 1367.7897
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-session-store.test.js:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-validators.test.js:26
# describe('RLM Validators', () => {
# ^
# ReferenceError: describe is not defined
#     at Object.<anonymous> (C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-validators.test.js:26:1)
#     at Module._compile (node:internal/modules/cjs/loader:1521:14)
#     at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
#     at Module.load (node:internal/modules/cjs/loader:1266:32)
#     at Module._load (node:internal/modules/cjs/loader:1091:12)
#     at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
#     at node:internal/main/run_main_module:28:49
# Node.js v20.19.6
# Subtest: C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-validators.test.js
not ok 58 - C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-validators.test.js
  ---
  duration_ms: 1317.2887
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\plugins\\rlm-validators.test.js:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# [HistoryService] Invalid branch name provided
# [HistoryService] Invalid branch name provided
# [HistoryService] Invalid branch name provided
# [HistoryService] Error getting branches: Database error
# Subtest: HistoryService
    # Subtest: constructor
        # Subtest: should create instance with getPuffinState function
        ok 1 - should create instance with getPuffinState function
          ---
          duration_ms: 4.5385
          ...
        # Subtest: should create instance without options
        ok 2 - should create instance without options
          ---
          duration_ms: 0.9444
          ...
        1..2
    ok 1 - constructor
      ---
      duration_ms: 8.413
      type: 'suite'
      ...
    # Subtest: setPuffinStateGetter
        # Subtest: should allow setting getter after construction
        ok 1 - should allow setting getter after construction
          ---
          duration_ms: 0.8665
          ...
        1..1
    ok 2 - setPuffinStateGetter
      ---
      duration_ms: 1.2957
      type: 'suite'
      ...
    # Subtest: isAvailable
        # Subtest: should return true when puffinState has history
        ok 1 - should return true when puffinState has history
          ---
          duration_ms: 0.9443
          ...
        # Subtest: should return false when getter returns null
        ok 2 - should return false when getter returns null
          ---
          duration_ms: 2.3157
          ...
        # Subtest: should return false when history is null
        ok 3 - should return false when history is null
          ---
          duration_ms: 1.7332
          ...
        # Subtest: should return false when no getter is set
        ok 4 - should return false when no getter is set
          ---
          duration_ms: 4.6015
          ...
        1..4
    ok 3 - isAvailable
      ---
      duration_ms: 11.8232
      type: 'suite'
      ...
    # Subtest: getBranches
        # Subtest: should return all branches with summary information
        ok 1 - should return all branches with summary information
          ---
          duration_ms: 2.933
          ...
        # Subtest: should return branch with zero prompts
        ok 2 - should return branch with zero prompts
          ---
          duration_ms: 1.4878
          ...
        # Subtest: should return empty array when history unavailable
        ok 3 - should return empty array when history unavailable
          ---
          duration_ms: 3.6464
          ...
        # Subtest: should handle missing branches gracefully
        ok 4 - should handle missing branches gracefully
          ---
          duration_ms: 1.0468
          ...
        1..4
    ok 4 - getBranches
      ---
      duration_ms: 10.529
      type: 'suite'
      ...
    # Subtest: getPrompts
        # Subtest: should return prompts for a specific branch
        ok 1 - should return prompts for a specific branch
          ---
          duration_ms: 1.9711
          ...
        # Subtest: should return prompts with response data
        ok 2 - should return prompts with response data
          ---
          duration_ms: 1.1821
          ...
        # Subtest: should return empty array for empty branch
        ok 3 - should return empty array for empty branch
          ---
          duration_ms: 0.9895
          ...
        # Subtest: should return empty array for non-existent branch
        ok 4 - should return empty array for non-existent branch
          ---
          duration_ms: 0.9435
          ...
        # Subtest: should return empty array for invalid branch name
        ok 5 - should return empty array for invalid branch name
          ---
          duration_ms: 6.6878
          ...
        # Subtest: should return empty array when history unavailable
        ok 6 - should return empty array when history unavailable
          ---
          duration_ms: 0.9914
          ...
        1..6
    ok 5 - getPrompts
      ---
      duration_ms: 14.3044
      type: 'suite'
      ...
    # Subtest: getAllPrompts
        # Subtest: should return all prompts across all branches
        ok 1 - should return all prompts across all branches
          ---
          duration_ms: 1.8154
          ...
        # Subtest: should include branchId in each prompt
        ok 2 - should include branchId in each prompt
          ---
          duration_ms: 1.0328
          ...
        # Subtest: should sort prompts by timestamp (most recent first)
        ok 3 - should sort prompts by timestamp (most recent first)
          ---
          duration_ms: 1.261
          ...
        # Subtest: should return empty array when history unavailable
        ok 4 - should return empty array when history unavailable
          ---
          duration_ms: 1.04
          ...
        1..4
    ok 6 - getAllPrompts
      ---
      duration_ms: 5.7449
      type: 'suite'
      ...
    # Subtest: getStatistics
        # Subtest: should return aggregated statistics
        ok 1 - should return aggregated statistics
          ---
          duration_ms: 1.6384
          ...
        # Subtest: should return zero statistics when history unavailable
        ok 2 - should return zero statistics when history unavailable
          ---
          duration_ms: 0.8991
          ...
        1..2
    ok 7 - getStatistics
      ---
      duration_ms: 3.1198
      type: 'suite'
      ...
    # Subtest: data transformation
        # Subtest: should transform ISO date strings to Date objects
        ok 1 - should transform ISO date strings to Date objects
          ---
          duration_ms: 2.613
          ...
        # Subtest: should handle missing response gracefully
        ok 2 - should handle missing response gracefully
          ---
          duration_ms: 1.3529
          ...
        # Subtest: should handle missing optional fields
        ok 3 - should handle missing optional fields
          ---
          duration_ms: 0.7821
          ...
        1..3
    ok 8 - data transformation
      ---
      duration_ms: 5.5865
      type: 'suite'
      ...
    # Subtest: error handling
        # Subtest: should handle errors when getting branches
        ok 1 - should handle errors when getting branches
          ---
          duration_ms: 2.1991
          ...
        1..1
    ok 9 - error handling
      ---
      duration_ms: 2.6384
      type: 'suite'
      ...
    1..9
ok 181 - HistoryService
  ---
  duration_ms: 70.6582
  type: 'suite'
  ...
# Subtest: StatsPlugin
    # Subtest: activate
        # Subtest: should acquire history service from context
        ok 1 - should acquire history service from context
          ---
          duration_ms: 8.0623
          ...
        # Subtest: should handle missing history service gracefully
        ok 2 - should handle missing history service gracefully
          ---
          duration_ms: 1.9581
          ...
        1..2
    ok 1 - activate
      ---
      duration_ms: 14.4843
      type: 'suite'
      ...
    # Subtest: getWeeklyStats
        # Subtest: should return real data when history service is available
        ok 1 - should return real data when history service is available
          ---
          duration_ms: 63.0756
          ...
        # Subtest: should aggregate correct totals from history
        ok 2 - should aggregate correct totals from history
          ---
          duration_ms: 3.9121
          ...
        # Subtest: should fall back to mock data when history unavailable
        ok 3 - should fall back to mock data when history unavailable
          ---
          duration_ms: 3.1284
          ...
        1..3
    ok 2 - getWeeklyStats
      ---
      duration_ms: 72.2117
      type: 'suite'
      ...
    # Subtest: getStats
        # Subtest: should return weekly stats, totals, and branch stats
        ok 1 - should return weekly stats, totals, and branch stats
          ---
          duration_ms: 6.1709
          ...
        # Subtest: should include correct totals
        ok 2 - should include correct totals
          ---
          duration_ms: 6.5643
          ...
        # Subtest: should include per-branch cost/turns/duration
        ok 3 - should include per-branch cost/turns/duration
          ---
          duration_ms: 2.9775
          ...
        1..3
    ok 3 - getStats
      ---
      duration_ms: 18.5704
      type: 'suite'
      ...
    # Subtest: computeTotals
        # Subtest: should sum weekly stats correctly
        ok 1 - should sum weekly stats correctly
          ---
          duration_ms: 2.2778
          ...
        # Subtest: should handle empty array
        ok 2 - should handle empty array
          ---
          duration_ms: 2.1736
          ...
        1..2
    ok 4 - computeTotals
      ---
      duration_ms: 5.3602
      type: 'suite'
      ...
    # Subtest: prompts without stats fields
        # Subtest: should handle prompts with missing cost/turns/duration
        ok 1 - should handle prompts with missing cost/turns/duration
          ---
          duration_ms: 3.3144
          ...
        # Subtest: should handle prompts without response
        ok 2 - should handle prompts without response
          ---
          duration_ms: 3.4521
          ...
        1..2
    ok 5 - prompts without stats fields
      ---
      duration_ms: 7.5821
      type: 'suite'
      ...
    # Subtest: isAvailable edge cases
        # Subtest: should handle undefined history (not just null)
        ok 1 - should handle undefined history (not just null)
          ---
          duration_ms: 1.7595
          ...
        # Subtest: should handle puffinState being undefined
        ok 2 - should handle puffinState being undefined
          ---
          duration_ms: 2.2184
          ...
        1..2
    ok 6 - isAvailable edge cases
      ---
      duration_ms: 4.7183
      type: 'suite'
      ...
    1..6
ok 182 - StatsPlugin
  ---
  duration_ms: 131.584
  type: 'suite'
  ...
# [ViewRegistry] Registered view "my-plugin:my-view" at location "sidebar"
# [ViewRegistry] Registered view "my-plugin:my-view" at location "sidebar"
# [ViewRegistry] Registered view "my-plugin:my-view" at location "sidebar"
# [ViewRegistry] Registered view "my-plugin:my-view" at location "sidebar"
# [ViewRegistry] Registered view "view-a" at location "sidebar"
# [ViewRegistry] Registered view "view-b" at location "panel"
# [ViewRegistry] Registered view "my-plugin:existing-view" at location "sidebar"
# [ViewRegistry] Registered view "my-plugin:new-view" at location "sidebar"
# [ViewRegistry] Registered view "my-plugin:my-view" at location "sidebar"
# [ViewRegistry] Unregistered view "my-plugin:my-view"
# [ViewRegistry] Registered view "my-plugin:my-view" at location "sidebar"
# [ViewRegistry] Unregistered view "my-plugin:my-view"
# [ViewRegistry] Registered view "my-plugin:view-a" at location "sidebar"
# [ViewRegistry] Registered view "my-plugin:view-b" at location "panel"
# [ViewRegistry] Registered view "other-plugin:view-c" at location "sidebar"
# [ViewRegistry] Unregistered 2 views from plugin "my-plugin"
# [ViewRegistry] Registered view "my-plugin:view-a" at location "sidebar"
# [ViewRegistry] Unregistered 1 views from plugin "my-plugin"
# [ViewRegistry] Registered view "plugin-a:view-1" at location "sidebar"
# [ViewRegistry] Registered view "plugin-a:view-2" at location "panel"
# [ViewRegistry] Registered view "plugin-b:view-3" at location "sidebar"
# [ViewRegistry] Registered view "plugin-b:view-4" at location "sidebar"
# [ViewRegistry] Registered view "plugin-a:view-1" at location "sidebar"
# [ViewRegistry] Registered view "plugin-a:view-2" at location "panel"
# [ViewRegistry] Registered view "plugin-b:view-3" at location "sidebar"
# [ViewRegistry] Registered view "plugin-b:view-4" at location "sidebar"
# [ViewRegistry] Registered view "plugin-a:view-1" at location "sidebar"
# [ViewRegistry] Registered view "plugin-a:view-2" at location "panel"
# [ViewRegistry] Registered view "plugin-b:view-3" at location "sidebar"
# [ViewRegistry] Registered view "plugin-b:view-4" at location "sidebar"
# [ViewRegistry] Registered view "my-plugin:sidebar-view" at location "sidebar"
# [ViewRegistry] Registered view "my-plugin:panel-view" at location "panel"
# [ViewRegistry] Registered view "my-plugin:view-a" at location "sidebar"
# [ViewRegistry] Registered view "my-plugin:view-b" at location "panel"
# [ViewRegistry] Registered view "other-plugin:view-c" at location "sidebar"
# [ViewRegistry] Registered view "plugin-a:view-1" at location "sidebar"
# [ViewRegistry] Registered view "plugin-b:view-2" at location "panel"
# [ViewRegistry] Registered view "plugin-a:view-1" at location "sidebar"
# [ViewRegistry] Registered view "plugin-a:view-2" at location "panel"
# [ViewRegistry] Registered view "plugin-b:view-3" at location "sidebar"
# [ViewRegistry] Registered view "plugin-a:view-1" at location "sidebar"
# [ViewRegistry] Registered view "plugin-b:view-2" at location "panel"
# [ViewRegistry] Cleared all registered views
# [ViewRegistry] Registered view "plugin-a:view-1" at location "sidebar"
# [ViewRegistry] Registered view "plugin-b:view-2" at location "panel"
# [ViewRegistry] Cleared all registered views
# Subtest: ViewRegistry
    # Subtest: registerView
        # Subtest: should register a valid view
        ok 1 - should register a valid view
          ---
          duration_ms: 16.3647
          ...
        # Subtest: should reject duplicate view IDs
        ok 2 - should reject duplicate view IDs
          ---
          duration_ms: 4.6416
          ...
        # Subtest: should reject invalid view configurations
        ok 3 - should reject invalid view configurations
          ---
          duration_ms: 1.6777
          ...
        # Subtest: should reject invalid location
        ok 4 - should reject invalid location
          ---
          duration_ms: 2.6427
          ...
        # Subtest: should emit view:registered event
        ok 5 - should emit view:registered event
          ---
          duration_ms: 2.4711
          ...
        # Subtest: should include optional properties
        ok 6 - should include optional properties
          ---
          duration_ms: 3.1449
          ...
        1..6
    ok 1 - registerView
      ---
      duration_ms: 37.1554
      type: 'suite'
      ...
    # Subtest: registerViews
        # Subtest: should register multiple views at once
        ok 1 - should register multiple views at once
          ---
          duration_ms: 7.0955
          ...
        # Subtest: should skip duplicate IDs
        ok 2 - should skip duplicate IDs
          ---
          duration_ms: 2.6886
          ...
        1..2
    ok 2 - registerViews
      ---
      duration_ms: 11.4397
      type: 'suite'
      ...
    # Subtest: unregisterView
        # Subtest: should unregister an existing view
        ok 1 - should unregister an existing view
          ---
          duration_ms: 4.7021
          ...
        # Subtest: should return error for non-existent view
        ok 2 - should return error for non-existent view
          ---
          duration_ms: 1.8526
          ...
        # Subtest: should emit view:unregistered event
        ok 3 - should emit view:unregistered event
          ---
          duration_ms: 2.0925
          ...
        1..3
    ok 3 - unregisterView
      ---
      duration_ms: 10.3936
      type: 'suite'
      ...
    # Subtest: unregisterPluginViews
        # Subtest: should unregister all views from a plugin
        ok 1 - should unregister all views from a plugin
          ---
          duration_ms: 5.602
          ...
        # Subtest: should return empty array for plugin with no views
        ok 2 - should return empty array for plugin with no views
          ---
          duration_ms: 2.2305
          ...
        # Subtest: should emit views:cleared event
        ok 3 - should emit views:cleared event
          ---
          duration_ms: 2.8641
          ...
        1..3
    ok 4 - unregisterPluginViews
      ---
      duration_ms: 11.9249
      type: 'suite'
      ...
    # Subtest: getViewsByLocation
        # Subtest: should return views at specified location
        ok 1 - should return views at specified location
          ---
          duration_ms: 4.3839
          ...
        # Subtest: should sort views by order
        ok 2 - should sort views by order
          ---
          duration_ms: 2.6938
          ...
        # Subtest: should return empty array for location with no views
        ok 3 - should return empty array for location with no views
          ---
          duration_ms: 2.1983
          ...
        1..3
    ok 5 - getViewsByLocation
      ---
      duration_ms: 10.1902
      type: 'suite'
      ...
    # Subtest: getSidebarViews
        # Subtest: should return only sidebar views
        ok 1 - should return only sidebar views
          ---
          duration_ms: 2.4
          ...
        1..1
    ok 6 - getSidebarViews
      ---
      duration_ms: 2.8098
      type: 'suite'
      ...
    # Subtest: getPluginViews
        # Subtest: should return all views from a plugin
        ok 1 - should return all views from a plugin
          ---
          duration_ms: 8.7257
          ...
        # Subtest: should return empty array for plugin with no views
        ok 2 - should return empty array for plugin with no views
          ---
          duration_ms: 1.3117
          ...
        1..2
    ok 7 - getPluginViews
      ---
      duration_ms: 10.7716
      type: 'suite'
      ...
    # Subtest: getAllViews
        # Subtest: should return all registered views
        ok 1 - should return all registered views
          ---
          duration_ms: 1.9754
          ...
        1..1
    ok 8 - getAllViews
      ---
      duration_ms: 5.5535
      type: 'suite'
      ...
    # Subtest: getSummary
        # Subtest: should return correct summary
        ok 1 - should return correct summary
          ---
          duration_ms: 2.8952
          ...
        1..1
    ok 9 - getSummary
      ---
      duration_ms: 4.5375
      type: 'suite'
      ...
    # Subtest: clear
        # Subtest: should remove all views
        ok 1 - should remove all views
          ---
          duration_ms: 2.8366
          ...
        # Subtest: should emit views:cleared for each plugin
        ok 2 - should emit views:cleared for each plugin
          ---
          duration_ms: 1.4152
          ...
        1..2
    ok 10 - clear
      ---
      duration_ms: 5.3075
      type: 'suite'
      ...
    1..10
ok 183 - ViewRegistry
  ---
  duration_ms: 119.7383
  type: 'suite'
  ...
# [ViewRegistry] View ID "my-plugin:my-view" is already registered
# [ViewRegistry] Validation failed for view from my-plugin: [my-plugin] view: Missing required property "location"
# [ViewRegistry] Validation failed for view from my-plugin: [my-plugin] view: Invalid location "invalid-location". Valid locations are: sidebar, panel, statusbar, toolbar, editor, nav
# Subtest: PuffinState
    # Subtest: validateFilename
        # Subtest: should accept valid filenames
        not ok 1 - should accept valid filenames
          ---
          duration_ms: 125.0052
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:44:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:41:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1135:7)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1135:7)
          ...
        # Subtest: should reject filenames with path traversal (..)
        not ok 2 - should reject filenames with path traversal (..)
          ---
          duration_ms: 54.0929
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:56:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:41:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
        # Subtest: should reject filenames with forward slashes
        not ok 3 - should reject filenames with forward slashes
          ---
          duration_ms: 43.7581
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:70:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:41:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
        # Subtest: should reject filenames with backslashes
        not ok 4 - should reject filenames with backslashes
          ---
          duration_ms: 46.6408
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:80:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:41:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
        # Subtest: should reject non-JSON files
        not ok 5 - should reject non-JSON files
          ---
          duration_ms: 37.3963
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:90:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:41:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
        # Subtest: should reject empty or invalid filenames
        not ok 6 - should reject empty or invalid filenames
          ---
          duration_ms: 34.0316
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:104:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:41:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
        1..6
    not ok 1 - validateFilename
      ---
      duration_ms: 347.204
      type: 'suite'
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:38:3'
      failureType: 'subtestsFailed'
      error: '6 subtests failed'
      code: 'ERR_TEST_FAILURE'
      stack: |-
        async Promise.all (index 0)
      ...
    # Subtest: sanitizeFilename
        # Subtest: should convert to lowercase
        not ok 1 - should convert to lowercase
          ---
          duration_ms: 36.7341
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:128:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:125:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1135:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
        # Subtest: should replace invalid characters with underscores
        not ok 2 - should replace invalid characters with underscores
          ---
          duration_ms: 32.119
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:133:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:125:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
        # Subtest: should preserve valid characters
        not ok 3 - should preserve valid characters
          ---
          duration_ms: 36.1243
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:139:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:125:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
        1..3
    not ok 2 - sanitizeFilename
      ---
      duration_ms: 107.4954
      type: 'suite'
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:123:3'
      failureType: 'subtestsFailed'
      error: '3 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: open
        # Subtest: should create .puffin directory if it does not exist
        not ok 1 - should create .puffin directory if it does not exist
          ---
          duration_ms: 34.0369
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:146:5'
          failureType: 'testCodeFailure'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:147:7)
            async Test.run (node:internal/test_runner/test:797:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1135:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
        # Subtest: should create required subdirectories
        not ok 2 - should create required subdirectories
          ---
          duration_ms: 29.7887
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:154:5'
          failureType: 'testCodeFailure'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:155:7)
            async Test.run (node:internal/test_runner/test:797:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
        # Subtest: should initialize default config
        not ok 3 - should initialize default config
          ---
          duration_ms: 26.5369
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:165:5'
          failureType: 'testCodeFailure'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:166:21)
            async Test.run (node:internal/test_runner/test:797:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
        # Subtest: should initialize default history with branches
        not ok 4 - should initialize default history with branches
          ---
          duration_ms: 27.3167
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:174:5'
          failureType: 'testCodeFailure'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:175:21)
            async Test.run (node:internal/test_runner/test:797:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
        1..4
    not ok 3 - open
      ---
      duration_ms: 119.6429
      type: 'suite'
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:145:3'
      failureType: 'subtestsFailed'
      error: '4 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: GUI Definition Operations
        # Subtest: should save and load a GUI definition
        not ok 1 - should save and load a GUI definition
          ---
          duration_ms: 35.3757
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:192:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:189:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1135:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
        # Subtest: should list GUI definitions
        not ok 2 - should list GUI definitions
          ---
          duration_ms: 37.0396
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:207:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:189:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
        # Subtest: should delete a GUI definition
        not ok 3 - should delete a GUI definition
          ---
          duration_ms: 117.3508
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:215:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:189:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
        # Subtest: should reject path traversal in loadGuiDefinition
        not ok 4 - should reject path traversal in loadGuiDefinition
          ---
          duration_ms: 29.914
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:227:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:189:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
        # Subtest: should reject path traversal in deleteGuiDefinition
        not ok 5 - should reject path traversal in deleteGuiDefinition
          ---
          duration_ms: 30.0499
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:233:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:189:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
        # Subtest: should reject path traversal in updateGuiDefinition
        not ok 6 - should reject path traversal in updateGuiDefinition
          ---
          duration_ms: 34.749
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:239:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:189:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
        1..6
    not ok 4 - GUI Definition Operations
      ---
      duration_ms: 287.9983
      type: 'suite'
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:187:3'
      failureType: 'subtestsFailed'
      error: '6 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
    # Subtest: User Stories
        # Subtest: should add a user story
        not ok 1 - should add a user story
          ---
          duration_ms: 29.0174
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:251:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:248:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1135:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
        # Subtest: should update a user story
        not ok 2 - should update a user story
          ---
          duration_ms: 22.8299
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:262:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:248:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
        # Subtest: should delete a user story
        not ok 3 - should delete a user story
          ---
          duration_ms: 20.841
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:274:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:248:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
        1..3
    not ok 5 - User Stories
      ---
      duration_ms: 73.8554
      type: 'suite'
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:246:3'
      failureType: 'subtestsFailed'
      error: '3 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
    # Subtest: Config Operations
        # Subtest: should update config
        not ok 1 - should update config
          ---
          duration_ms: 19.4096
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:293:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:290:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1135:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
        # Subtest: should persist config changes
        not ok 2 - should persist config changes
          ---
          duration_ms: 20.7261
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:302:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:290:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
        1..2
    not ok 6 - Config Operations
      ---
      duration_ms: 41.1584
      type: 'suite'
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:288:3'
      failureType: 'subtestsFailed'
      error: '2 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
    # Subtest: isPuffinProject
        # Subtest: should return true for initialized projects
        not ok 1 - should return true for initialized projects
          ---
          duration_ms: 24.2999
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:314:5'
          failureType: 'testCodeFailure'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:315:7)
            async Test.run (node:internal/test_runner/test:797:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1135:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
        # Subtest: should return false for non-puffin directories
        ok 2 - should return false for non-puffin directories
          ---
          duration_ms: 7.2413
          ...
        1..2
    not ok 7 - isPuffinProject
      ---
      duration_ms: 32.3811
      type: 'suite'
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:313:3'
      failureType: 'subtestsFailed'
      error: '1 subtest failed'
      code: 'ERR_TEST_FAILURE'
      ...
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
    # Subtest: Cache Independence
        # Subtest: should have invalidateCache method
        not ok 1 - should have invalidateCache method
          ---
          duration_ms: 24.3111
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:332:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:329:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1135:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
        # Subtest: should invalidate specific cache types
        not ok 2 - should invalidate specific cache types
          ---
          duration_ms: 21.4
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:336:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:329:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
        # Subtest: should invalidate all caches when no types specified
        not ok 3 - should invalidate all caches when no types specified
          ---
          duration_ms: 19.6375
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:350:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:329:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
        # Subtest: should query SQLite on getUserStories even if cache is null
        not ok 4 - should query SQLite on getUserStories even if cache is null
          ---
          duration_ms: 23.8313
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:364:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:329:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
        # Subtest: should query SQLite on getArchivedStories even if cache is null
        not ok 5 - should query SQLite on getArchivedStories even if cache is null
          ---
          duration_ms: 22.5112
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:382:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:329:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
        # Subtest: should work correctly after cache invalidation on add
        not ok 6 - should work correctly after cache invalidation on add
          ---
          duration_ms: 23.7523
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:398:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:329:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
        # Subtest: should work correctly after cache invalidation on update
        not ok 7 - should work correctly after cache invalidation on update
          ---
          duration_ms: 22.7745
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:414:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:329:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
        # Subtest: should work correctly after cache invalidation on delete
        not ok 8 - should work correctly after cache invalidation on delete
          ---
          duration_ms: 22.1683
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:425:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:329:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
        # Subtest: should populate cache from SQLite reads
        not ok 9 - should populate cache from SQLite reads
          ---
          duration_ms: 28.5346
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:438:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:329:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
        # Subtest: should return empty array on getUserStories with null cache and no SQLite data
        not ok 10 - should return empty array on getUserStories with null cache and no SQLite data
          ---
          duration_ms: 20.4616
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:455:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:329:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
# [DATABASE] Failed to open database: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [DATABASE] Initialization failed: The module '\\\\?\\C:\\Users\\jjdub\\code\\puffin\\node_modules\\better-sqlite3\\build\\Release\\better_sqlite3.node'
# was compiled against a different Node.js version using
# NODE_MODULE_VERSION 130. This version of Node.js requires
# NODE_MODULE_VERSION 115. Please try re-compiling or re-installing
# the module (for instance, using `npm rebuild` or `npm install`).
# [PUFFIN-STATE] SQLite initialization failed: [
#   "The module '\\\\\\\\?\\\\C:\\\\Users\\\\jjdub\\\\code\\\\puffin\\\\node_modules\\\\better-sqlite3\\\\build\\\\Release\\\\better_sqlite3.node'\\n" +
#     'was compiled against a different Node.js version using\\n' +
#     'NODE_MODULE_VERSION 130. This version of Node.js requires\\n' +
#     'NODE_MODULE_VERSION 115. Please try re-compiling or re-installing\\n' +
#     'the module (for instance, using `npm rebuild` or `npm install`).'
# ]
        # Subtest: getState should use SQLite-first accessors
        not ok 11 - getState should use SQLite-first accessors
          ---
          duration_ms: 19.812
          location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:464:5'
          failureType: 'hookFailed'
          error: 'Database not initialized - cannot load user stories'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            PuffinState.loadUserStories (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:2203:13)
            PuffinState.open (C:\Users\jjdub\code\puffin\src\main\puffin-state.js:162:35)
            async TestContext.<anonymous> (C:\Users\jjdub\code\puffin\tests\puffin-state.test.js:329:7)
            async TestHook.run (node:internal/test_runner/test:797:9)
            async Suite.runHook (node:internal/test_runner/test:723:9)
            async Test.run (node:internal/test_runner/test:772:9)
            async Suite.processPendingSubtests (node:internal/test_runner/test:526:7)
          ...
        1..11
    not ok 8 - Cache Independence
      ---
      duration_ms: 252.1145
      type: 'suite'
      location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:327:3'
      failureType: 'subtestsFailed'
      error: '11 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    1..8
not ok 184 - PuffinState
  ---
  duration_ms: 1268.7989
  type: 'suite'
  location: 'C:\\Users\\jjdub\\code\\puffin\\tests\\puffin-state.test.js:19:1'
  failureType: 'subtestsFailed'
  error: '8 subtests failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: SprintService
    # Subtest: Custom Errors
        # Subtest: should create ActiveSprintExistsError with sprint info
        ok 1 - should create ActiveSprintExistsError with sprint info
          ---
          duration_ms: 5.5933
          ...
        # Subtest: should create InvalidStoryIdsError with invalid IDs
        ok 2 - should create InvalidStoryIdsError with invalid IDs
          ---
          duration_ms: 2.7712
          ...
        # Subtest: should create SprintNotFoundError with sprint ID
        ok 3 - should create SprintNotFoundError with sprint ID
          ---
          duration_ms: 0.8928
          ...
        1..3
    ok 1 - Custom Errors
      ---
      duration_ms: 12.7179
      type: 'suite'
      ...
    # Subtest: Service Initialization
        # Subtest: should create service with required dependencies
        ok 1 - should create service with required dependencies
          ---
          duration_ms: 1.07
          ...
        # Subtest: should accept optional callbacks
        ok 2 - should accept optional callbacks
          ---
          duration_ms: 0.9703
          ...
        1..2
    ok 2 - Service Initialization
      ---
      duration_ms: 2.9384
      type: 'suite'
      ...
    # Subtest: checkActiveSprint
        # Subtest: should return hasActive: false when no sprint
        ok 1 - should return hasActive: false when no sprint
          ---
          duration_ms: 1.5283
          ...
        # Subtest: should return hasActive: true with sprint details when active
        ok 2 - should return hasActive: true with sprint details when active
          ---
          duration_ms: 1.3251
          ...
        1..2
    ok 3 - checkActiveSprint
      ---
      duration_ms: 4.5145
      type: 'suite'
      ...
    # Subtest: createSprint
        # Subtest: should throw ActiveSprintExistsError when sprint exists
        ok 1 - should throw ActiveSprintExistsError when sprint exists
          ---
          duration_ms: 3.0635
          ...
        # Subtest: should throw InvalidStoryIdsError for non-existent stories
        ok 2 - should throw InvalidStoryIdsError for non-existent stories
          ---
          duration_ms: 2.3964
          ...
        # Subtest: should create sprint when no active sprint and valid stories
        ok 3 - should create sprint when no active sprint and valid stories
          ---
          duration_ms: 5.7817
          ...
        1..3
    ok 4 - createSprint
      ---
      duration_ms: 12.4251
      type: 'suite'
      ...
    # Subtest: syncStoryStatus
        # Subtest: should throw when no active sprint
        ok 1 - should throw when no active sprint
          ---
          duration_ms: 1.7059
          ...
        # Subtest: should call repository sync and trigger callback
        ok 2 - should call repository sync and trigger callback
          ---
          duration_ms: 0.8697
          ...
        1..2
    ok 5 - syncStoryStatus
      ---
      duration_ms: 3.7303
      type: 'suite'
      ...
    # Subtest: closeAndArchive
        # Subtest: should throw SprintNotFoundError for non-existent sprint
        ok 1 - should throw SprintNotFoundError for non-existent sprint
          ---
          duration_ms: 1.4608
          ...
        # Subtest: should archive sprint with story data
        ok 2 - should archive sprint with story data
          ---
          duration_ms: 1.1556
          ...
        1..2
    ok 6 - closeAndArchive
      ---
      duration_ms: 3.1001
      type: 'suite'
      ...
    # Subtest: Transaction Patterns
        # Subtest: should use immediateTransaction for atomic operations
        ok 1 - should use immediateTransaction for atomic operations
          ---
          duration_ms: 2.21
          ...
        # Subtest: should maintain atomicity - all or nothing
        ok 2 - should maintain atomicity - all or nothing
          ---
          duration_ms: 1.4186
          ...
        1..2
    ok 7 - Transaction Patterns
      ---
      duration_ms: 4.1942
      type: 'suite'
      ...
    # Subtest: Error Handling Patterns
        # Subtest: should propagate repository errors with context
        ok 1 - should propagate repository errors with context
          ---
          duration_ms: 1.263
          ...
        # Subtest: should include original error info in custom errors
        ok 2 - should include original error info in custom errors
          ---
          duration_ms: 2.7212
          ...
        1..2
    ok 8 - Error Handling Patterns
      ---
      duration_ms: 4.6005
      type: 'suite'
      ...
    # Subtest: State Synchronization
        # Subtest: should trigger callbacks for UI updates
        ok 1 - should trigger callbacks for UI updates
          ---
          duration_ms: 1.789
          ...
        # Subtest: should support cache invalidation via callbacks
        ok 2 - should support cache invalidation via callbacks
          ---
          duration_ms: 1.1061
          ...
        1..2
    ok 9 - State Synchronization
      ---
      duration_ms: 3.7072
      type: 'suite'
      ...
    1..9
ok 185 - SprintService
  ---
  duration_ms: 61.5108
  type: 'suite'
  ...
# Subtest: Sprint Close Git Commit Flow
    # Subtest: Commit Execution Logic
        # Subtest: should execute commit only when checkbox is checked
        ok 1 - should execute commit only when checkbox is checked
          ---
          duration_ms: 1.1821
          ...
        # Subtest: should not execute commit when checkbox is unchecked
        ok 2 - should not execute commit when checkbox is unchecked
          ---
          duration_ms: 0.7764
          ...
        # Subtest: should not execute commit when checkbox is disabled
        ok 3 - should not execute commit when checkbox is disabled
          ---
          duration_ms: 0.6152
          ...
        # Subtest: should use user-edited commit message when provided
        ok 4 - should use user-edited commit message when provided
          ---
          duration_ms: 0.692
          ...
        1..4
    ok 1 - Commit Execution Logic
      ---
      duration_ms: 4.6503
      type: 'suite'
      ...
    # Subtest: Commit Result Handling
        # Subtest: should handle successful commit result
        ok 1 - should handle successful commit result
          ---
          duration_ms: 1.4282
          ...
        # Subtest: should handle failed commit result
        ok 2 - should handle failed commit result
          ---
          duration_ms: 1.2022
          ...
        # Subtest: should handle commit error gracefully
        ok 3 - should handle commit error gracefully
          ---
          duration_ms: 0.9023
          ...
        1..3
    ok 2 - Commit Result Handling
      ---
      duration_ms: 4.2355
      type: 'suite'
      ...
    # Subtest: Commit Message Generation
        # Subtest: should generate message with sprint title and story count
        ok 1 - should generate message with sprint title and story count
          ---
          duration_ms: 0.9964
          ...
        # Subtest: should list completed and incomplete stories in body
        ok 2 - should list completed and incomplete stories in body
          ---
          duration_ms: 0.7356
          ...
        1..2
    ok 3 - Commit Message Generation
      ---
      duration_ms: 2.2386
      type: 'suite'
      ...
    # Subtest: Git Stage All Changes
        # Subtest: should stage all changes including untracked files
        ok 1 - should stage all changes including untracked files
          ---
          duration_ms: 1.0632
          ...
        # Subtest: should continue with commit even if staging has warning
        ok 2 - should continue with commit even if staging has warning
          ---
          duration_ms: 0.5633
          ...
        1..2
    ok 4 - Git Stage All Changes
      ---
      duration_ms: 2.1868
      type: 'suite'
      ...
    1..4
ok 186 - Sprint Close Git Commit Flow
  ---
  duration_ms: 18.2018
  type: 'suite'
  ...
# Subtest: TempImageService
    # Subtest: Supported Extensions
        # Subtest: should support PNG format
        ok 1 - should support PNG format
          ---
          duration_ms: 8.5587
          ...
        # Subtest: should support JPG format
        ok 2 - should support JPG format
          ---
          duration_ms: 0.9759
          ...
        # Subtest: should support JPEG format
        ok 3 - should support JPEG format
          ---
          duration_ms: 0.6879
          ...
        # Subtest: should support WebP format
        ok 4 - should support WebP format
          ---
          duration_ms: 0.6691
          ...
        # Subtest: should NOT support GIF format (per clarification)
        ok 5 - should NOT support GIF format (per clarification)
          ---
          duration_ms: 0.7274
          ...
        # Subtest: should have exactly 4 supported formats
        ok 6 - should have exactly 4 supported formats
          ---
          duration_ms: 0.8013
          ...
        1..6
    ok 1 - Supported Extensions
      ---
      duration_ms: 16.4038
      type: 'suite'
      ...
    # Subtest: Service Initialization
        # Subtest: should create service with puffin path
        ok 1 - should create service with puffin path
          ---
          duration_ms: 1.9073
          ...
        # Subtest: should create service without puffin path
        ok 2 - should create service without puffin path
          ---
          duration_ms: 0.716
          ...
        # Subtest: should set puffin path via setPuffinPath
        ok 3 - should set puffin path via setPuffinPath
          ---
          duration_ms: 1.6829
          ...
        1..3
    ok 2 - Service Initialization
      ---
      duration_ms: 6.2593
      type: 'suite'
      ...
    # Subtest: Extension Validation
        # Subtest: should validate PNG extension
        ok 1 - should validate PNG extension
          ---
          duration_ms: 2.1515
          ...
        # Subtest: should validate JPG extension
        ok 2 - should validate JPG extension
          ---
          duration_ms: 0.7193
          ...
        # Subtest: should validate JPEG extension
        ok 3 - should validate JPEG extension
          ---
          duration_ms: 1.2325
          ...
        # Subtest: should validate WebP extension
        ok 4 - should validate WebP extension
          ---
          duration_ms: 0.6634
          ...
        # Subtest: should reject unsupported extensions
        ok 5 - should reject unsupported extensions
          ---
          duration_ms: 0.5867
          ...
        1..5
    ok 3 - Extension Validation
      ---
      duration_ms: 6.3251
      type: 'suite'
      ...
    # Subtest: ID Generation
        # Subtest: should generate unique IDs
        ok 1 - should generate unique IDs
          ---
          duration_ms: 2.2896
          ...
        # Subtest: should generate UUID-format IDs
        ok 2 - should generate UUID-format IDs
          ---
          duration_ms: 1.0667
          ...
        1..2
    ok 4 - ID Generation
      ---
      duration_ms: 3.8027
      type: 'suite'
      ...
    # Subtest: Prompt Formatting
        # Subtest: should format single image path
        ok 1 - should format single image path
          ---
          duration_ms: 0.7141
          ...
        # Subtest: should format multiple image paths
        ok 2 - should format multiple image paths
          ---
          duration_ms: 0.8528
          ...
        # Subtest: should return empty string for empty array
        ok 3 - should return empty string for empty array
          ---
          duration_ms: 0.5074
          ...
        # Subtest: should return empty string for null/undefined
        ok 4 - should return empty string for null/undefined
          ---
          duration_ms: 0.4324
          ...
        1..4
    ok 5 - Prompt Formatting
      ---
      duration_ms: 3.1667
      type: 'suite'
      ...
    # Subtest: Singleton Pattern
        # Subtest: should return same instance from getTempImageService
        ok 1 - should return same instance from getTempImageService
          ---
          duration_ms: 1.0039
          ...
        # Subtest: should update path when called with new path
        ok 2 - should update path when called with new path
          ---
          duration_ms: 0.6433
          ...
        1..2
    ok 6 - Singleton Pattern
      ---
      duration_ms: 2.1936
      type: 'suite'
      ...
    1..6
ok 187 - TempImageService
  ---
  duration_ms: 43.537
  type: 'suite'
  ...
# Subtest: Image Attachment Flow
    # Subtest: Drag and Drop Processing
        # Subtest: should extract extension from filename
        ok 1 - should extract extension from filename
          ---
          duration_ms: 3.4557
          ...
        # Subtest: should validate dropped file types
        ok 2 - should validate dropped file types
          ---
          duration_ms: 0.9521
          ...
        1..2
    ok 1 - Drag and Drop Processing
      ---
      duration_ms: 5.0309
      type: 'suite'
      ...
    # Subtest: Attachment State Management
        # Subtest: should track attached images
        ok 1 - should track attached images
          ---
          duration_ms: 1.0085
          ...
        # Subtest: should remove image by ID
        ok 2 - should remove image by ID
          ---
          duration_ms: 0.7416
          ...
        # Subtest: should clear all attached images
        ok 3 - should clear all attached images
          ---
          duration_ms: 0.5434
          ...
        1..3
    ok 2 - Attachment State Management
      ---
      duration_ms: 3.4747
      type: 'suite'
      ...
    # Subtest: Prompt Integration
        # Subtest: should prepend images to prompt content
        ok 1 - should prepend images to prompt content
          ---
          duration_ms: 1.1154
          ...
        # Subtest: should handle multiple images in prompt
        ok 2 - should handle multiple images in prompt
          ---
          duration_ms: 1.2416
          ...
        # Subtest: should not modify prompt when no images attached
        ok 3 - should not modify prompt when no images attached
          ---
          duration_ms: 0.6517
          ...
        1..3
    ok 3 - Prompt Integration
      ---
      duration_ms: 4.0987
      type: 'suite'
      ...
    # Subtest: Cleanup Flow
        # Subtest: should track pending cleanup paths
        ok 1 - should track pending cleanup paths
          ---
          duration_ms: 1.27
          ...
        # Subtest: should handle cleanup after processing completes
        ok 2 - should handle cleanup after processing completes
          ---
          duration_ms: 1.1618
          ...
        1..2
    ok 4 - Cleanup Flow
      ---
      duration_ms: 3.101
      type: 'suite'
      ...
    1..4
ok 188 - Image Attachment Flow
  ---
  duration_ms: 17.0335
  type: 'suite'
  ...
# Subtest: Thumbnail Generation
    # Subtest: should calculate scaled dimensions for landscape image
    ok 1 - should calculate scaled dimensions for landscape image
      ---
      duration_ms: 0.9845
      ...
    # Subtest: should calculate scaled dimensions for portrait image
    ok 2 - should calculate scaled dimensions for portrait image
      ---
      duration_ms: 0.6172
      ...
    # Subtest: should not scale small images
    ok 3 - should not scale small images
      ---
      duration_ms: 0.7165
      ...
    1..3
ok 189 - Thumbnail Generation
  ---
  duration_ms: 3.6725
  type: 'suite'
  ...
# Subtest: Filename Truncation
    # Subtest: should not truncate short filenames
    ok 1 - should not truncate short filenames
      ---
      duration_ms: 1.0876
      ...
    # Subtest: should truncate long filenames preserving extension
    ok 2 - should truncate long filenames preserving extension
      ---
      duration_ms: 0.9221
      ...
    1..2
ok 190 - Filename Truncation
  ---
  duration_ms: 2.7736
  type: 'suite'
  ...
# [STORY-DERIVATION] Some stories were invalid: [
#   'Story 2: Missing or empty title',
#   'Story 3: Missing or empty title'
# ]
# Subtest: ClaudeService - Story Derivation
    # Subtest: extractStoriesFromResponse
        # Subtest: should parse a clean JSON array
        ok 1 - should parse a clean JSON array
          ---
          duration_ms: 12.9608
          ...
        # Subtest: should parse JSON array with surrounding text
        ok 2 - should parse JSON array with surrounding text
          ---
          duration_ms: 2.5022
          ...
        # Subtest: should parse JSON from markdown code blocks
        ok 3 - should parse JSON from markdown code blocks
          ---
          duration_ms: 1.3503
          ...
        # Subtest: should handle multiple stories
        ok 4 - should handle multiple stories
          ---
          duration_ms: 2.2245
          ...
        # Subtest: should fail on empty response
        ok 5 - should fail on empty response
          ---
          duration_ms: 1.7527
          ...
        # Subtest: should fail on null response
        ok 6 - should fail on null response
          ---
          duration_ms: 2.6634
          ...
        # Subtest: should fail on empty array
        ok 7 - should fail on empty array
          ---
          duration_ms: 2.3228
          ...
        # Subtest: should fail on non-JSON response
        ok 8 - should fail on non-JSON response
          ---
          duration_ms: 2.5814
          ...
        # Subtest: should skip stories without titles
        ok 9 - should skip stories without titles
          ---
          duration_ms: 15.4641
          ...
        # Subtest: should fail if all stories are invalid
        ok 10 - should fail if all stories are invalid
          ---
          duration_ms: 2.0656
          ...
        # Subtest: should normalize story data
        ok 11 - should normalize story data
          ---
          duration_ms: 1.6255
          ...
        # Subtest: should handle missing optional fields
        ok 12 - should handle missing optional fields
          ---
          duration_ms: 4.544
          ...
        # Subtest: should handle nested arrays in acceptance criteria text
        ok 13 - should handle nested arrays in acceptance criteria text
          ---
          duration_ms: 1.4233
          ...
        # Subtest: should handle JSON with escaped characters
        ok 14 - should handle JSON with escaped characters
          ---
          duration_ms: 1.1939
          ...
        1..14
    ok 1 - extractStoriesFromResponse
      ---
      duration_ms: 65.651
      type: 'suite'
      ...
    # Subtest: findJsonArray
        # Subtest: should find array at start of text
        ok 1 - should find array at start of text
          ---
          duration_ms: 1.2766
          ...
        # Subtest: should find array in middle of text
        ok 2 - should find array in middle of text
          ---
          duration_ms: 0.9569
          ...
        # Subtest: should handle nested brackets in strings
        ok 3 - should handle nested brackets in strings
          ---
          duration_ms: 1.6629
          ...
        # Subtest: should return null when no array found
        ok 4 - should return null when no array found
          ---
          duration_ms: 2.0418
          ...
        # Subtest: should handle escaped quotes in strings
        ok 5 - should handle escaped quotes in strings
          ---
          duration_ms: 1.1013
          ...
        # Subtest: should find first complete array when multiple exist
        ok 6 - should find first complete array when multiple exist
          ---
          duration_ms: 0.9739
          ...
        1..6
    ok 2 - findJsonArray
      ---
      duration_ms: 9.8159
      type: 'suite'
      ...
    1..2
ok 191 - ClaudeService - Story Derivation
  ---
  duration_ms: 79.4444
  type: 'suite'
  ...
# Subtest: validators
    # Subtest: validateProject
        # Subtest: should reject null project
        ok 1 - should reject null project
          ---
          duration_ms: 97.9216
          ...
        # Subtest: should require project name
        ok 2 - should require project name
          ---
          duration_ms: 2.296
          ...
        # Subtest: should reject long project names
        ok 3 - should reject long project names
          ---
          duration_ms: 2.3747
          ...
        # Subtest: should require description
        ok 4 - should require description
          ---
          duration_ms: 1.467
          ...
        # Subtest: should accept valid project
        ok 5 - should accept valid project
          ---
          duration_ms: 2.0444
          ...
        # Subtest: should validate assumptions is array
        ok 6 - should validate assumptions is array
          ---
          duration_ms: 2.4108
          ...
        1..6
    ok 1 - validateProject
      ---
      duration_ms: 115.133
      type: 'suite'
      ...
    # Subtest: validatePrompt
        # Subtest: should reject null prompt
        ok 1 - should reject null prompt
          ---
          duration_ms: 2.3647
          ...
        # Subtest: should require content
        ok 2 - should require content
          ---
          duration_ms: 2.0916
          ...
        # Subtest: should require branchId
        ok 3 - should require branchId
          ---
          duration_ms: 2.8103
          ...
        # Subtest: should accept valid prompt
        ok 4 - should accept valid prompt
          ---
          duration_ms: 1.7563
          ...
        1..4
    ok 2 - validatePrompt
      ---
      duration_ms: 10.6895
      type: 'suite'
      ...
    # Subtest: validateGuiElement
        # Subtest: should reject null element
        ok 1 - should reject null element
          ---
          duration_ms: 2.7965
          ...
        # Subtest: should require valid type
        ok 2 - should require valid type
          ---
          duration_ms: 3.1266
          ...
        # Subtest: should accept valid element types
        ok 3 - should accept valid element types
          ---
          duration_ms: 1.8552
          ...
        # Subtest: should require properties object
        ok 4 - should require properties object
          ---
          duration_ms: 1.5745
          ...
        1..4
    ok 3 - validateGuiElement
      ---
      duration_ms: 11.2583
      type: 'suite'
      ...
    # Subtest: validateBranch
        # Subtest: should reject null branch
        ok 1 - should reject null branch
          ---
          duration_ms: 1.976
          ...
        # Subtest: should require id
        ok 2 - should require id
          ---
          duration_ms: 2.3149
          ...
        # Subtest: should require name
        ok 3 - should require name
          ---
          duration_ms: 1.953
          ...
        # Subtest: should accept valid branch
        ok 4 - should accept valid branch
          ---
          duration_ms: 3.5087
          ...
        # Subtest: should validate prompts is array
        ok 5 - should validate prompts is array
          ---
          duration_ms: 1.9905
          ...
        1..5
    ok 4 - validateBranch
      ---
      duration_ms: 14.5102
      type: 'suite'
      ...
    # Subtest: sanitizeString
        # Subtest: should escape HTML entities
        ok 1 - should escape HTML entities
          ---
          duration_ms: 2.6918
          ...
        # Subtest: should handle non-string input
        ok 2 - should handle non-string input
          ---
          duration_ms: 1.7017
          ...
        # Subtest: should preserve safe strings
        ok 3 - should preserve safe strings
          ---
          duration_ms: 0.8176
          ...
        1..3
    ok 5 - sanitizeString
      ---
      duration_ms: 6.1283
      type: 'suite'
      ...
    # Subtest: isValidFilePath
        # Subtest: should reject non-string input
        ok 1 - should reject non-string input
          ---
          duration_ms: 1.1035
          ...
        # Subtest: should reject path traversal attempts
        ok 2 - should reject path traversal attempts
          ---
          duration_ms: 1.0174
          ...
        # Subtest: should accept valid paths
        ok 3 - should accept valid paths
          ---
          duration_ms: 1.412
          ...
        # Subtest: should reject paths with invalid characters
        ok 4 - should reject paths with invalid characters
          ---
          duration_ms: 0.9469
          ...
        1..4
    ok 6 - isValidFilePath
      ---
      duration_ms: 5.12
      type: 'suite'
      ...
    1..6
ok 192 - validators
  ---
  duration_ms: 173.2222
  type: 'suite'
  ...
# (node:33200) [MODULE_TYPELESS_PACKAGE_JSON] Warning: Module type of file:///C:/Users/jjdub/code/puffin/src/shared/validators.js is not specified and it doesn't parse as CommonJS.
# Reparsing as ES module because module syntax was detected. This incurs a performance overhead.
# To eliminate this warning, add "type": "module" to C:\\Users\\jjdub\\code\\puffin\\package.json.
# (Use `node --trace-warnings ...` to show where the warning was created)
1..192
# tests 1304
# suites 387
# pass 1226
# fail 78
# cancelled 0
# skipped 0
# todo 0
# duration_ms 5128.8465
