<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' file: data:">
  <title>Puffin</title>
  <link rel="stylesheet" href="styles/main.css">
  <link rel="stylesheet" href="styles/components.css">
  <link rel="stylesheet" href="styles/themes.css">
  <link rel="stylesheet" href="styles/debugger.css">
  <link rel="stylesheet" href="components/story-generations/story-generations.css">
  <link rel="stylesheet" href="components/git-panel/git-panel.css">
</head>
<body>
  <!-- Toast Notifications Container -->
  <div id="toast-container" class="toast-container"></div>

  <!-- Splash Screen -->
  <div id="splash-screen" class="splash-screen">
    <img src="img/header.jpg" alt="Puffin for Claude Code">
  </div>

  <div id="app">
    <!-- Header -->
    <header id="header">
      <div class="header-left">
        <button id="sidebar-toggle" class="icon-btn" title="Toggle Sidebar">
          <span class="icon">‚ò∞</span>
        </button>
        <h1 id="app-title" class="app-title">Puffin</h1>
      </div>
      <nav id="main-nav">
        <button class="nav-btn" data-view="config">Config</button>
        <button class="nav-btn active" data-view="prompt">Prompt</button>
        <!-- Designer is now provided by designer-plugin -->
        <button class="nav-btn" data-view="user-stories">Backlog</button>
        <button class="nav-btn" data-view="cli-output">CLI Output</button>
        <button class="nav-btn" data-view="git">Git</button>
        <button class="nav-btn hidden" data-view="debug" id="debug-nav-btn">Debug</button>
        <!-- Plugin nav buttons are inserted here dynamically -->
        <div id="plugin-nav-buttons"></div>
      </nav>
      <div class="header-right">
        <div id="git-status-indicator" class="git-indicator hidden" title="Git branch status"></div>
        <span id="save-indicator" class="save-indicator hidden">‚óè</span>
        <button id="debugger-toggle" class="icon-btn" title="SAM Debugger (Ctrl+Shift+D)">
          <span class="icon">üîç</span>
        </button>
      </div>
    </header>

    <!-- Main Content -->
    <main id="main-content">
      <!-- Sidebar -->
      <aside id="sidebar">
        <div class="sidebar-section">
          <h3>Branches</h3>
          <ul id="branch-list" class="branch-list">
            <!-- Branches rendered dynamically -->
          </ul>
          <button id="add-branch-btn" class="add-btn">+ Add Branch</button>
        </div>
        <div class="sidebar-section">
          <div class="sidebar-section-header">
            <h3>Threads</h3>
            <button id="thread-refresh-btn" class="thread-refresh-btn" title="Refresh (process sync inbox)">‚Üª</button>
          </div>
          <div class="thread-search-container">
            <input type="text" id="thread-search-input" class="thread-search-input" placeholder="Search threads...">
            <span class="thread-search-icon">üîç</span>
            <button id="thread-search-clear" class="thread-search-clear" title="Clear search">√ó</button>
          </div>
          <div id="history-tree" class="history-tree">
            <!-- Threads rendered dynamically -->
          </div>
        </div>
        <!-- Plugin Sidebar Views -->
        <div id="plugin-sidebar-views" class="plugin-sidebar-views">
          <!-- Plugin sidebar tabs rendered dynamically -->
        </div>
        <!-- Resizable splitter -->
        <div class="sidebar-resizer" id="sidebar-resizer">
          <div class="resizer-handle"></div>
        </div>
      </aside>

      <!-- View Container -->
      <div id="view-container">
        <!-- Config View (replaces Project Form View) -->
        <section id="config-view" class="view">
          <div class="view-content">
            <div class="view-header-with-actions">
              <h2>Project Configuration</h2>
              <button id="view-claude-config-btn" class="btn secondary small" title="View CLAUDE.md configuration file">
                <span class="btn-icon">üìÑ</span>
                <span class="btn-text">View CLAUDE.md</span>
              </button>
            </div>
            <form id="config-form" class="project-form">
              <div class="form-group">
                <label for="project-name-input">Project Name</label>
                <input type="text" id="project-name-input" placeholder="My Awesome Project" required>
              </div>

              <div class="form-group">
                <label for="project-description">Description</label>
                <textarea id="project-description" rows="4" placeholder="Describe your project..."></textarea>
              </div>

              <div class="form-group">
                <label>Assumptions</label>
                <div id="assumptions-list" class="list-editor">
                  <!-- Assumptions rendered dynamically -->
                </div>
                <button type="button" id="add-assumption-btn" class="add-btn small">+ Add Assumption</button>
              </div>

              <div class="form-group">
                <label for="technical-architecture">Technical Architecture</label>
                <textarea id="technical-architecture" rows="4" placeholder="Describe the technical architecture..."></textarea>
              </div>

              <div class="form-group">
                <label for="data-model">Data Model</label>
                <textarea id="data-model" rows="4" placeholder="Define your data model..."></textarea>
              </div>

              <fieldset class="options-fieldset">
                <legend>Claude Guidance Options</legend>

                <div class="form-group" style="margin-bottom: 1.5rem;">
                  <label for="default-model">Default Model</label>
                  <select id="default-model">
                    <option value="opus">Claude Opus - Most capable, best for complex tasks</option>
                    <option value="sonnet" selected>Claude Sonnet - Balanced performance and speed</option>
                    <option value="haiku">Claude Haiku - Fast and lightweight</option>
                  </select>
                  <small class="form-hint">This model will be used by default. You can override per-thread when submitting.</small>
                </div>

                <div class="options-grid">
                  <div class="form-group">
                    <label for="programming-style">Programming Style</label>
                    <select id="programming-style">
                      <option value="HYBRID">Hybrid Approach</option>
                      <option value="OOP">Object-Oriented (OOP)</option>
                      <option value="FP">Functional (FP)</option>
                      <option value="TEMPORAL">Temporal Logic (TLA+/SAM)</option>
                    </select>
                  </div>

                  <div class="form-group">
                    <label for="testing-approach">Testing Approach</label>
                    <select id="testing-approach">
                      <option value="TDD">Test-Driven (TDD)</option>
                      <option value="BDD">Behavior-Driven (BDD)</option>
                      <option value="INTEGRATION">Integration First</option>
                    </select>
                  </div>

                  <div class="form-group">
                    <label for="documentation-level">Documentation Level</label>
                    <select id="documentation-level">
                      <option value="MINIMAL">Minimal</option>
                      <option value="STANDARD" selected>Standard</option>
                      <option value="COMPREHENSIVE">Comprehensive</option>
                    </select>
                  </div>

                  <div class="form-group">
                    <label for="error-handling">Error Handling</label>
                    <select id="error-handling">
                      <option value="EXCEPTIONS">Exceptions</option>
                      <option value="RESULT">Result Types</option>
                      <option value="EITHER">Either Monad</option>
                    </select>
                  </div>

                  <div class="form-group">
                    <label for="naming-convention">Naming Convention</label>
                    <select id="naming-convention">
                      <option value="CAMEL">camelCase</option>
                      <option value="SNAKE">snake_case</option>
                      <option value="PASCAL">PascalCase</option>
                    </select>
                  </div>

                  <div class="form-group">
                    <label for="comment-style">Comment Style</label>
                    <select id="comment-style">
                      <option value="JSDoc">JSDoc</option>
                      <option value="Inline">Inline</option>
                      <option value="Minimal">Minimal</option>
                    </select>
                  </div>
                </div>
              </fieldset>

              <fieldset class="options-fieldset">
                <legend>Coding Standards</legend>
                <div class="form-group">
                  <label for="coding-standard-language">Language Template</label>
                  <select id="coding-standard-language">
                    <option value="none">None (No coding standard)</option>
                    <option value="javascript">JavaScript/TypeScript</option>
                    <option value="python">Python</option>
                    <option value="java">Java</option>
                    <option value="c">C</option>
                    <option value="cpp">C++</option>
                  </select>
                  <small class="form-hint">Select a language to populate the coding standard template below.</small>
                </div>
                <div class="form-group">
                  <label for="coding-standard-content">Coding Standard Rules</label>
                  <textarea id="coding-standard-content" rows="12" placeholder="Select a language above to populate with defaults, or write your own coding standards..."></textarea>
                  <small class="form-hint">Customize the coding standards that Claude will follow. These will be included in all branch contexts.</small>
                </div>
              </fieldset>

              <fieldset class="options-fieldset">
                <legend>UX Style Guidelines</legend>

                <div class="options-grid">
                  <div class="form-group">
                    <label for="ux-alignment">Alignment</label>
                    <select id="ux-alignment">
                      <option value="left">Left</option>
                      <option value="center">Center</option>
                      <option value="right">Right</option>
                    </select>
                  </div>

                  <div class="form-group">
                    <label for="ux-font-family">Font Family</label>
                    <select id="ux-font-family">
                      <option value="system-ui, -apple-system, sans-serif">System UI (Default)</option>
                      <option value="'Inter', sans-serif">Inter</option>
                      <option value="'Roboto', sans-serif">Roboto</option>
                      <option value="'Open Sans', sans-serif">Open Sans</option>
                      <option value="Georgia, serif">Georgia (Serif)</option>
                      <option value="'SF Mono', monospace">SF Mono (Monospace)</option>
                    </select>
                  </div>

                  <div class="form-group">
                    <label for="ux-font-size">Base Font Size</label>
                    <select id="ux-font-size">
                      <option value="14px">14px (Small)</option>
                      <option value="16px" selected>16px (Default)</option>
                      <option value="18px">18px (Large)</option>
                      <option value="20px">20px (Extra Large)</option>
                    </select>
                  </div>
                </div>

                <h4 class="section-subtitle">Color Palette</h4>
                <div class="color-palette-grid">
                  <div class="form-group color-input-group">
                    <label for="ux-color-primary">Primary</label>
                    <div class="color-input-wrapper">
                      <input type="color" id="ux-color-primary" value="#6c63ff">
                      <input type="text" id="ux-color-primary-text" value="#6c63ff" class="color-text-input">
                    </div>
                  </div>

                  <div class="form-group color-input-group">
                    <label for="ux-color-secondary">Secondary</label>
                    <div class="color-input-wrapper">
                      <input type="color" id="ux-color-secondary" value="#16213e">
                      <input type="text" id="ux-color-secondary-text" value="#16213e" class="color-text-input">
                    </div>
                  </div>

                  <div class="form-group color-input-group">
                    <label for="ux-color-accent">Accent</label>
                    <div class="color-input-wrapper">
                      <input type="color" id="ux-color-accent" value="#48bb78">
                      <input type="text" id="ux-color-accent-text" value="#48bb78" class="color-text-input">
                    </div>
                  </div>

                  <div class="form-group color-input-group">
                    <label for="ux-color-background">Background</label>
                    <div class="color-input-wrapper">
                      <input type="color" id="ux-color-background" value="#ffffff">
                      <input type="text" id="ux-color-background-text" value="#ffffff" class="color-text-input">
                    </div>
                  </div>

                  <div class="form-group color-input-group">
                    <label for="ux-color-text">Text</label>
                    <div class="color-input-wrapper">
                      <input type="color" id="ux-color-text" value="#1a1a2e">
                      <input type="text" id="ux-color-text-text" value="#1a1a2e" class="color-text-input">
                    </div>
                  </div>

                  <div class="form-group color-input-group">
                    <label for="ux-color-error">Error</label>
                    <div class="color-input-wrapper">
                      <input type="color" id="ux-color-error" value="#f56565">
                      <input type="text" id="ux-color-error-text" value="#f56565" class="color-text-input">
                    </div>
                  </div>
                </div>

                <div class="form-group">
                  <label for="ux-baseline-css">Baseline CSS</label>
                  <textarea id="ux-baseline-css" rows="8" placeholder="/* Add custom baseline CSS rules */
:root {
  --spacing-sm: 0.5rem;
  --spacing-md: 1rem;
  --border-radius: 4px;
}"></textarea>
                </div>
              </fieldset>

              <fieldset class="options-fieldset">
                <legend>Developer Settings</legend>

                <div class="form-group">
                  <label class="checkbox-label">
                    <input type="checkbox" id="debug-mode-checkbox">
                    <span>Enable Debug Mode</span>
                  </label>
                  <small class="form-hint">Shows a Debug tab with the full prompt sent to Claude CLI</small>
                </div>
              </fieldset>

              <fieldset class="options-fieldset plugins-fieldset">
                <legend>Claude Code Plugins</legend>
                <p class="fieldset-description">Manage skill plugins that extend Claude's capabilities. Plugins provide specialized context and instructions for specific tasks.</p>

                <div id="plugins-list" class="plugins-list">
                  <!-- Plugin items rendered dynamically -->
                  <div class="plugins-empty-state">
                    <span class="empty-icon">üîå</span>
                    <p>No plugins installed</p>
                    <p class="empty-hint">Add plugins to extend Claude's capabilities</p>
                  </div>
                </div>

                <button type="button" id="add-plugin-btn" class="btn secondary add-plugin-btn">
                  <span class="btn-icon">+</span>
                  Add Plugin
                </button>
              </fieldset>

              <div class="form-actions">
                <button type="button" id="generate-claude-md-btn" class="btn secondary">Generate Claude.md</button>
                <button type="submit" class="btn primary">Save Configuration</button>
              </div>
            </form>
          </div>
        </section>

        <!-- Prompt View -->
        <section id="prompt-view" class="view active">
          <div class="view-content prompt-layout swimlane-container">
            <!-- Left Swimlane: Sprint Context Panel -->
            <aside class="swimlane swimlane-left">
              <div id="sprint-context-panel" class="sprint-context-panel">
                <!-- Sprint Header -->
                <div class="sprint-panel-header">
                  <div class="sprint-title-row">
                    <h3 class="sprint-title">Sprint</h3>
                    <span id="sprint-status-badge" class="sprint-status-badge">No Sprint</span>
                    <button id="sprint-close-btn" class="sprint-close-btn hidden" title="Close Sprint">&times;</button>
                  </div>
                </div>
                <!-- Sprint Progress -->
                <div id="sprint-progress-section" class="sprint-progress-section hidden">
                  <div class="sprint-progress">
                    <div class="sprint-progress-label">
                      <span>Progress</span>
                      <span id="sprint-progress-percent">0%</span>
                    </div>
                    <div class="sprint-progress-bar">
                      <div id="sprint-progress-fill" class="sprint-progress-fill" style="width: 0%"></div>
                    </div>
                  </div>
                </div>
                <!-- Sprint Actions -->
                <div class="sprint-panel-actions" id="sprint-actions">
                  <button id="sprint-plan-btn" class="btn primary hidden">Plan</button>
                  <button id="sprint-iterate-btn" class="btn secondary hidden">Iterate on Plan</button>
                  <button id="sprint-approve-btn" class="btn success hidden">Approve Plan</button>
                </div>
                <!-- Story Cards -->
                <div class="sprint-stories-container">
                  <div id="sprint-stories" class="sprint-stories">
                    <!-- Story cards will be rendered here -->
                    <div class="sprint-empty-state">
                      <p class="text-muted">No active sprint</p>
                      <p class="text-small">Select stories from the Backlog to start a sprint</p>
                    </div>
                  </div>
                </div>
              </div>
            </aside>

            <!-- Middle Swimlane: Conversation View -->
            <main class="swimlane swimlane-middle">
              <!-- Branch Tabs -->
              <div class="branch-tabs">
                <button class="branch-tab active" data-branch="specifications">Specifications</button>
                <button class="branch-tab" data-branch="architecture">Architecture</button>
                <button class="branch-tab" data-branch="ui">UI</button>
                <button class="branch-tab" data-branch="backend">Backend</button>
                <button class="branch-tab" data-branch="deployment">Deployment</button>
                <button class="branch-tab" data-branch="tmp">Tmp</button>
              </div>

              <div class="response-area">
                <div id="response-content" class="response-content">
                  <p class="placeholder">Select a thread and start a conversation with Claude...</p>
                </div>
              </div>
              <div class="prompt-area">
                <textarea id="prompt-input" placeholder="Enter your prompt..."></textarea>
                <div class="prompt-options">
                  <div class="prompt-option-group">
                    <label for="thread-model" class="prompt-select-label">Model:</label>
                    <select id="thread-model" class="prompt-model-select" title="Select model for this thread">
                      <option value="opus" selected>Opus</option>
                      <option value="sonnet">Sonnet</option>
                      <option value="haiku">Haiku</option>
                    </select>
                  </div>
                  <label class="prompt-checkbox" title="Derive user stories from this prompt before implementation">
                    <input type="checkbox" id="derive-stories-checkbox">
                    <span>Derive User Stories</span>
                  </label>
                  <div class="prompt-option-group input-type-group hidden" id="input-type-group">
                    <label for="input-type" class="prompt-select-label">Input Type:</label>
                    <select id="input-type" class="prompt-model-select" title="Classify this input for tracking">
                      <option value="technical" selected>Technical</option>
                      <option value="clarification">Clarification</option>
                      <option value="correction">Correction</option>
                      <option value="expansion">Expansion</option>
                      <option value="approval">Approval</option>
                    </select>
                  </div>
                </div>
                <div class="prompt-actions">
                  <button id="new-thread-btn" class="btn outline" title="Clear prompt and start a fresh thread">
                    Create New Thread
                  </button>
                  <button id="cancel-prompt-btn" class="btn secondary hidden">Cancel</button>
                  <button id="submit-prompt-btn" class="btn primary">
                    <span class="btn-text">Send</span>
                    <span class="btn-loading hidden">...</span>
                  </button>
                  <div class="dropdown" id="include-gui-dropdown">
                    <button id="include-gui-btn" class="btn secondary" title="Include GUI Design">
                      Include GUI ‚ñæ
                    </button>
                    <div class="dropdown-menu" id="include-gui-menu">
                      <!-- Populated dynamically -->
                    </div>
                  </div>
                  <div class="dropdown" id="include-docs-dropdown">
                    <button id="include-docs-btn" class="btn secondary" title="Include Design Document">
                      Include Docs ‚ñæ
                    </button>
                    <div class="dropdown-menu" id="include-docs-menu">
                      <!-- Populated dynamically from docs/ directory -->
                    </div>
                  </div>
                </div>
                <!-- Iteration Counter (visible during sprint execution) -->
                <div id="iteration-counter" class="iteration-counter hidden">
                  <div class="iteration-stats">
                    <span class="iteration-label">Iterations:</span>
                    <span id="iteration-current" class="iteration-value">0</span>
                    <span class="iteration-separator">/</span>
                    <span id="iteration-max" class="iteration-value">10</span>
                  </div>
                </div>
              </div>
            </main>

            <!-- Right Swimlane: Metadata & Handoff -->
            <aside class="swimlane swimlane-right">
              <div id="metadata-panel" class="metadata-panel">
                <!-- Thread Statistics -->
                <div class="metadata-section">
                  <h4 class="metadata-section-title">Thread Stats</h4>
                  <div class="stats-grid">
                    <div class="stat-item">
                      <span class="stat-label">Turns</span>
                      <span id="stat-turns" class="stat-value">0</span>
                    </div>
                    <div class="stat-item">
                      <span class="stat-label">Cost</span>
                      <span id="stat-cost" class="stat-value">-</span>
                    </div>
                    <div class="stat-item">
                      <span class="stat-label">Duration</span>
                      <span id="stat-duration" class="stat-value">-</span>
                    </div>
                    <div class="stat-item">
                      <span class="stat-label">Created</span>
                      <span id="stat-created" class="stat-value">-</span>
                    </div>
                    <div class="stat-item">
                      <span class="stat-label">Defects</span>
                      <span id="stat-defects" class="stat-value">0</span>
                    </div>
                    <div class="stat-item">
                      <span class="stat-label">Continuations</span>
                      <span id="stat-continuations" class="stat-value">0</span>
                    </div>
                  </div>
                </div>
                <!-- Incoming Handoff Context (from another thread) -->
                <div id="handoff-incoming-section" class="metadata-section handoff-section hidden">
                  <h4 class="metadata-section-title">Incoming Handoff</h4>
                  <div id="handoff-incoming-display" class="handoff-display">
                    <!-- Incoming handoff summary rendered here -->
                  </div>
                </div>
                <!-- Generate Handoff Section -->
                <div class="metadata-section handoff-generate-section">
                  <h4 class="metadata-section-title">Handoff</h4>
                  <div id="handoff-generate-content" class="handoff-generate-content">
                    <button id="generate-handoff-btn" class="btn handoff-btn handoff-btn-panel" title="Generate handoff summary from this thread">
                      <span class="handoff-icon">‚ú®</span>
                      <span class="handoff-text">Generate Handoff</span>
                    </button>
                  </div>
                  <!-- Generated summary display (hidden initially) -->
                  <div id="handoff-generated-section" class="handoff-generated hidden">
                    <div class="handoff-branch-buttons">
                      <p class="handoff-branch-label">Send to branch:</p>
                      <div id="handoff-branch-grid" class="handoff-branch-grid">
                        <!-- Branch buttons rendered dynamically -->
                      </div>
                    </div>
                    <div class="handoff-actions-row">
                      <button id="handoff-regenerate-btn" class="btn small secondary handoff-regenerate-btn">
                        Regenerate
                      </button>
                      <button id="handoff-clear-btn" class="btn small outline handoff-clear-btn">
                        Clear
                      </button>
                    </div>
                    <div id="handoff-generated-summary" class="handoff-generated-summary">
                      <!-- Generated summary will be rendered here -->
                    </div>
                  </div>
                </div>
              </div>
            </aside>
          </div>
        </section>

        <!-- Designer View is now provided by designer-plugin -->
        <!-- Plugin views are rendered dynamically in #plugin-views-container -->

        <!-- Backlog View (with Insights subtab) -->
        <section id="user-stories-view" class="view">
          <div class="view-content user-stories-layout">
            <!-- Sprint History Panel (Left Sidebar) -->
            <aside id="sprint-history-panel" class="swimlane swimlane-left sprint-history-panel" aria-label="Sprint History">
              <div class="sprint-context-panel">
                <!-- Sprint History Header -->
                <div class="sprint-panel-header">
                  <div class="sprint-title-row">
                    <h3 class="sprint-title">Sprint History</h3>
                    <div class="sprint-header-buttons">
                      <button id="sprint-history-refresh-btn" class="sprint-refresh-btn" aria-label="Refresh sprint history" title="Refresh">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                          <path d="M21 2v6h-6"></path>
                          <path d="M3 12a9 9 0 0 1 15-6.7L21 8"></path>
                          <path d="M3 22v-6h6"></path>
                          <path d="M21 12a9 9 0 0 1-15 6.7L3 16"></path>
                        </svg>
                      </button>
                      <button id="sprint-panel-collapse-btn" class="sprint-close-btn" aria-expanded="true" aria-label="Collapse sprint history panel" title="Collapse">
                        <span class="collapse-icon"></span>
                      </button>
                    </div>
                  </div>
                </div>
                <!-- Sprint Tiles Container -->
                <div class="sprint-stories-container">
                  <div id="sprint-tiles-list" class="sprint-stories sprint-tiles-list">
                    <!-- Sprint tiles rendered dynamically -->
                    <div class="sprint-empty-state">
                      <p class="text-muted">No past sprints</p>
                      <p class="text-small">Completed sprints will appear here</p>
                    </div>
                  </div>
                </div>
              </div>
            </aside>

            <!-- Main Backlog Area -->
            <main class="backlog-main">
              <!-- Subtab navigation -->
              <div class="backlog-tabs">
                <button class="backlog-tab active" data-tab="stories">Backlog</button>
                <button class="backlog-tab" data-tab="insights">Insights</button>
              </div>

              <!-- Stories Tab Content -->
              <div id="backlog-stories-tab" class="backlog-tab-content active">
                <div class="user-stories-toolbar">
                  <div class="story-search-container">
                    <input type="search"
                           id="story-search-input"
                           class="story-search-input"
                           placeholder="Search stories...">
                  </div>
                  <div class="filter-group">
                    <button class="filter-btn active" data-status="all">All</button>
                    <button class="filter-btn" data-status="pending">Pending</button>
                    <button class="filter-btn" data-status="in-progress">In Progress</button>
                    <button class="filter-btn" data-status="completed">Completed</button>
                  </div>
                  <button id="add-story-btn" class="btn small">+ Add Story</button>
                </div>
                <div id="user-stories-list" class="user-stories-list">
                  <!-- User stories rendered dynamically -->
                  <p class="placeholder">No user stories yet. Use "Derive User Stories" checkbox when submitting prompts.</p>
                </div>
              </div>

              <!-- Insights Tab Content -->
              <div id="backlog-insights-tab" class="backlog-tab-content">
                <div class="insights-container">
                  <div class="generations-toolbar">
                    <div class="toolbar-actions">
                      <select class="filter-select">
                        <option value="all">All Actions</option>
                        <option value="accepted">Accepted</option>
                        <option value="modified">Modified</option>
                        <option value="rejected">Rejected</option>
                        <option value="pending">Pending</option>
                      </select>
                      <button class="btn small export-btn">Export JSON</button>
                    </div>
                  </div>
                  <div class="generations-list">
                    <!-- Generation cards rendered dynamically -->
                  </div>
                </div>
              </div>
            </main>

            <!-- Right Reserved Panel (for future use) -->
            <aside id="backlog-right-panel" class="backlog-right-panel" aria-label="Reserved Panel">
              <div class="reserved-panel-content">
                <!-- Future content goes here -->
              </div>
            </aside>
          </div>
        </section>

        <!-- CLI Output View -->
        <section id="cli-output-view" class="view">
          <div class="view-content cli-output-layout">
            <div class="cli-output-header">
              <div class="cli-output-tabs">
                <button class="cli-tab active" data-tab="stream">Live Stream</button>
                <button class="cli-tab" data-tab="messages">Messages</button>
                <button class="cli-tab" data-tab="raw">Raw JSON</button>
              </div>
              <div class="cli-output-controls">
                <label class="cli-checkbox">
                  <input type="checkbox" id="cli-autoscroll" checked>
                  Auto-scroll
                </label>
                <label class="cli-checkbox">
                  <input type="checkbox" id="cli-show-system">
                  Show System
                </label>
                <button id="cli-clear-btn" class="btn small">Clear</button>
                <button id="cli-export-btn" class="btn small">Export</button>
              </div>
            </div>
            <div class="cli-output-body">
              <div id="cli-stream-content" class="cli-content active">
                <div class="cli-stream-output">
                  <p class="cli-placeholder">3CLI output will appear here when you submit a prompt...</p>
                </div>
              </div>
              <div id="cli-messages-content" class="cli-content">
                <div class="cli-messages-list">
                  <!-- Messages rendered dynamically -->
                </div>
              </div>
              <div id="cli-raw-content" class="cli-content">
                <pre class="cli-raw-output"></pre>
              </div>
            </div>
            <div class="cli-output-footer">
              <span id="cli-status" class="cli-status">Idle</span>
              <span id="cli-session-info" class="cli-session-info"></span>
              <span id="cli-cost-info" class="cli-cost-info"></span>
            </div>
          </div>
        </section>

        <!-- Debug View -->
        <section id="debug-view" class="view">
          <div class="view-content debug-layout">
            <div class="debug-header">
              <h2>Debug: Last Submitted Prompt</h2>
              <div class="debug-controls">
                <button id="debug-copy-btn" class="btn small">Copy to Clipboard</button>
                <button id="debug-clear-btn" class="btn small secondary">Clear</button>
              </div>
            </div>
            <div class="debug-info">
              <div class="debug-meta">
                <span id="debug-timestamp" class="debug-meta-item">No prompt submitted yet</span>
                <span id="debug-branch" class="debug-meta-item"></span>
                <span id="debug-model" class="debug-meta-item"></span>
              </div>
            </div>
            <div class="debug-content">
              <pre id="debug-prompt-content" class="debug-prompt-output">Submit a prompt to see what Puffin sends to Claude CLI...</pre>
            </div>
          </div>
        </section>

        <!-- Git Panel View -->
        <section id="git-view" class="view">
          <div id="git-panel-view" class="view-content">
            <!-- Git panel content will be rendered dynamically by the GitPanelComponent -->
          </div>
        </section>

        <!-- Plugin View Container -->
        <div id="plugin-view-container" class="plugin-view-container">
          <!-- Plugin view panels rendered dynamically -->
        </div>
      </div>
    </main>

    <!-- Modal Container -->
    <div id="modal-container" class="modal-container hidden">
      <div class="modal-backdrop"></div>
      <div class="modal">
        <div class="modal-header">
          <h3 id="modal-title">Modal Title</h3>
          <button class="modal-close">√ó</button>
        </div>
        <div id="modal-content" class="modal-content">
          <!-- Modal content rendered dynamically -->
        </div>
        <div id="modal-actions" class="modal-actions">
          <!-- Modal actions rendered dynamically -->
        </div>
      </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>
  </div>

  <!-- Application Scripts -->
  <script type="module" src="app.js"></script>
</body>
</html>
